<h3><span style="background-color:yellow;">Question</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">ID-3848239</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </h3><h2><span style="background-color:yellow;">Trying</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">group</span> <span style="background-color:yellow;">values</span> ? </h2><p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">some</span> <span style="background-color:yellow;">data</span> <span style="background-color:yellow;">like</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>1 2
3 4
5 9
2 6
3 7
</code></pre>
<p><span style="background-color:yellow;">and</span> <span style="background-color:yellow;">am</span> <span style="background-color:yellow;">looking</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">an</span> <span style="background-color:yellow;">output</span> <span style="background-color:yellow;">like</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">group-id</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">members</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">group</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </p>
<pre><code>1: 1 2 6
2: 3 4 7
3: 5 9
</code></pre>
<p><span style="background-color:yellow;">First</span> <span style="background-color:yellow;">row</span> <span style="background-color:yellow;">because</span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">connected</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">2</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">2</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">connected</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">6</span> . <span style="background-color:yellow;">Second</span> <span style="background-color:yellow;">row</span> <span style="background-color:yellow;">because</span> <span style="background-color:yellow;">3</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">connected</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">4</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">3</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">connected</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">7</span> </p>
<p><span style="background-color:yellow;">This</span> <span style="background-color:yellow;">looked</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">me</span> <span style="background-color:yellow;">like</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">graph</span> <span style="background-color:yellow;">traversal</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">final</span> <span style="background-color:yellow;">order</span> <span style="background-color:yellow;">does</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">matter</span> <span style="background-color:yellow;">so</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">was</span> <span style="background-color:yellow;">wondering</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">someone</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">suggest</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">simpler</span> <span style="background-color:yellow;">solution</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">large</span> <span style="background-color:yellow;">dataset</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">billions</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">entries</span> <span style="background-color:yellow;"></span> . </p>
<hr />
<p><span style="background-color:yellow;">From</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">comments</span> <span style="background-color:yellow;">:</span> </p>
<ul><span style="background-color:yellow;">The</span> <span style="background-color:yellow;">problem</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">find</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">set</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">disjoint</span> <span style="background-color:yellow;">sub-graphs</span> <span style="background-color:yellow;">given</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">set</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">edges</span> . <span style="background-color:yellow;">The</span> <span style="background-color:yellow;">edges</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">directed</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">line</span> <span style="background-color:yellow;">'1</span> <span style="background-color:yellow;">2</span> <span style="background-color:yellow;">'</span> <span style="background-color:yellow;">means</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">connected</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">2</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">2</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">connected</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">1</span> . <span style="background-color:yellow;">The</span> <span style="background-color:yellow;">'1</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">'</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">sample</span> <span style="background-color:yellow;">output</span> <span style="background-color:yellow;">could</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">'A</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">'</span> <span style="background-color:yellow;">without</span> <span style="background-color:yellow;">changing</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">meaning</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">answer</span> . </ul>
<p><span style="background-color:yellow;">EDIT</span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;">:</span> </p>
<p><span style="background-color:yellow;">Problem</span> <span style="background-color:yellow;">looks</span> <span style="background-color:yellow;">solved</span> <span style="background-color:yellow;">now.</span> <span style="background-color:yellow;">Thanks</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">everyone</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">their</span> <span style="background-color:yellow;">help.</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">need</span> <span style="background-color:yellow;">some</span> <span style="background-color:yellow;">more</span> <span style="background-color:yellow;">help</span> <span style="background-color:yellow;">picking</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">best</span> <span style="background-color:yellow;">solution</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">used</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">billions</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">such</span> <span style="background-color:yellow;">entries</span> . </p>
<p><span style="background-color:yellow;">EDIT</span> <span style="background-color:yellow;">2</span> <span style="background-color:yellow;">:</span> </p>
<p><span style="background-color:yellow;">Test</span> <span style="background-color:yellow;">Input</span> <span style="background-color:yellow;">file</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>1 27
1 134
1 137
1 161
1 171
1 275
1 309
1 413
1 464
1 627
1 744
2 135
2 398
2 437
2 548
2 594
2 717
2 738
2 783
2 798
2 912
5 74
5 223
7 53
7 65
7 122
7 237
7 314
7 701
7 730
7 755
7 821
7 875
7 884
7 898
7 900
7 930
8 115
9 207
9 305
9 342
9 364
9 493
9 600
9 676
9 830
9 941
10 164
10 283
10 380
10 423
10 468
10 577
11 72
11 132
11 276
11 306
11 401
11 515
11 599
12 95
12 126
12 294
13 64
13 172
13 528
14 396
15 35
15 66
15 210
15 226
15 360
15 588
17 263
17 415
17 474
17 648
17 986
21 543
21 771
22 47
23 70
23 203
23 427
23 590
24 286
24 565
25 175
26 678
27 137
27 161
27 171
27 275
27 309
27 413
27 464
27 627
27 684
27 744
29 787
</code></pre>
<p><span style="background-color:yellow;">Benchmarks</span> <span style="background-color:yellow;">:</span> </p>
<p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">tried</span> <span style="background-color:yellow;">out</span> <span style="background-color:yellow;">everything</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">version</span> <span style="background-color:yellow;">posted</span> <span style="background-color:yellow;">by</span> <span style="background-color:yellow;">TokenMacGuy</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">fastest</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">sample</span> <span style="background-color:yellow;">dataset</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">tried.</span> <span style="background-color:yellow;">The</span> <span style="background-color:yellow;">dataset</span> <span style="background-color:yellow;">has</span> <span style="background-color:yellow;">about</span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;">million</span> <span style="background-color:yellow;">entries</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">took</span> <span style="background-color:yellow;">me</span> <span style="background-color:yellow;">about</span> <span style="background-color:yellow;">6</span> <span style="background-color:yellow;">seconds</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">Dual</span> <span style="background-color:yellow;">Quad-Core</span> <span style="background-color:yellow;">2.4GHz</span> <span style="background-color:yellow;">machine.</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">gotten</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">chance</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">run</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">entire</span> <span style="background-color:yellow;">dataset</span> <span style="background-color:yellow;">yet</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">will</span> <span style="background-color:yellow;">post</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">benchmark</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">soon</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">available</span> . </p>
<br /><h3><span style="background-color:yellow;">Answers</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">Total-10</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </h3><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">0</span> </b><br /><p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'ve</span> <span style="background-color:yellow;">managed</span> <span style="background-color:yellow;">O</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">n</span> <span style="background-color:yellow;">log</span> <span style="background-color:yellow;">n</span> <span style="background-color:yellow;"></span> . </p>
<p><span style="background-color:yellow;">Here</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">somewhat</span> <span style="background-color:yellow;">intense</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">C</span> <span style="background-color:yellow;">+</span> <span style="background-color:yellow;">+</span> <span style="background-color:yellow;">implementation</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>#include <boost/pending/disjoint_sets.hpp>
#include <boost/property_map/property_map.hpp>

#include <map>
#include <set>
#include <iostream>


typedef std::map<int, int> rank_t;
typedef std::map<int, int> parent_t;

typedef boost::associative_property_map< rank_t > rank_pmap_t;
typedef boost::associative_property_map< parent_t > parent_pmap_t;

typedef boost::disjoint_sets< rank_pmap_t, parent_pmap_t > group_sets_t;

typedef std::set<int> key_set;
typedef std::map<int, std::set<int> > output;
</code></pre>
<p><span style="background-color:yellow;">With</span> <span style="background-color:yellow;">some</span> <span style="background-color:yellow;">typedefs</span> <span style="background-color:yellow;">out</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">here</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">real</span> <span style="background-color:yellow;">meat.</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'m</span> <span style="background-color:yellow;">using</span> <span style="background-color:yellow;">boost</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">disjoint_sets</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">just</span> <span style="background-color:yellow;">happens</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">an</span> <span style="background-color:yellow;">exceptionally</span> <span style="background-color:yellow;">good</span> <span style="background-color:yellow;">representation</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">problem.</span> <span style="background-color:yellow;">This</span> <span style="background-color:yellow;">first</span> <span style="background-color:yellow;">function</span> <span style="background-color:yellow;">checks</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">see</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">either</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">keys</span> <span style="background-color:yellow;">given</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">been</span> <span style="background-color:yellow;">seen</span> <span style="background-color:yellow;">before</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">adds</span> <span style="background-color:yellow;">them</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">collections</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">needed.</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">important</span> <span style="background-color:yellow;">part</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">really</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">union_set</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">b</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">links</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">two</span> <span style="background-color:yellow;">sets</span> <span style="background-color:yellow;">together.</span> <span style="background-color:yellow;">If</span> <span style="background-color:yellow;">one</span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">other</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">sets</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">already</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">groups</span> <span style="background-color:yellow;">collection</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">they</span> <span style="background-color:yellow;">get</span> <span style="background-color:yellow;">linked</span> <span style="background-color:yellow;">too</span> . </p>
<pre><code>void add_data(int a, int b, group_sets_t & groups, key_set & keys)
{
  if (keys.count(a) < 1) groups.make_set(a);
  if (keys.count(b) < 1) groups.make_set(b);
  groups.union_set(a, b);
  keys.insert(a);
  keys.insert(b);
}
</code></pre>
<p><span style="background-color:yellow;">This</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">too</span> <span style="background-color:yellow;">exciting</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">just</span> <span style="background-color:yellow;">iterates</span> <span style="background-color:yellow;">through</span> <span style="background-color:yellow;">all</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">keys</span> <span style="background-color:yellow;">we</span> <span style="background-color:yellow;">'ve</span> <span style="background-color:yellow;">seen</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">gets</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">representative</span> <span style="background-color:yellow;">key</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">key</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">then</span> <span style="background-color:yellow;">adds</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">pair</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">representative</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">key</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">map.</span> <span style="background-color:yellow;">Once</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">done</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">print</span> <span style="background-color:yellow;">out</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">map</span> . </p>
<pre><code>void build_output(group_sets_t & groups, key_set & keys)
{
  output out;
  for (key_set::iterator i(keys.begin()); i != keys.end(); i++)
    out[groups.find_set(*i)].insert(*i);

  for (output::iterator i(out.begin()); i != out.end(); i++)
  {
    std::cout << i->first << ": ";
    for (output::mapped_type::iterator j(i->second.begin()); j != i->second.end(); j++)
      std::cout << *j << " ";
    std::cout << std::endl;
  }
}

int main()
{

  rank_t rank;
  parent_t parent;
  rank_pmap_t rank_index(rank);
  parent_pmap_t parent_index(parent);


  group_sets_t groups( rank_index, parent_index );
  key_set keys;

  int a, b;
  while (std::cin >> a)
  {
    std::cin >> b;
    add_data(a, b, groups, keys);
  }  


  build_output(groups, keys);
  //std::cout << "number of sets: " << 
  //  groups.count_sets(keys.begin()), keys.end()) << std::endl;

}
</code></pre>
<p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">stayed</span> <span style="background-color:yellow;">up</span> <span style="background-color:yellow;">many</span> <span style="background-color:yellow;">hours</span> <span style="background-color:yellow;">learning</span> <span style="background-color:yellow;">how</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">boost</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">disjoint_sets</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">problem.</span> <span style="background-color:yellow;">There</span> <span style="background-color:yellow;">does</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">seem</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">much</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">any</span> <span style="background-color:yellow;">documentation</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">it</span> . </p>
<p><span style="background-color:yellow;">About</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">performance.</span> <span style="background-color:yellow;">The</span> <span style="background-color:yellow;">disjoint_sets</span> <span style="background-color:yellow;">structure</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">O</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">&alpha</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">n</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">its</span> <span style="background-color:yellow;">key</span> <span style="background-color:yellow;">operations</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">make_set</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">find_set</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">union_set</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">pretty</span> <span style="background-color:yellow;">close</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">constant</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">so</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">were</span> <span style="background-color:yellow;">just</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">matter</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">building</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">structure</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">whole</span> <span style="background-color:yellow;">algorithm</span> <span style="background-color:yellow;">would</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">O</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">n</span> <span style="background-color:yellow;">&alpha</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">n</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">effectively</span> <span style="background-color:yellow;">O</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">n</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">we</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">print</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">out.</span> <span style="background-color:yellow;">That</span> <span style="background-color:yellow;">means</span> <span style="background-color:yellow;">we</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">build</span> <span style="background-color:yellow;">up</span> <span style="background-color:yellow;">some</span> <span style="background-color:yellow;">associative</span> <span style="background-color:yellow;">containers</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">perform</span> <span style="background-color:yellow;">better</span> <span style="background-color:yellow;">than</span> <span style="background-color:yellow;">O</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">n</span> <span style="background-color:yellow;">log</span> <span style="background-color:yellow;">n</span> <span style="background-color:yellow;"></span> . <span style="background-color:yellow;">It</span> <span style="background-color:yellow;">might</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">possible</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">get</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">constant</span> <span style="background-color:yellow;">factor</span> <span style="background-color:yellow;">speedup</span> <span style="background-color:yellow;">by</span> <span style="background-color:yellow;">choosing</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">different</span> <span style="background-color:yellow;">associative</span> <span style="background-color:yellow;">containers</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">say</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">hash_set</span> <span style="background-color:yellow;">etc</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">since</span> <span style="background-color:yellow;">once</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">populate</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">initial</span> <span style="background-color:yellow;">list</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">reserve</span> <span style="background-color:yellow;">an</span> <span style="background-color:yellow;">optimal</span> <span style="background-color:yellow;">amount</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">space</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">1</span> </b><br /><p><span style="background-color:yellow;">Here</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">sample</span> <span style="background-color:yellow;">Perl</span> <span style="background-color:yellow;">solution</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">works</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">original</span> <span style="background-color:yellow;">data</span> <span style="background-color:yellow;">set</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>1 2
3 4
5 9
2 6
3 7

Group 1: 1 2 6
Group 2: 3 4 7
Group 3: 5 9
</code></pre>
<p><span style="background-color:yellow;">On</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">big</span> <span style="background-color:yellow;">data</span> <span style="background-color:yellow;">set</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">produces</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">output</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>Group 1: 1 27 134 137 161 171 275 309 413 464 627 684 744
Group 2: 2 135 398 437 548 594 717 738 783 798 912
Group 3: 5 74 223
Group 4: 7 53 65 122 237 314 701 730 755 821 875 884 898 900 930
Group 5: 8 115
Group 6: 9 207 305 342 364 493 600 676 830 941
Group 7: 10 164 283 380 423 468 577
Group 8: 11 72 132 276 306 401 515 599
Group 9: 12 95 126 294
Group 10: 13 64 172 528
Group 11: 14 396
Group 12: 15 35 66 210 226 360 588
Group 13: 17 263 415 474 648 986
Group 14: 21 543 771
Group 15: 22 47
Group 16: 23 70 203 427 590
Group 17: 24 286 565
Group 18: 25 175
Group 19: 26 678
Group 20: 29 787
</code></pre>
<p><span style="background-color:yellow;">Whether</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">efficient</span> <span style="background-color:yellow;">enough</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">separate</span> <span style="background-color:yellow;">matter..</span> . </p>
<pre><code>use strict;
use warnings;
my %cache = ();
while (<>)
{
    chomp;
    my($x,$y) = split /\s+/;
    #print "$x $y\n";
    $cache{$x}{$y} = 1;
    $cache{$y}{$x} = 1;
}

my $grp = 1;
foreach my $key (sort { $a <=> $b } keys %cache)
{
    #print "key: $key\n";
    if (defined $cache{$key})
    {
        my %result = ();
        subkey_search(\%result, $key);
        print "Group $grp:";
        $grp++;
        foreach my $val (sort { $a <=> $b } keys %result)
        {
            print " $val";
        }
        print "\n";
    }
}

sub subkey_search
{
    my($resultref, $key) = @_;
    my %hash = %{$cache{$key}};
    delete $cache{$key};
    $resultref->{$key} = 1;
    foreach my $subkey (sort keys %hash)
    {
        #print "subkey: $subkey\n";
        subkey_search($resultref, $subkey) if (defined $cache{$subkey});
    }
}
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">2</span> </b><br /><p><span style="background-color:yellow;">Ok</span> <span style="background-color:yellow;">so</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">got</span> <span style="background-color:yellow;">something</span> <span style="background-color:yellow;">working</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">parallel</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">other</span> <span style="background-color:yellow;">solution</span> <span style="background-color:yellow;">posted</span> <span style="background-color:yellow;">by</span> <span style="background-color:yellow;">@</span> <span style="background-color:yellow;">Jonathan</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">first</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">all</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">many</span> <span style="background-color:yellow;">thanks</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">time</span> <span style="background-color:yellow;"></span> . <span style="background-color:yellow;">My</span> <span style="background-color:yellow;">solution</span> <span style="background-color:yellow;">looks</span> <span style="background-color:yellow;">deceptively</span> <span style="background-color:yellow;">simple</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">would</span> <span style="background-color:yellow;">love</span> <span style="background-color:yellow;">some</span> <span style="background-color:yellow;">suggestions</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">whether</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">correct</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">maybe</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'m</span> <span style="background-color:yellow;">missing</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">corner</span> <span style="background-color:yellow;">case</span> <span style="background-color:yellow;">somewhere</span> ? <span style="background-color:yellow;"></span> <span style="background-color:yellow;">because</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">seems</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">produce</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">output</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">wanted</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'ll</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">parse</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">second</span> <span style="background-color:yellow;">pass</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">group</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">same</span> <span style="background-color:yellow;">group</span> <span style="background-color:yellow;">numbers</span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">trivial.</span> <span style="background-color:yellow;">The</span> <span style="background-color:yellow;">logic</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">everytime</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">finds</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">new</span> <span style="background-color:yellow;">number</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">array</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">increments</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">group_id</span> <span style="background-color:yellow;">counter</span> <span style="background-color:yellow;">:</span> </p>
<p><span style="background-color:yellow;">My</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">PHP</span> <span style="background-color:yellow;">:</span> </p>
<pre><code><?php

//$fp = fopen("./resemblance.1.out", "r");
$fp = fopen("./wrong", "r");

$groups = array();
$group["-1"] = 1;
$groups[] = $group;

$map = array();

//Maintain a count
$group = 1;

while(!feof($fp)) {
        $source = trim(fgets($fp, 4096));
        //echo $source."\n";

        $source = explode(" ", $source);

        if(array_key_exists($source[0], $map) && !array_key_exists($source[1], $map)) {
                $map[$source[1]] = $map[$source[0]];
        } else if(array_key_exists($source[1], $map) && !array_key_exists($source[0], $map)) {
                $map[$source[0]] = $map[$source[1]];
        } else if(array_key_exists($source[1], $map) && array_key_exists($source[0], $map) && $map[$source[1]] != $map[$source[0]]) {
                // Adjust the groups - change the groups of one of the elements to the other
                $keys = array_keys($map, $map[$source[1]]);
                print_r($keys);
                foreach($keys as $key) {
                        $map[$key] = $map[$source[0]];
                }
        } else {
                $group++;
                $map[$source[0]] = $group;
                $map[$source[1]] = $group;
        }
}

print_r($map);
?>
</code></pre>
<p><span style="background-color:yellow;">Output</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>Array
(
    [1] => 2
    [2] => 2
    [3] => 3
    [4] => 3
    [5] => 4
    [9] => 4
    [6] => 2
    [7] => 3
    [] => 5
)
</code></pre>
<p><span style="background-color:yellow;">EDIT</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">Fixed</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">bug</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">was</span> <span style="background-color:yellow;">mentioned</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">comment.</span> <span style="background-color:yellow;">Just</span> <span style="background-color:yellow;">playing</span> <span style="background-color:yellow;">around</span> <span style="background-color:yellow;">out</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">curiosity</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">Feel</span> <span style="background-color:yellow;">free</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">point</span> <span style="background-color:yellow;">out</span> <span style="background-color:yellow;">any</span> <span style="background-color:yellow;">other</span> <span style="background-color:yellow;">bugs.</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">am</span> <span style="background-color:yellow;">currently</span> <span style="background-color:yellow;">testing</span> <span style="background-color:yellow;">out</span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">solution</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">faster</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">3</span> </b><br /><p><span style="background-color:yellow;">Here</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">slightly</span> <span style="background-color:yellow;">different</span> <span style="background-color:yellow;">version</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">builds</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">graph</span> <span style="background-color:yellow;">containing</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">edges</span> <span style="background-color:yellow;">specified</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">then</span> <span style="background-color:yellow;">converts</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">list</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">connected</span> <span style="background-color:yellow;">subgraphs</span> . </p>
<p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">might</span> <span style="background-color:yellow;">want</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">later</span> <span style="background-color:yellow;">so</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">wrote</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">general-purpose</span> <span style="background-color:yellow;">version</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">does</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">input</span> <span style="background-color:yellow;">from</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">file</span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">output</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">print</span> <span style="background-color:yellow;">statements</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">just</span> <span style="background-color:yellow;">converting</span> <span style="background-color:yellow;">data</span> <span style="background-color:yellow;">structures</span> . </p>
<pre><code>def graph_to_connected_subgraphs(graph):
    trees = []
    for start in graph.keys():
        if start in graph:
            list = [start]
            append_tree_from(graph, start, list)
            trees.append(list)
    return trees

def append_tree_from(graph, node, list):
    if node in graph:
        for endpoint in graph[node]:
            list.append(endpoint)
            append_tree_from(graph, endpoint, list)
        del graph[node]
    return list

def add_edge(graph, f, s):
    if s < f: # ensure f < s to handle cyclic graphs
        f, s = s, f
    if f not in graph:
        graph[f] = [s]
    else:
        graph[f].append(s)

graph = {}

add_edge(graph, 1,2)
add_edge(graph, 2,6)
add_edge(graph, 3,4)
add_edge(graph, 5,9)
add_edge(graph, 3,7)

print graph_to_connected_subgraphs(graph)
</code></pre>
<p><span style="background-color:yellow;">Output</span> </p>
<pre><code>[[1, 2, 6], [3, 4, 7], [5, 9]]
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">4</span> </b><br /><p><span style="background-color:yellow;">This</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">typical</span> <span style="background-color:yellow;">application</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">DFS</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">Depth</span> <span style="background-color:yellow;">First</span> <span style="background-color:yellow;">Search</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">algorithm</span> <span style="background-color:yellow;">performed</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">graphs.</span> <span style="background-color:yellow;">Try</span> <span style="background-color:yellow;">read</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">dfs</span> <span style="background-color:yellow;">Complexity</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">algorithm</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">O</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">|</span> <span style="background-color:yellow;">V</span> <span style="background-color:yellow;">|</span> <span style="background-color:yellow;">+</span> <span style="background-color:yellow;">|</span> <span style="background-color:yellow;">E</span> <span style="background-color:yellow;">|</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">where</span> <span style="background-color:yellow;">V</span> <span style="background-color:yellow;">-</span> <span style="background-color:yellow;">number</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">vertices</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">E</span> <span style="background-color:yellow;">-</span> <span style="background-color:yellow;">number</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">edges</span> </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">5</span> </b><br /><p><span style="background-color:yellow;">Here</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">my</span> <span style="background-color:yellow;">stab</span> <span style="background-color:yellow;">at</span> <span style="background-color:yellow;">an</span> <span style="background-color:yellow;">answer.</span> <span style="background-color:yellow;">Python</span> . </p>
<pre><code>groups = []

infile = open("so2.txt")

for line in infile.readlines():
  newset = set(line.split())
  matchgroups = []
  excludegroups = []
  for group in groups:
    if len(newset & group):
      newset |= group
    else:
      excludegroups.append(group)
  groups = excludegroups
  groups.append( newset)

for i, s in enumerate(groups):
  print "%d: %s"%(i, " ".join(s))
</code></pre>
<p><span style="background-color:yellow;">The</span> <span style="background-color:yellow;">Idea</span> <span style="background-color:yellow;">here</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">forming</span> <span style="background-color:yellow;">graphs</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">really</span> <span style="background-color:yellow;">right.</span> <span style="background-color:yellow;">Each</span> <span style="background-color:yellow;">pair</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">numbers</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">input</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">set.</span> <span style="background-color:yellow;">The</span> <span style="background-color:yellow;">rule</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">return</span> <span style="background-color:yellow;">only</span> <span style="background-color:yellow;">disjoint</span> <span style="background-color:yellow;">sets.</span> <span style="background-color:yellow;">So</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">read</span> <span style="background-color:yellow;">each</span> <span style="background-color:yellow;">line</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">convert</span> <span style="background-color:yellow;">them</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">sets</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">then</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">check</span> <span style="background-color:yellow;">all</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">existing</span> <span style="background-color:yellow;">sets</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">intersections</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">merge</span> <span style="background-color:yellow;">those</span> <span style="background-color:yellow;">into</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">new</span> <span style="background-color:yellow;">set.</span> <span style="background-color:yellow;">Nonintersecting</span> <span style="background-color:yellow;">sets</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">just</span> <span style="background-color:yellow;">added</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">new</span> <span style="background-color:yellow;">list</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">sets</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">once</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'m</span> <span style="background-color:yellow;">done</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">add</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">new</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">merged</span> <span style="background-color:yellow;">set</span> <span style="background-color:yellow;">into</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">new</span> <span style="background-color:yellow;">list</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">sets.</span> <span style="background-color:yellow;">This</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">sure</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">only</span> <span style="background-color:yellow;">disjoint</span> <span style="background-color:yellow;">sets</span> <span style="background-color:yellow;">make</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">into</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">list</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">6</span> </b><br /><p><span style="background-color:yellow;">My</span> <span style="background-color:yellow;">version</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">PHP</span> <span style="background-color:yellow;">actually</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">only</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">refactoring</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">code.</span> <span style="background-color:yellow;">It</span> <span style="background-color:yellow;">fixes</span> <span style="background-color:yellow;">one</span> <span style="background-color:yellow;">issue</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">one</span> <span style="background-color:yellow;">group</span> <span style="background-color:yellow;">too</span> <span style="background-color:yellow;">much</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">implemented</span> <span style="background-color:yellow;">slightly</span> <span style="background-color:yellow;">more</span> <span style="background-color:yellow;">efficient</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">Exec</span> <span style="background-color:yellow;">time</span> <span style="background-color:yellow;">drops</span> <span style="background-color:yellow;">from</span> <span style="background-color:yellow;">0.0035</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">0.0020</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">slow</span> <span style="background-color:yellow;">machine</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </p>
<p><span style="background-color:yellow;">$</span> <span style="background-color:yellow;">group</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">0</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">map</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">array</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">{</span> <span style="background-color:yellow;">list</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">b</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">explode</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">'</span> <span style="background-color:yellow;">'</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">fgets</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">file</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">int</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">b</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">int</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">b</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">!</span> <span style="background-color:yellow;">isset</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">map</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">&amp</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">&amp</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">!</span> <span style="background-color:yellow;">isset</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">map</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">b</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">{</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">map</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">map</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">b</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">+</span> <span style="background-color:yellow;">+</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">group</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">}</span> <span style="background-color:yellow;">elseif</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">!</span> <span style="background-color:yellow;">isset</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">map</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">b</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">{</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">map</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">b</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">map</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">}</span> <span style="background-color:yellow;">elseif</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">!</span> <span style="background-color:yellow;">isset</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">map</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">{</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">map</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">map</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">b</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">}</span> <span style="background-color:yellow;">elseif</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">map</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">!</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">map</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">b</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">{</span> <span style="background-color:yellow;">//</span> <span style="background-color:yellow;">move</span> <span style="background-color:yellow;">one</span> <span style="background-color:yellow;">group</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">other</span> <span style="background-color:yellow;">foreach</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">map</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">n</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">&gt</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">g</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">{</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">g</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">map</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">b</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">{</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">map</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">n</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">map</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">}</span> <span style="background-color:yellow;">}</span> <span style="background-color:yellow;">}</span> <span style="background-color:yellow;">}</span> <span style="background-color:yellow;">while</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">!</span> <span style="background-color:yellow;">feof</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">file</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">//</span> <span style="background-color:yellow;">print</span> <span style="background-color:yellow;">results</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">results</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">array</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">foreach</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">map</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">val</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">&gt</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">group</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">{</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">results</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">group</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">val</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">}</span> <span style="background-color:yellow;">echo</span> <span style="background-color:yellow;">'&lt</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">pre&gt</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">'</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">i</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">0</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">foreach</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">results</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">result</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">{</span> <span style="background-color:yellow;">sort</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">result</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">echo</span> <span style="background-color:yellow;">'Group</span> <span style="background-color:yellow;">'</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">+</span> <span style="background-color:yellow;">+</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">i</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">'</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">'</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">implode</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">'</span> <span style="background-color:yellow;">'</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">$</span> <span style="background-color:yellow;">result</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">\</span> <span style="background-color:yellow;">n</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">}</span> <span style="background-color:yellow;">#</span> <span style="background-color:yellow;">7</span> </p><p><span style="background-color:yellow;">If</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">input</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">sorted</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">like</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">huge</span> <span style="background-color:yellow;">test</span> <span style="background-color:yellow;">set</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">&Theta</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">input</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">time</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">&Omicron</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">input</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">space.</span> <span style="background-color:yellow;">If</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">input</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">unsorted</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">could</span> <span style="background-color:yellow;">modify</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">fairly</span> <span style="background-color:yellow;">easily</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">get</span> <span style="background-color:yellow;">&Omicron</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">input</span> <span style="background-color:yellow;">log</span> <span style="background-color:yellow;">input</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">time</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">&Theta</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">input</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">space</span> . </p>
<p><span style="background-color:yellow;">This</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">very</span> <span style="background-color:yellow;">quick</span> <span style="background-color:yellow;">because</span> <span style="background-color:yellow;">:</span> </p>
<ul><span style="background-color:yellow;">it</span> <span style="background-color:yellow;">stores</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">hash</span> <span style="background-color:yellow;">map</span> <span style="background-color:yellow;">from</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">node</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">its</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">ultimate</span> <span style="background-color:yellow;">owner</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">node</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">lowest</span> <span style="background-color:yellow;">ID</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">connected</span> <span style="background-color:yellow;">component</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">allows</span> <span style="background-color:yellow;">&Omicron</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">ultimate</span> <span style="background-color:yellow;">owner</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">lookup</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">insertion</span> . <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">stores</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">hash</span> <span style="background-color:yellow;">map</span> <span style="background-color:yellow;">from</span> <span style="background-color:yellow;">each</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">ultimate</span> <span style="background-color:yellow;">owner</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">result</span> <span style="background-color:yellow;">line</span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">allows</span> <span style="background-color:yellow;">&Omicron</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">result</span> <span style="background-color:yellow;">line</span> <span style="background-color:yellow;">lookup</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">insertion</span> . <span style="background-color:yellow;">each</span> <span style="background-color:yellow;">result</span> <span style="background-color:yellow;">line</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">linked</span> <span style="background-color:yellow;">list</span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">allows</span> <span style="background-color:yellow;">&Omicron</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">appending</span> . <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">stores</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">linked</span> <span style="background-color:yellow;">list</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">result</span> <span style="background-color:yellow;">lines</span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">allows</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">&Omicron</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">appending</span> . <span style="background-color:yellow;">access</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">without</span> <span style="background-color:yellow;">going</span> <span style="background-color:yellow;">through</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">expense</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">asking</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">prior</span> <span style="background-color:yellow;">hash</span> <span style="background-color:yellow;">map</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">all</span> <span style="background-color:yellow;">its</span> <span style="background-color:yellow;">values</span> </ul>
<pre><code>import java.util.Scanner;
import java.util.Map;
import java.util.HashMap;
import java.util.List;
import java.util.LinkedList;

public final class Solver {
  public static void main(String[] args) {
    Scanner in = new Scanner(System.in);
    final Map<Integer, Integer>       ultimateOwners = new HashMap<Integer, Integer>();
    final Map<Integer, List<Integer>> ownerToOwned   = new HashMap<Integer, List<Integer>>();
    final List<List<Integer>>         results        = new LinkedList<List<Integer>>();

    while (in.hasNextInt()) {
      // Get ultimate owner.
      int owner = in.nextInt();
      if (ultimateOwners.containsKey(owner)) owner = ultimateOwners.get(owner);

      // Get owned and register its ultimate owner.
      final int owned = in.nextInt();
      ultimateOwners.put(owned, owner);

      // Add owned to result.
      if (ownerToOwned.containsKey(owner)) ownerToOwned.get(owner).add(owned);
      else {
        final List<Integer> resultLine = new LinkedList<Integer>();
        resultLine.add(owner);
        resultLine.add(owned);
        ownerToOwned.put(owner, resultLine);
        results.add(resultLine);
      }
    }

    int lineNumber = 1;
    for (final List<Integer> line : results) {
      System.out.printf("%d: ", lineNumber++);
      for (final Integer value : line) {
        System.out.printf("%d ", value);
      }
      System.out.println();
    }
  }
}
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">8</span> </b><br /><p><span style="background-color:yellow;">After</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">being</span> <span style="background-color:yellow;">completely</span> <span style="background-color:yellow;">satisfied</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">my</span> <span style="background-color:yellow;">first</span> <span style="background-color:yellow;">2</span> <span style="background-color:yellow;">attempts</span> <span style="background-color:yellow;">at</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">some</span> <span style="background-color:yellow;">research</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">came</span> <span style="background-color:yellow;">across</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">recipe</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">disjoint</span> <span style="background-color:yellow;">sets</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">Raymond</span> <span style="background-color:yellow;">Hettinger</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">blessing</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">input.</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">Raymond</span> <span style="background-color:yellow;">Hettinger</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">long-time</span> <span style="background-color:yellow;">very</span> <span style="background-color:yellow;">active</span> <span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">core</span> <span style="background-color:yellow;">developer.</span> <span style="background-color:yellow;"></span> </p>
<p><span style="background-color:yellow;">Here</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">an</span> <span style="background-color:yellow;">adaptation</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">recipe</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">very</span> <span style="background-color:yellow;">close</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">my</span> <span style="background-color:yellow;">first</span> <span style="background-color:yellow;">2</span> <span style="background-color:yellow;">attempts</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">recipe</span> <span style="background-color:yellow;">itself</span> <span style="background-color:yellow;">may</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">better</span> <span style="background-color:yellow;">reference</span> . </p>
<p><span style="background-color:yellow;">Collecting</span> <span style="background-color:yellow;">should</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">efficient</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">possible</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">very</span> <span style="background-color:yellow;">large</span> <span style="background-color:yellow;">sets</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">data</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">much</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">set</span> <span style="background-color:yellow;">operations</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">implemented</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">C.</span> <span style="background-color:yellow;">The</span> <span style="background-color:yellow;">input</span> <span style="background-color:yellow;">data</span> <span style="background-color:yellow;">does</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">sorted.</span> <span style="background-color:yellow;">For</span> <span style="background-color:yellow;">printing</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">sorted</span> <span style="background-color:yellow;">outputs</span> <span style="background-color:yellow;">solely</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">readability</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">affects</span> <span style="background-color:yellow;">performance</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">connections</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">printed</span> <span style="background-color:yellow;">without</span> <span style="background-color:yellow;">sorting</span> . </p>
<pre><code># ~~~~~
# data, setup

input = '''
    1 2
    3 4
    2 3
    ''' # etc.

def lgen():
    for l in input.splitlines():
        l = l.strip()
        if l:
            yield tuple(int(i) for i in l.split())

# ~~~~~
# collect

connections = {} # this is a mapping of values to the connections they are in
                 # each node will map to a shared object instance of the connection it is in
                 # e.g. {1: set([1,2]), 2: set([1,2])}, where the 2 sets are the same object

for x, y in lgen():
    cx = connections.setdefault(x, set([x]))      # if not found, create new connection with this single value

    cy = connections.get(y)                 # defaults to None if not found
    if not cy:                              # if we haven't come across this value yet...
        cx.add(y)                           # ...add it to the current connection...
        connections[y] = cx                 # ...and update the reference
    elif cy is not cx:                      # if the cy connection is not the exact same object as the cx connection...
        if len(cy) > len(cx):               # \
            cx, cy = cy, cx                 #  >... merge them ...
        cx |= cy                            # /
        connections[y] = cx                 # ...and update the reference

# ~~~~~
# print

seen = set()
for key in sorted(connections.keys()):
    if key not in seen:
        c = connections[key]
        print sorted(c)
        seen |= c
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">9</span> </b><br /><p><span style="background-color:yellow;">This</span> <span style="background-color:yellow;">actually</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">very</span> <span style="background-color:yellow;">classic</span> <span style="background-color:yellow;">Union-find</span> . </p>
<p>If M is the number of edges, N the number of nodes, the time complexity is <strong>O(M * (M))</strong> which is a <strong>O(M)</strong> for all practical M and the space complexity if <strong>O(N)</strong> with N the number of nodes.</p>
<p><span style="background-color:yellow;">The</span> <span style="background-color:yellow;">algorithm</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">online</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">does</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">need</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">know</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">advance</span> <span style="background-color:yellow;">all</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">edges</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">compared</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">other</span> <span style="background-color:yellow;">graph-traversal</span> <span style="background-color:yellow;">solutions</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">hence</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">scale</span> <span style="background-color:yellow;">very</span> <span style="background-color:yellow;">well.</span> <span style="background-color:yellow;">Also</span> <span style="background-color:yellow;">there</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">no</span> <span style="background-color:yellow;">need</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">order</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">edges</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">they</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">given</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">any</span> <span style="background-color:yellow;">order</span> . </p>
<p><span style="background-color:yellow;">For</span> <span style="background-color:yellow;">graph</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">billions</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">nodes</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">'ll</span> <span style="background-color:yellow;">need</span> <span style="background-color:yellow;">64</span> <span style="background-color:yellow;">bits</span> <span style="background-color:yellow;">/</span> <span style="background-color:yellow;">long</span> <span style="background-color:yellow;">int</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">lot</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">RAM</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">should</span> <span style="background-color:yellow;">handle</span> <span style="background-color:yellow;">millions</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">nodes</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">billions</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">edges</span> <span style="background-color:yellow;">very</span> <span style="background-color:yellow;">well</span> . </p>
<p><span style="background-color:yellow;">The</span> <span style="background-color:yellow;">implementation</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">C</span> <span style="background-color:yellow;">+</span> <span style="background-color:yellow;">+</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">only</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">vector/map</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">find</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">almost</span> <span style="background-color:yellow;">any</span> <span style="background-color:yellow;">language</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">might</span> <span style="background-color:yellow;">want</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">use</span> . </p>
<hr />
<p><span style="background-color:yellow;">But</span> <span style="background-color:yellow;">since</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">unique</span> <span style="background-color:yellow;">id</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">each</span> <span style="background-color:yellow;">element</span> <span style="background-color:yellow;">we</span> <span style="background-color:yellow;">need</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">map</span> <span style="background-color:yellow;">these</span> <span style="background-color:yellow;">id</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">contiguous</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">integers</span> . </p>
<p><span style="background-color:yellow;">First</span> <span style="background-color:yellow;">version</span> <span style="background-color:yellow;">without</span> <span style="background-color:yellow;">mapping</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">suppose</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">all</span> <span style="background-color:yellow;">nodes</span> <span style="background-color:yellow;">between</span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">N</span> <span style="background-color:yellow;">exists</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </p>
<pre><code>#include <cstdio>
#include <algorithm>
#include <vector>
using namespace std;

const int MAX_N = 1000*1000;
int p[MAX_N],f[MAX_N];

int parent(int a) {
  return p[a] == a ? a : p[a] = parent(p[a]);
}
bool join(int a, int b) {
  p[a = parent(a)] = parent(b);
  return p[a] != a;
}

int main()
{
    // First integer in the file : number of nodes in the graph
    int N;
    scanf("%d",&N);
    // Union-find in O(M * alpha(M)) ~= O(M)
    // M = number of lines in the file
    for(int i = 1; i <= N ; i++)
    {
        p[i] = i;
        f[i] = -1;
    }
    int a,b;
    while(scanf("%d%d",&a,&b) != EOF)
        join(a,b);
    // Determine the number of groups : O(M)
    int nG = 0;
    for(int i = 1 ; i <= N ; i++)
    {
        p[i] = parent(p[i]);
        if(f[p[i]] == -1)
            f[p[i]] = nG++;
    }
    // Build groups : O(M)
    vector< vector<int> > Groups(N+1);
    for(int i = 1 ; i <= N ; i++)
        Groups[ f[p[i]] ].push_back(i);
    // Output result
    for(int i = 0 ; i < Groups.size() ; i++)
    {
        if(!Groups[i].size())
            continue;
        printf("%d : ",i);
        for(int j = 0 ; j < Groups[i].size() ; j++)
            printf("%d ",Groups[i][j]);
        printf("\n");
    }

}
</code></pre>
<p><span style="background-color:yellow;">Version</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">mapping</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">version</span> <span style="background-color:yellow;">we</span> <span style="background-color:yellow;">need</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">build</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">mapping.</span> <span style="background-color:yellow;">Since</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">know</span> <span style="background-color:yellow;">anything</span> <span style="background-color:yellow;">about</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">data</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'m</span> <span style="background-color:yellow;">using</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">classical</span> <span style="background-color:yellow;">map</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">build</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">O</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">M</span> <span style="background-color:yellow;">log</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">N</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">send</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">id</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">all</span> <span style="background-color:yellow;">nodes</span> <span style="background-color:yellow;">at</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">begin</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">input</span> <span style="background-color:yellow;">file</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">O</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">N</span> <span style="background-color:yellow;">log</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">N</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">even</span> <span style="background-color:yellow;">better</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">using</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">Hash</span> <span style="background-color:yellow;">Map</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">O</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">N</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">build</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">mapping</span> <span style="background-color:yellow;">yourself</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">some</span> <span style="background-color:yellow;">knowing</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">graph</span> . </p>
<p><span style="background-color:yellow;">Anyway</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">here</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>#include <cstdio>
#include <algorithm>
#include <vector>
#include <map>
using namespace std;

const int MAX_N = 1000*1000;
int p[MAX_N],f[MAX_N];

int parent(int a) {
  return p[a] == a ? a : p[a] = parent(p[a]);
}
bool join(int a, int b) {
  p[a = parent(a)] = parent(b);
  return p[a] != a;
}
// Mapping
int N = 0;
map<int,int> indMap,invMap;
int IND(int x) {
    if(indMap.find(x) == indMap.end())
    {
        N++;
        p[N] = N;
        f[N] = -1;
        indMap[x] = N;
    }
    invMap[ indMap[x] ] = x;
    return indMap[x];
}


int main()
{
    // Union-find in O(M * alpha(M)) ~= O(M)
    // M = number of lines in the file
    int a,b;
    while(scanf("%d%d",&a,&b) != EOF)
        join(IND(a),IND(b));
    // Determine the number of groups : O(M)
    int nG = 0;
    for(int i = 1 ; i <= N ; i++)
    {
        p[i] = parent(p[i]);
        if(f[p[i]] == -1)
            f[p[i]] = nG++;
    }
    // Build groups : O(M)
    vector< vector<int> > Groups(N+1);
    for(int i = 1 ; i <= N ; i++)
        Groups[ f[p[i]] ].push_back(i);
    // Output result
    for(int i = 0 ; i < Groups.size() ; i++)
    {
        if(!Groups[i].size())
            continue;
        printf("%d : ",i+1);
        for(int j = 0 ; j < Groups[i].size() ; j++)
            printf("%d ", invMap[ Groups[i][j] ]);
        printf("\n");
    }

}
</code></pre>
<br />