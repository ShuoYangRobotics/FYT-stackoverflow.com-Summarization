<h3><span style="background-color:yellow;">Question</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">ID-1411943</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </h3><h2><span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">what</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">pythonic</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">perform</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">loop</span> ? </h2><p><span style="background-color:yellow;">What</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">pythonic</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">perform</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">loop.</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'m</span> <span style="background-color:yellow;">trying</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">pick</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">random</span> <span style="background-color:yellow;">key</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">will</span> <span style="background-color:yellow;">return</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">subtree</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">root.</span> <span style="background-color:yellow;">Hence</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">'parent</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">None</span> <span style="background-color:yellow;">'</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">true.</span> <span style="background-color:yellow;">Nor</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">'isRoot</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">True</span> <span style="background-color:yellow;">'</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">true</span> . </p>
<pre><code>thekey = random.choice(tree.thedict.keys())
while (tree.thedict[thekey].parent == None)or(tree.thedict[thekey].isRoot == True):
        thekey = random.choice(tree.thedict.keys())
.......
</code></pre>
<p><span style="background-color:yellow;">edit</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">works</span> <span style="background-color:yellow;">now</span> </p>
<br /><h3><span style="background-color:yellow;">Answers</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">Total-9</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </h3><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">0</span> </b><br /><blockquote><span style="background-color:yellow;">get</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">random</span> <span style="background-color:yellow;">subtree</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">root</span> </blockquote>
<pre><code>not_root_nodes = [key, node for key,node in tree.thedict.iteritems() if not ( node.parent is None or node.isRoot)]
item = random.choice( not_root_nodes )
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">1</span> </b><br /><pre><code>key = random.choice([key for key, subtree in tree.thedict.items()
                         if subtree.parent and not subtree.isRoot])
</code></pre>
<p><span style="background-color:yellow;"></span> <span style="background-color:yellow;">Corrected</span> <span style="background-color:yellow;">after</span> <span style="background-color:yellow;">comments</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">question</span> <span style="background-color:yellow;">edition</span> <span style="background-color:yellow;"></span> </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">2</span> </b><br /><pre><code>thekey = random.choice(tree.thedict.keys())
parent = thedict[thekey].parent
while parent is None or parent.isRoot:
    thekey = random.choice(tree.thedict.keys())
    parent = thedict[thekey].parent
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">3</span> </b><br /><p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">think</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">bit</span> <span style="background-color:yellow;">better</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>theDict = tree.thedict

def getKey():
    return random.choice(theDict.keys())

theKey = getKey()

while theDict[thekey].parent in (None, True):
    thekey = getKey()
</code></pre>
<p><span style="background-color:yellow;">What</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">think</span> ? </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">4</span> </b><br /><p><span style="background-color:yellow;">break</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">while</span> <span style="background-color:yellow;">clause</span> <span style="background-color:yellow;">up</span> <span style="background-color:yellow;">into</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">few</span> <span style="background-color:yellow;">chunks</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">will</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">easier</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">understand</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">debug</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">5</span> </b><br /><pre><code>def is_root(v): 
  assert (v.parent != None) == (v.isRoot)
  return v.isRoot
  #note how dumb this function looks when you guarantee that assertion

def get_random_nonroot_key():
  while True:
    thekey = random.choice(tree.thedict.keys())
    value = tree.thedict[thekey]
    if not is_root(value): return key
</code></pre>
<p><span style="background-color:yellow;">or</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">refactoring</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">Roberto</span> <span style="background-color:yellow;">Bonvallet</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">answer</span> </p>
<pre><code>def get_random_nonroot_key():
  eligible_keys = [k for k, v in tree.thedict.items() if not is_root(v)]
  return random.choice(eligible_keys)
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">6</span> </b><br /><p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">think</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">while</span> <span style="background-color:yellow;">condition</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">flawed</span> <span style="background-color:yellow;">:</span> </p>
<p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">think</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">expect</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">tree.thedict</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">thekey</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">.parent</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">None</span> <span style="background-color:yellow;">should</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">equal</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">tree.thedict</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">thekey</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">.parent.isRoot</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">True</span> </p>
<p><span style="background-color:yellow;">When</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">fact</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">both</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">mean</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">node</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">root</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">should</span> <span style="background-color:yellow;">change</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">second</span> <span style="background-color:yellow;">statement</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">tree.thedict</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">thekey</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">.isRoot</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">True</span> </p>
<p><span style="background-color:yellow;">As</span> <span style="background-color:yellow;">written</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">conditional</span> <span style="background-color:yellow;">test</span> <span style="background-color:yellow;">says</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">while</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">node</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">root</span> <span style="background-color:yellow;">OR</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">node</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">parent</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">root</span> <span style="background-color:yellow;">"</span> . <span style="background-color:yellow;">If</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">tree</span> <span style="background-color:yellow;">structure</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">single</span> <span style="background-color:yellow;">root</span> <span style="background-color:yellow;">node</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">many</span> <span style="background-color:yellow;">leaf</span> <span style="background-color:yellow;">nodes</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">should</span> <span style="background-color:yellow;">expect</span> <span style="background-color:yellow;">an</span> <span style="background-color:yellow;">infinite</span> <span style="background-color:yellow;">loop</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">case</span> . </p>
<p><span style="background-color:yellow;">Here</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">rewrite</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>thekey = random.choice(k for k in tree.thedict.keys() if not k.isRoot)
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">7</span> </b><br /><pre><code>thekey = random.choice(tree.thedict.keys())
parent = tree.thedict[thekey].parent
while parent is None or tree.thedict[thekey].isRoot:
    thekey = random.choice(tree.thedict.keys())
    parent = thedict[thekey].parent
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">8</span> </b><br /><p><span style="background-color:yellow;">Personally</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">like</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">repetition</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">initializing</span> <span style="background-color:yellow;">thekey</span> <span style="background-color:yellow;">before</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">while</span> <span style="background-color:yellow;">loop</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">then</span> <span style="background-color:yellow;">again</span> <span style="background-color:yellow;">inside</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">loop.</span> <span style="background-color:yellow;">It</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">possible</span> <span style="background-color:yellow;">source</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">bugs</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">what</span> <span style="background-color:yellow;">happens</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">someone</span> <span style="background-color:yellow;">edits</span> <span style="background-color:yellow;">one</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">two</span> <span style="background-color:yellow;">initializations</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">forgets</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">edit</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">other</span> ? <span style="background-color:yellow;">Even</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">never</span> <span style="background-color:yellow;">happens</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">anyone</span> <span style="background-color:yellow;">reading</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;">needs</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">check</span> <span style="background-color:yellow;">carefully</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">make</span> <span style="background-color:yellow;">sure</span> <span style="background-color:yellow;">both</span> <span style="background-color:yellow;">initializations</span> <span style="background-color:yellow;">match</span> <span style="background-color:yellow;">perfectly</span> . </p>
<p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">would</span> <span style="background-color:yellow;">write</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">like</span> <span style="background-color:yellow;">so</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>while True:
    thekey = random.choice(tree.thedict.keys())
    subtree = tree.thedict[thekey]
    if subtree.parent is not None and not subtree.isRoot:
        break
</code></pre>
<p><span style="background-color:yellow;">P.S.</span> <span style="background-color:yellow;">If</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">really</span> <span style="background-color:yellow;">just</span> <span style="background-color:yellow;">want</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">subtree</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">care</span> <span style="background-color:yellow;">about</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">key</span> <span style="background-color:yellow;">needed</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">lookup</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">subtree</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">could</span> <span style="background-color:yellow;">even</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>while True:
    subtree = random.choice(tree.thedict.values())
    if subtree.parent is not None and not subtree.isRoot:
        break
</code></pre>
<p><span style="background-color:yellow;">Some</span> <span style="background-color:yellow;">people</span> <span style="background-color:yellow;">may</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">like</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">while</span> <span style="background-color:yellow;">True</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">standard</span> <span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">idiom</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">loop</span> <span style="background-color:yellow;">forever</span> <span style="background-color:yellow;">until</span> <span style="background-color:yellow;">something</span> <span style="background-color:yellow;">runs</span> <span style="background-color:yellow;">break</span> <span style="background-color:yellow;">"</span> . <span style="background-color:yellow;">IMHO</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">simple</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">clear</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">idiomatic</span> <span style="background-color:yellow;">Python</span> . </p>
<p><span style="background-color:yellow;">P.P.S.</span> <span style="background-color:yellow;">This</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;">should</span> <span style="background-color:yellow;">really</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">wrapped</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">an</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">statement</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">checks</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">tree</span> <span style="background-color:yellow;">has</span> <span style="background-color:yellow;">more</span> <span style="background-color:yellow;">than</span> <span style="background-color:yellow;">one</span> <span style="background-color:yellow;">node.</span> <span style="background-color:yellow;">If</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">tree</span> <span style="background-color:yellow;">only</span> <span style="background-color:yellow;">has</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">root</span> <span style="background-color:yellow;">node</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;">would</span> <span style="background-color:yellow;">loop</span> <span style="background-color:yellow;">forever</span> . </p>
<br />