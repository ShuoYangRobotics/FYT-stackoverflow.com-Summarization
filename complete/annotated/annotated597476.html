<h3><span style="background-color:yellow;">Question</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">ID-597476</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </h3><h2><span style="background-color:yellow;">How</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">concisely</span> <span style="background-color:yellow;">cascade</span> <span style="background-color:yellow;">through</span> <span style="background-color:yellow;">multiple</span> <span style="background-color:yellow;">regex</span> <span style="background-color:yellow;">statements</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">Python</span> </h2><p><span style="background-color:yellow;">My</span> <span style="background-color:yellow;">dilemma</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'m</span> <span style="background-color:yellow;">passing</span> <span style="background-color:yellow;">my</span> <span style="background-color:yellow;">function</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">string</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">need</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">then</span> <span style="background-color:yellow;">perform</span> <span style="background-color:yellow;">numerous</span> <span style="background-color:yellow;">regex</span> <span style="background-color:yellow;">manipulations</span> <span style="background-color:yellow;">on.</span> <span style="background-color:yellow;">The</span> <span style="background-color:yellow;">logic</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">there</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">match</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">first</span> <span style="background-color:yellow;">regex</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">one</span> <span style="background-color:yellow;">thing.</span> <span style="background-color:yellow;">If</span> <span style="background-color:yellow;">no</span> <span style="background-color:yellow;">match</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">check</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">match</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">second</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">something</span> <span style="background-color:yellow;">else</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">check</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">third</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">so</span> <span style="background-color:yellow;">forth.</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">could</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">something</span> <span style="background-color:yellow;">like</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>if re.match('regex1', string):
    match = re.match('regex1', string)
    # Manipulate match.group(n) and return
elif re.match('regex2', string):
    match = re.match('regex2', string)
    # Do second manipulation
[etc.]
</code></pre>
<p><span style="background-color:yellow;">However</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">feels</span> <span style="background-color:yellow;">unnecessarily</span> <span style="background-color:yellow;">verbose</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">usually</span> <span style="background-color:yellow;">when</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">case</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">means</span> <span style="background-color:yellow;">there</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">better</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'m</span> <span style="background-color:yellow;">either</span> <span style="background-color:yellow;">overlooking</span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">yet</span> <span style="background-color:yellow;">know</span> <span style="background-color:yellow;">about</span> . </p>
<p><span style="background-color:yellow;">Does</span> <span style="background-color:yellow;">anyone</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">suggestion</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">better</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">better</span> <span style="background-color:yellow;">from</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">code-appearance</span> <span style="background-color:yellow;">standpoint</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">memory</span> <span style="background-color:yellow;">usage</span> <span style="background-color:yellow;">standpoint</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">both</span> <span style="background-color:yellow;"></span> ? </p>
<br /><h3><span style="background-color:yellow;">Answers</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">Total-7</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </h3><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">0</span> </b><br /><p><span style="background-color:yellow;">Generally</span> <span style="background-color:yellow;">speaking</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">these</span> <span style="background-color:yellow;">sorts</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">situations</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">want</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">make</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">data</span> <span style="background-color:yellow;">driven</span> <span style="background-color:yellow;">"</span> . <span style="background-color:yellow;">That</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">put</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">important</span> <span style="background-color:yellow;">information</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">container</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">loop</span> <span style="background-color:yellow;">through</span> <span style="background-color:yellow;">it</span> . </p>
<p><span style="background-color:yellow;">In</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">case</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">important</span> <span style="background-color:yellow;">information</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">string</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">function</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">pairs</span> . </p>
<pre><code>import re

def fun1():
    print('fun1')

def fun2():
    print('fun2')

def fun3():
    print('fun3')

regex_handlers = [
    (r'regex1', fun1),
    (r'regex2', fun2),
    (r'regex3', fun3)
    ]

def example(string):
    for regex, fun in regex_handlers:
        if re.match(regex, string):
            fun()  # call the function
            break

example('regex2')
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">1</span> </b><br /><p><span style="background-color:yellow;">Similar</span> <span style="background-color:yellow;">question</span> <span style="background-color:yellow;">from</span> <span style="background-color:yellow;">back</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">september</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">How</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">translate</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">regular-expression</span> <span style="background-color:yellow;">idiom</span> <span style="background-color:yellow;">from</span> <span style="background-color:yellow;">Perl</span> <span style="background-color:yellow;">into</span> <span style="background-color:yellow;">Python</span> ? </p>
<p><span style="background-color:yellow;">Using</span> <span style="background-color:yellow;">global</span> <span style="background-color:yellow;">variables</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">module</span> <span style="background-color:yellow;">maybe</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">best</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">converting</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">into</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">class</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>import re

class Re(object):
  def __init__(self):
    self.last_match = None
  def match(self,pattern,text):
    self.last_match = re.match(pattern,text)
    return self.last_match
  def search(self,pattern,text):
    self.last_match = re.search(pattern,text)
    return self.last_match

gre = Re()
if gre.match(r'foo',text):
  # do something with gre.last_match
elif gre.match(r'bar',text):
  # do something with gre.last_match
else:
  # do something else
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">2</span> </b><br /><p>I had the same problem as yours. HereÂ´s my solution:</p>
<pre><code>import re

regexp = {
    'key1': re.compile(r'regexp1'),
    'key2': re.compile(r'regexp2'),
    'key3': re.compile(r'regexp3'),
    # ...
}

def test_all_regexp(string):
    for key, pattern in regexp.items():
        m = pattern.match(string)
        if m:
            # do what you want
            break
</code></pre>
<p>ItÂ´s a slightly modified solution from the answer of <a href="http://stackoverflow.com/questions/481862/extracting-info-from-large-structured-text-files">Extracting info from large structured text files</a></p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">3</span> </b><br /><p><span style="background-color:yellow;">Hmm...</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">could</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">something</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">construct...</span> <span style="background-color:yellow;">um</span> </p>
<pre><code>class rewrapper()
    def __init__(self, pattern, target):
        something

    def __enter__(self):
        something

    def __exit__(self):
        something


 with rewrapper("regex1", string) as match:
    etc

 with rewrapper("regex2", string) as match: 
    and so forth
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">4</span> </b><br /><p><span style="background-color:yellow;">Are</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">manipulations</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">each</span> <span style="background-color:yellow;">regex</span> <span style="background-color:yellow;">similar</span> ? <span style="background-color:yellow;">If</span> <span style="background-color:yellow;">so</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">try</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>for regex in ('regex1', 'regex2', 'regex3', 'regex4'):
    match = re.match(regex, string)
    if match:
        # Manipulate match.group(n)
        return result
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">5</span> </b><br /><p><span style="background-color:yellow;">Here</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">regexs</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">matches</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">repeated</span> <span style="background-color:yellow;">twice</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>match = re.match('regex1', string)
if match:
    # do stuff
    return

match = re.match('regex2', string)
if match:
    # do stuff
    return
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">6</span> </b><br /><pre><code>class RegexStore(object):
   _searches = None

   def __init__(self, pat_list):
      # build RegEx searches
      self._searches = [(name,re.compile(pat, re.VERBOSE)) for
                        name,pat in pat_list]

   def match( self, text ):
      match_all = ((x,y.match(text)) for x,y in self._searches)
      try:
         return ifilter(op.itemgetter(1), match_all).next()
      except StopIteration, e:
         # instead of 'name', in first arg, return bad 'text' line
         return (text,None)
</code></pre>
<p><span style="background-color:yellow;">You</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">class</span> <span style="background-color:yellow;">like</span> <span style="background-color:yellow;">so</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>rs = RegexStore( (('pat1', r'.*STRING1.*'),
                  ('pat2', r'.*STRING2.*')) )
name,match = rs.match( "MY SAMPLE STRING1" )

if name == 'pat1':
   print 'found pat1'
elif name == 'pat2':
   print 'found pat2'
</code></pre>
<br />