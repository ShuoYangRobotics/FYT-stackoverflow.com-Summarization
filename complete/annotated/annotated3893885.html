<h3><span style="background-color:yellow;">Question</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">ID-3893885</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </h3><h2><span style="background-color:yellow;">Cheap</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">search</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">large</span> <span style="background-color:yellow;">text</span> <span style="background-color:yellow;">file</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">string</span> </h2><p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">need</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">search</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">pretty</span> <span style="background-color:yellow;">large</span> <span style="background-color:yellow;">text</span> <span style="background-color:yellow;">file</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">particular</span> <span style="background-color:yellow;">string.</span> <span style="background-color:yellow;">Whats</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">best</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">go</span> <span style="background-color:yellow;">about</span> <span style="background-color:yellow;">doing</span> <span style="background-color:yellow;">that</span> ? </p>
<p><span style="background-color:yellow;">Thanks</span> </p>
<p><span style="background-color:yellow;">Edit</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">Should</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">given</span> <span style="background-color:yellow;">more</span> <span style="background-color:yellow;">detail</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">my</span> <span style="background-color:yellow;">bad.</span> <span style="background-color:yellow;">Its</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">build</span> <span style="background-color:yellow;">log</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">about</span> <span style="background-color:yellow;">5000</span> <span style="background-color:yellow;">lines</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">text.</span> <span style="background-color:yellow;">Using</span> <span style="background-color:yellow;">regex</span> <span style="background-color:yellow;">should</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">cause</span> <span style="background-color:yellow;">any</span> <span style="background-color:yellow;">problems</span> <span style="background-color:yellow;">should</span> <span style="background-color:yellow;">it</span> ? <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'ll</span> <span style="background-color:yellow;">go</span> <span style="background-color:yellow;">ahead</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">read</span> <span style="background-color:yellow;">blocks</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">lines</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">simple</span> <span style="background-color:yellow;">find.</span> <span style="background-color:yellow;">Thanks</span> <span style="background-color:yellow;">guys</span> . </p>
<br /><h3><span style="background-color:yellow;">Answers</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">Total-6</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </h3><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">0</span> </b><br /><p><span style="background-color:yellow;">If</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">pretty</span> <span style="background-color:yellow;">large</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">file</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">then</span> <span style="background-color:yellow;">access</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">lines</span> <span style="background-color:yellow;">sequentially</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">read</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">whole</span> <span style="background-color:yellow;">file</span> <span style="background-color:yellow;">into</span> <span style="background-color:yellow;">memory</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>with open('largeFile', 'r') as inF:
    for line in inF:
        if 'myString' in line:
            # do_something
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">1</span> </b><br /><p><span style="background-color:yellow;">You</span> <span style="background-color:yellow;">could</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">simple</span> <span style="background-color:yellow;">find</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>f = open('file.txt', 'r')
lines = f.read()
answer = lines.find('string')
</code></pre>
<p><span style="background-color:yellow;">A</span> <span style="background-color:yellow;">simple</span> <span style="background-color:yellow;">find</span> <span style="background-color:yellow;">will</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">quite</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">bit</span> <span style="background-color:yellow;">quicker</span> <span style="background-color:yellow;">than</span> <span style="background-color:yellow;">regex</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">get</span> <span style="background-color:yellow;">away</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">it</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">2</span> </b><br /><p><span style="background-color:yellow;">If</span> <span style="background-color:yellow;">there</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">no</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">tell</span> <span style="background-color:yellow;">where</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">string</span> <span style="background-color:yellow;">will</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">first</span> <span style="background-color:yellow;">half</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">second</span> <span style="background-color:yellow;">half</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">etc</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">then</span> <span style="background-color:yellow;">there</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">really</span> <span style="background-color:yellow;">no</span> <span style="background-color:yellow;">optimized</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">search</span> <span style="background-color:yellow;">other</span> <span style="background-color:yellow;">than</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">builtin</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">find</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">function.</span> <span style="background-color:yellow;">You</span> <span style="background-color:yellow;">could</span> <span style="background-color:yellow;">reduce</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">I/O</span> <span style="background-color:yellow;">time</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">memory</span> <span style="background-color:yellow;">consumption</span> <span style="background-color:yellow;">by</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">reading</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">file</span> <span style="background-color:yellow;">all</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">one</span> <span style="background-color:yellow;">shot</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">at</span> <span style="background-color:yellow;">4kb</span> <span style="background-color:yellow;">blocks</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">usually</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">size</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">an</span> <span style="background-color:yellow;">hard</span> <span style="background-color:yellow;">disk</span> <span style="background-color:yellow;">block</span> <span style="background-color:yellow;"></span> . <span style="background-color:yellow;">This</span> <span style="background-color:yellow;">will</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">make</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">search</span> <span style="background-color:yellow;">faster</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">unless</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">string</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">first</span> <span style="background-color:yellow;">part</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">file</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">all</span> <span style="background-color:yellow;">case</span> <span style="background-color:yellow;">will</span> <span style="background-color:yellow;">reduce</span> <span style="background-color:yellow;">memory</span> <span style="background-color:yellow;">consumption</span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">might</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">good</span> <span style="background-color:yellow;">idea</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">file</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">huge</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">3</span> </b><br /><p><span style="background-color:yellow;">The</span> <span style="background-color:yellow;">following</span> <span style="background-color:yellow;">function</span> <span style="background-color:yellow;">works</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">textfiles</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">binary</span> <span style="background-color:yellow;">files</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">returns</span> <span style="background-color:yellow;">only</span> <span style="background-color:yellow;">position</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">byte-count</span> <span style="background-color:yellow;">though</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">does</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">benefit</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">find</span> <span style="background-color:yellow;">strings</span> <span style="background-color:yellow;">even</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">they</span> <span style="background-color:yellow;">would</span> <span style="background-color:yellow;">overlap</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">line</span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">buffer</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">would</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">found</span> <span style="background-color:yellow;">when</span> <span style="background-color:yellow;">searching</span> <span style="background-color:yellow;">line-</span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">buffer-wise</span> . </p>
<pre><code>def fnd(fname, s, start=0):
    with open(fname, 'rb') as f:
        fsize = os.path.getsize(fname)
        bsize = 4096
        buffer = None
        if start > 0:
            f.seek(start)
        overlap = len(s) - 1
        while True:
            if (f.tell() >= overlap and f.tell() < fsize):
                f.seek(f.tell() - overlap)
            buffer = f.read(bsize)
            if buffer:
                pos = buffer.find(s)
                if pos >= 0:
                    return f.tell() - (len(buffer) - pos)
            else:
                return -1
</code></pre>
<p><span style="background-color:yellow;">The</span> <span style="background-color:yellow;">idea</span> <span style="background-color:yellow;">behind</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">:</span> </p>
<ul><span style="background-color:yellow;">seek</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">start</span> <span style="background-color:yellow;">position</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">file</span> <span style="background-color:yellow;">read</span> <span style="background-color:yellow;">from</span> <span style="background-color:yellow;">file</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">buffer</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">search</span> <span style="background-color:yellow;">strings</span> <span style="background-color:yellow;">has</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">smaller</span> <span style="background-color:yellow;">than</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">buffer</span> <span style="background-color:yellow;">size</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">at</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">beginning</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">drop</span> <span style="background-color:yellow;">back</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">-</span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;">bytes</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">catch</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">string</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">started</span> <span style="background-color:yellow;">at</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">end</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">last</span> <span style="background-color:yellow;">read</span> <span style="background-color:yellow;">buffer</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">continued</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">next</span> <span style="background-color:yellow;">one</span> . <span style="background-color:yellow;">return</span> <span style="background-color:yellow;">position</span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">-1</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">found</span> </ul>
<p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">used</span> <span style="background-color:yellow;">something</span> <span style="background-color:yellow;">like</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">find</span> <span style="background-color:yellow;">signatures</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">files</span> <span style="background-color:yellow;">inside</span> <span style="background-color:yellow;">larger</span> <span style="background-color:yellow;">ISO9660</span> <span style="background-color:yellow;">files</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">was</span> <span style="background-color:yellow;">quite</span> <span style="background-color:yellow;">fast</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">did</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">much</span> <span style="background-color:yellow;">memory</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">also</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">larger</span> <span style="background-color:yellow;">buffer</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">speed</span> <span style="background-color:yellow;">things</span> <span style="background-color:yellow;">up</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">4</span> </b><br /><p><span style="background-color:yellow;">5000</span> <span style="background-color:yellow;">lines</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">big</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">well</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">depends</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">how</span> <span style="background-color:yellow;">long</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">lines</span> <span style="background-color:yellow;">are...</span> <span style="background-color:yellow;"></span> </p>
<p><span style="background-color:yellow;">Anyway</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">assuming</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">string</span> <span style="background-color:yellow;">will</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">word</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">will</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">seperated</span> <span style="background-color:yellow;">by</span> <span style="background-color:yellow;">whitespace..</span> . </p>
<pre><code>lines=open(file_path,'r').readlines()
str_wanted="whatever_youre_looking_for"


    for i in range(len(lines)):
        l1=lines.split()
        for p in range(len(l1)):
            if l1[p]==str_wanted:
                #found
                # i is the file line, lines[i] is the full line, etc.
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">5</span> </b><br /><p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'ve</span> <span style="background-color:yellow;">had</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">go</span> <span style="background-color:yellow;">at</span> <span style="background-color:yellow;">putting</span> <span style="background-color:yellow;">together</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">multiprocessing</span> <span style="background-color:yellow;">example</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">file</span> <span style="background-color:yellow;">text</span> <span style="background-color:yellow;">searching.</span> <span style="background-color:yellow;">This</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">my</span> <span style="background-color:yellow;">first</span> <span style="background-color:yellow;">effort</span> <span style="background-color:yellow;">at</span> <span style="background-color:yellow;">using</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">multiprocessing</span> <span style="background-color:yellow;">module</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'m</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">python</span> <span style="background-color:yellow;">n00b.</span> <span style="background-color:yellow;">Comments</span> <span style="background-color:yellow;">quite</span> <span style="background-color:yellow;">welcome.</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'ll</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">wait</span> <span style="background-color:yellow;">until</span> <span style="background-color:yellow;">at</span> <span style="background-color:yellow;">work</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">test</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">really</span> <span style="background-color:yellow;">big</span> <span style="background-color:yellow;">files.</span> <span style="background-color:yellow;">It</span> <span style="background-color:yellow;">should</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">faster</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">multi</span> <span style="background-color:yellow;">core</span> <span style="background-color:yellow;">systems</span> <span style="background-color:yellow;">than</span> <span style="background-color:yellow;">single</span> <span style="background-color:yellow;">core</span> <span style="background-color:yellow;">searching.</span> <span style="background-color:yellow;">Bleagh</span> <span style="background-color:yellow;">!</span> <span style="background-color:yellow;">How</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">stop</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">processes</span> <span style="background-color:yellow;">once</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">text</span> <span style="background-color:yellow;">has</span> <span style="background-color:yellow;">been</span> <span style="background-color:yellow;">found</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">reliably</span> <span style="background-color:yellow;">report</span> <span style="background-color:yellow;">line</span> <span style="background-color:yellow;">number</span> ? </p>
<pre><code>import multiprocessing, os, time
NUMBER_OF_PROCESSES = multiprocessing.cpu_count()

def FindText( host, file_name, text):
    file_size = os.stat(file_name ).st_size 
    m1 = open(file_name, "r")

    #work out file size to divide up to farm out line counting

    chunk = (file_size / NUMBER_OF_PROCESSES ) + 1
    lines = 0
    line_found_at = -1

    seekStart = chunk * (host)
    seekEnd = chunk * (host+1)
    if seekEnd > file_size:
        seekEnd = file_size

    if host > 0:
        m1.seek( seekStart )
        m1.readline()

    line = m1.readline()

    while len(line) > 0:
        lines += 1
        if text in line:
            #found the line
            line_found_at = lines
            break
        if m1.tell() > seekEnd or len(line) == 0:
            break
        line = m1.readline()
    m1.close()
    return host,lines,line_found_at

# Function run by worker processes
def worker(input, output):
    for host,file_name,text in iter(input.get, 'STOP'):
        output.put(FindText( host,file_name,text ))

def main(file_name,text):
    t_start = time.time()
    # Create queues
    task_queue = multiprocessing.Queue()
    done_queue = multiprocessing.Queue()
    #submit file to open and text to find
    print 'Starting', NUMBER_OF_PROCESSES, 'searching workers'
    for h in range( NUMBER_OF_PROCESSES ):
        t = (h,file_name,text)
        task_queue.put(t)

    #Start worker processes
    for _i in range(NUMBER_OF_PROCESSES):
        multiprocessing.Process(target=worker, args=(task_queue, done_queue)).start()

    # Get and print results

    results = {}
    for _i in range(NUMBER_OF_PROCESSES):
        host,lines,line_found = done_queue.get()
        results[host] = (lines,line_found)

    # Tell child processes to stop
    for _i in range(NUMBER_OF_PROCESSES):
        task_queue.put('STOP')
#        print "Stopping Process #%s" % i

    total_lines = 0
    for h in range(NUMBER_OF_PROCESSES):
        if results[h][1] > -1:
            print text, 'Found at', total_lines + results[h][1], 'in', time.time() - t_start, 'seconds'
            break
        total_lines += results[h][0]

if __name__ == "__main__":
    main( file_name = 'testFile.txt', text = 'IPI1520' )
</code></pre>
<br />