<h3><span style="background-color:yellow;">Question</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">ID-4251732</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </h3><h2><span style="background-color:yellow;">Fast</span> <span style="background-color:yellow;">algorithm</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">calculate</span> <span style="background-color:yellow;">delta</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">two</span> <span style="background-color:yellow;">list</span> </h2><p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">two</span> <span style="background-color:yellow;">list</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">album</span> <span style="background-color:yellow;">names</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">ordered</span> <span style="background-color:yellow;">by</span> <span style="background-color:yellow;">some</span> <span style="background-color:yellow;">score</span> . </p>
<pre><code>albums_today = ['album1', 'album2', 'album3']
albums_yesterday = ['album2', 'album1', 'album3']
</code></pre>
<p><span style="background-color:yellow;">How</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">calculate</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">change</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">list</span> <span style="background-color:yellow;">order</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">get</span> <span style="background-color:yellow;">something</span> <span style="background-color:yellow;">like</span> </p>
<pre><code>{'album1':1, 'album2':-1, 'album3':0}
</code></pre>
<br /><h3><span style="background-color:yellow;">Answers</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">Total-7</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </h3><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">0</span> </b><br /><pre><code>>>> albums_today = ['album1', 'album2', 'album3']
>>> albums_yesterday = ['album2', 'album1', 'album3']
>>> D = dict((k,v) for v,k in enumerate(albums_yesterday))
>>> dict((k,D[k]-v) for v,k in enumerate(albums_today))
{'album1': 1, 'album3': 0, 'album2': -1}
</code></pre>
<p><span style="background-color:yellow;">In</span> <span style="background-color:yellow;">Python2.7</span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">Python3</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">written</span> <span style="background-color:yellow;">even</span> <span style="background-color:yellow;">more</span> <span style="background-color:yellow;">simply</span> </p>
<pre><code>>>> albums_today = ['album1', 'album2', 'album3']
>>> albums_yesterday = ['album2', 'album1', 'album3']
>>> D = {k:v for v,k in enumerate(albums_yesterday)}
>>> {k:D[k]-v for v,k in enumerate(albums_today)}
{'album1': 1, 'album3': 0, 'album2': -1}
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">1</span> </b><br /><p><span style="background-color:yellow;">how</span> <span style="background-color:yellow;">about</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>def delta(a, b):
    rank_a = dict((k, v) for v, k in enumerate(a))
    rank_b = enumerate(b)
    return dict((k, rank_a[k]-i) for i, k in rank_b)
</code></pre>
<p><span style="background-color:yellow;">which</span> <span style="background-color:yellow;">only</span> <span style="background-color:yellow;">creates</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">single</span> <span style="background-color:yellow;">dict</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">look</span> <span style="background-color:yellow;">things</span> <span style="background-color:yellow;">up</span> <span style="background-color:yellow;">into</span> . </p>
<p><span style="background-color:yellow;">Well</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">long</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">every</span> <span style="background-color:yellow;">entry</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">both</span> <span style="background-color:yellow;">lists</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">present</span> <span style="background-color:yellow;">exactly</span> <span style="background-color:yellow;">once</span> <span style="background-color:yellow;">each</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">then</span> <span style="background-color:yellow;">we</span> <span style="background-color:yellow;">know</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">once</span> <span style="background-color:yellow;">we</span> <span style="background-color:yellow;">look</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">key</span> <span style="background-color:yellow;">up</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">rank_a</span> <span style="background-color:yellow;">collection</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">we</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">need</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">anymore.</span> <span style="background-color:yellow;">We</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">delete</span> <span style="background-color:yellow;">it.</span> <span style="background-color:yellow;">Also</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">save</span> <span style="background-color:yellow;">space</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">we</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">populate</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">collection</span> <span style="background-color:yellow;">until</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">moment</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">particular</span> <span style="background-color:yellow;">key</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">needed</span> . </p>
<pre><code>class LookupOnce:
    def __init__(self, seq):
        self.cache = {}
        self.seq = iter(seq)
    def get(self, key):
        if key in self.cache:
            value = self.cache[key]
            del self.cache[key]
            return value
        for v,k in self.seq:
            if k == key:
                return v
            self.cache[k] = v
        raise KeyError


def delta(a, b):
    rank_a = LookupOnce(enumerate(a))
    rank_b = enumerate(b)
    result = {}
    for i, k in rank_b:
        result[k] = i - rank_a.get(k)
    return result
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">2</span> </b><br /><p><span style="background-color:yellow;">you</span> <span style="background-color:yellow;">could</span> <span style="background-color:yellow;">also</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">same</span> <span style="background-color:yellow;">algorithm</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">i</span> <span style="background-color:yellow;">wrote</span> <span style="background-color:yellow;">above</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">just</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">single</span> <span style="background-color:yellow;">hashmap</span> . </p>
<pre><code>def findDelta1(today,yesterday):
 results = {}
 ypos = 0
 for i,title in enumerate(today):
      if title in results:
           results[title] = results[title] - i
      else:
           for ypos in xrange(ypos,len(yesterday)):
                if yesterday[ypos] == title:
                     results[title] = ypos - i
                     ypos = ypos + 1
                     break
                else:
                     results[yesterday[ypos]] = ypos
 return results
</code></pre>
<p><span style="background-color:yellow;">still</span> <span style="background-color:yellow;">O</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">N</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">potentially</span> <span style="background-color:yellow;">faster</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">less</span> <span style="background-color:yellow;">RAM</span> <span style="background-color:yellow;">than</span> <span style="background-color:yellow;">my</span> <span style="background-color:yellow;">version</span> <span style="background-color:yellow;">above</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">3</span> </b><br /><pre><code>>>> def transform(albums):
...     return dict((album, i) for i, album in enumerate(albums))
... 
>>> def show_diffs(album1, album2):
...     album_dict1, album_dict2  = transform(album1), transform(album2)
...     for k, v in sorted(album_dict1.iteritems()):
...         print k, album_dict2[k] - v
... 
>>> albums_today = ['album1', 'album2', 'album3']
>>> albums_yesterday = ['album2', 'album1', 'album3']
>>> show_diffs(albums_today, albums_yesterday)
album1 1
album2 -1
album3 0
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">4</span> </b><br /><p><span style="background-color:yellow;">well</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">depending</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">what</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">sizes</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">lists</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">there</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">number</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">different</span> <span style="background-color:yellow;">approaches.</span> <span style="background-color:yellow;">without</span> <span style="background-color:yellow;">knowing</span> <span style="background-color:yellow;">how</span> <span style="background-color:yellow;">big</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">datasets</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">i</span> <span style="background-color:yellow;">'d</span> <span style="background-color:yellow;">suggest</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">simplest</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">perhaps</span> <span style="background-color:yellow;">unnecessarily</span> <span style="background-color:yellow;">optimized</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">method</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">something</span> <span style="background-color:yellow;">like</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>albums_yesterday_lookup = new HashMap();
differences = new HashMap();
foreach(albums_yesterday as position => album_title)
    albums_yesterday_lookup.put(album_title,position);

foreach(albums_today as position => album_title)
    differences.put(album_title, albums_yesterday_lookup.get(album_title) - position);
</code></pre>
<p><span style="background-color:yellow;">which</span> <span style="background-color:yellow;">runs</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">O</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">N</span> <span style="background-color:yellow;"></span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">5</span> </b><br /><p><span style="background-color:yellow;">New</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">Improved</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">O</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">n</span> <span style="background-color:yellow;">2</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">But</span> <span style="background-color:yellow;">still</span> <span style="background-color:yellow;">slower</span> <span style="background-color:yellow;">than</span> <span style="background-color:yellow;">two</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">other</span> <span style="background-color:yellow;">answers</span> . </p>
<p><span style="background-color:yellow;">The</span> <span style="background-color:yellow;">only</span> <span style="background-color:yellow;">advantage</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">solution</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">memory</span> <span style="background-color:yellow;">savings.</span> <span style="background-color:yellow;">It</span> <span style="background-color:yellow;">avoids</span> <span style="background-color:yellow;">building</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">big</span> <span style="background-color:yellow;">dict</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">instead</span> <span style="background-color:yellow;">stores</span> <span style="background-color:yellow;">only</span> <span style="background-color:yellow;">what</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">necessary</span> <span style="background-color:yellow;">at</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">time.</span> <span style="background-color:yellow;">TokenMacGuy</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">second</span> <span style="background-color:yellow;">solution</span> <span style="background-color:yellow;">does</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">well</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">slightly</span> <span style="background-color:yellow;">faster</span> . </p>
<pre><code>def get_deltas_aas(today, yesterday):
    deltas = {}
    for (new_rank, new_album), (old_rank, old_album) in \
            itertools.izip(enumerate(today), enumerate(yesterday)):
        if old_album in deltas:
            #Believe it or not, this is faster than deltas.pop(old_album) + old_rank
            yield (old_album, deltas[old_album] + old_rank)
            del deltas[old_album]    
        else:
            deltas[old_album] = old_rank

        if new_album in deltas:
            yield (new_album, deltas[new_album] - new_rank)
            del deltas[new_album]
        else:
            deltas[new_album] = -new_rank
</code></pre>
<p><span style="background-color:yellow;">Here</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">some</span> <span style="background-color:yellow;">timing</span> <span style="background-color:yellow;">results</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">most</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">answers</span> <span style="background-color:yellow;">here</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">all</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">ones</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">unless</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">missed</span> <span style="background-color:yellow;">something</span> <span style="background-color:yellow;"></span> . <span style="background-color:yellow;">dict</span> <span style="background-color:yellow;">ordering</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">effect.</span> <span style="background-color:yellow;">If</span> <span style="background-color:yellow;">anybody</span> <span style="background-color:yellow;">wants</span> <span style="background-color:yellow;">me</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">change</span> <span style="background-color:yellow;">their</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">any</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">just</span> <span style="background-color:yellow;">ping</span> <span style="background-color:yellow;">me</span> . </p>
<pre><code>get_deltas_token1: 1.08131885529 msecs
get_deltas_gnibbler: 1.06443881989 msecs
get_deltas_tyler: 1.61993408203 msecs
get_deltas_token2: 1.52525019646 msecs
get_deltas_hughdbrown: 3.27240777016 msecs
get_deltas_aas: 1.39379096031 msecs
</code></pre>
<p><span style="background-color:yellow;">The</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">used</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">timing</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">here</span> . <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'m</span> <span style="background-color:yellow;">pleased</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">timing</span> <span style="background-color:yellow;">framework</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">tossed</span> <span style="background-color:yellow;">together</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">top</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">timeit.</span> <span style="background-color:yellow;">Should</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">useful</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">future</span> <span style="background-color:yellow;">after</span> <span style="background-color:yellow;">refactoring</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">running</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">tests</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">6</span> </b><br /><pre><code>D = dict((title, rank) for rank, title in enumerate(albums_yesterday))
for rank, title in enumerate(albums_today):
    D[title] = D[title] - rank
</code></pre>
<br />