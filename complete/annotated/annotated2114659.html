<h3><span style="background-color:yellow;">Question</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">ID-2114659</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </h3><h2><span style="background-color:yellow;">How</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">serialize</span> <span style="background-color:yellow;">db.Model</span> <span style="background-color:yellow;">objects</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">json</span> ? </h2><p><span style="background-color:yellow;">When</span> <span style="background-color:yellow;">using</span> </p>
<pre><code>from django.utils import simplejson
</code></pre>
<p><span style="background-color:yellow;">on</span> <span style="background-color:yellow;">objects</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">types</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">derive</span> <span style="background-color:yellow;">from</span> <span style="background-color:yellow;">db.Model</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">throws</span> <span style="background-color:yellow;">exceptions.</span> <span style="background-color:yellow;">How</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">circumvent</span> <span style="background-color:yellow;">this</span> ? </p>
<br /><h3><span style="background-color:yellow;">Answers</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">Total-6</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </h3><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">0</span> </b><br /><p><span style="background-color:yellow;">Ok</span> <span style="background-color:yellow;">-</span> <span style="background-color:yellow;">my</span> <span style="background-color:yellow;">python</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">great</span> <span style="background-color:yellow;">so</span> <span style="background-color:yellow;">any</span> <span style="background-color:yellow;">help</span> <span style="background-color:yellow;">would</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">appreciated</span> <span style="background-color:yellow;">-</span> <span style="background-color:yellow;">You</span> <span style="background-color:yellow;">dont</span> <span style="background-color:yellow;">need</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">write</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">parser</span> <span style="background-color:yellow;">-</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">solution</span> <span style="background-color:yellow;">:</span> </p>
<p><span style="background-color:yellow;">add</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">utlity</span> <span style="background-color:yellow;">class</span> <span style="background-color:yellow;">http</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">//code.google.com/p/google-app-engine-samples/source/browse/trunk/geochat/json.py</span> ? <span style="background-color:yellow;">r</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">55</span> </p>
<pre><code> import datetime  
 import time 

 from google.appengine.api import users 
 from google.appengine.ext import db 

#this is a mod on the orinal file for some reason it includes its own simplejson files i have ref django!
 from django.utils import simplejson  

 class GqlEncoder(simplejson.JSONEncoder): 

   """Extends JSONEncoder to add support for GQL results and properties. 

   Adds support to simplejson JSONEncoders for GQL results and properties by 
   overriding JSONEncoder's default method. 
   """ 

   # TODO Improve coverage for all of App Engine's Property types. 

   def default(self, obj): 

     """Tests the input object, obj, to encode as JSON.""" 

     if hasattr(obj, '__json__'): 
       return getattr(obj, '__json__')() 

     if isinstance(obj, db.GqlQuery): 
       return list(obj) 

     elif isinstance(obj, db.Model): 
       properties = obj.properties().items() 
       output = {} 
       for field, value in properties: 
         output[field] = getattr(obj, field) 
       return output 

     elif isinstance(obj, datetime.datetime): 
       output = {} 
       fields = ['day', 'hour', 'microsecond', 'minute', 'month', 'second', 
           'year'] 
       methods = ['ctime', 'isocalendar', 'isoformat', 'isoweekday', 
           'timetuple'] 
       for field in fields: 
         output[field] = getattr(obj, field) 
       for method in methods: 
         output[method] = getattr(obj, method)() 
       output['epoch'] = time.mktime(obj.timetuple()) 
       return output 

     elif isinstance(obj, time.struct_time): 
       return list(obj) 

     elif isinstance(obj, users.User): 
       output = {} 
       methods = ['nickname', 'email', 'auth_domain'] 
       for method in methods: 
         output[method] = getattr(obj, method)() 
       return output 

     return simplejson.JSONEncoder.default(self, obj) 


 def encode(input): 
   """Encode an input GQL object as JSON 

     Args: 
       input: A GQL object or DB property. 

     Returns: 
       A JSON string based on the input object.  

     Raises: 
       TypeError: Typically occurs when an input object contains an unsupported 
         type. 
     """ 
   return GqlEncoder().encode(input)   
</code></pre>
<p><span style="background-color:yellow;">save</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">json.py</span> </p>
<p><span style="background-color:yellow;">TO</span> <span style="background-color:yellow;">USE</span> </p>
<pre><code>import cgi
import os
import json 

from google.appengine.ext.webapp import template
from google.appengine.api import users
from google.appengine.ext import webapp
from google.appengine.ext.webapp.util import run_wsgi_app
from google.appengine.ext import db


class Greeting(db.Model):
    author = db.UserProperty()
    content = db.StringProperty(multiline=True)
    date = db.DateTimeProperty(auto_now_add=True)

class MainPage(webapp.RequestHandler):
    def get(self):
        greetings_query = Greeting.all().order('-date')
        greetings = greetings_query.fetch(5)

        if users.get_current_user():
            url = users.create_logout_url(self.request.uri)
            url_linktext = 'Logout'
        else:
            url = users.create_login_url(self.request.uri)
            url_linktext = 'Login'

        template_values = {
            'greetings': greetings,
            'url': url,
            'url_linktext': url_linktext,
            }

        path = os.path.join(os.path.dirname(__file__), 'index.html')
        self.response.out.write(template.render(path, template_values))


class Guestbook(webapp.RequestHandler):
    def post(self):
        greeting = Greeting()

        if users.get_current_user():
            greeting.author = users.get_current_user()

        greeting.content = self.request.get('content')
        greeting.put()
        self.redirect('/')



#here i return my json feed - simple implementaion for example
class FeedHandler(webapp.RequestHandler):

  def get(self):
    """Retrieve a feed"""
    user = None

    greetings_query = Greeting.all().order('-date')
    rs= greetings_query.fetch(5)
#this is the part that calls the encoder - dosnt cause an exception
    data = json.encode(rs)



#roll out to browser -might need to check my headers etc
    self.response.headers['Content-Type'] = 'application/json; charset=utf-8'  
    self.response.out.write(data)




application = webapp.WSGIApplication(
                                       [
                                       ('/', MainPage),
                                       ('/sign',Guestbook),
                                       ('/feed',FeedHandler),
                                       ], debug=True
                                    )

def main():
    run_wsgi_app(application)

if __name__ == "__main__":
    main()
</code></pre>
<p><span style="background-color:yellow;">This</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">browser</span> <span style="background-color:yellow;">response</span> <span style="background-color:yellow;">:</span> </p>
<blockquote><span style="background-color:yellow;">[</span> <span style="background-color:yellow;">{</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">content</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">date</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">{</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">ctime</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">Sat</span> <span style="background-color:yellow;">Jan</span> <span style="background-color:yellow;">23</span> <span style="background-color:yellow;">02</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">40</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">2010</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">hour</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">2</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">isoweekday</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">6</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">month</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">second</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">microsecond</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">434000</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">isocalendar</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">2010</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">3</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">6</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">timetuple</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">2010</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">23</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">2</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">40</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">5</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">23</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">-1</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">year</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">2010</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">epoch</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">1264214422.0</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">isoformat</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">2010-01-23T02</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">40</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">22.434000</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">day</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">23</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">minute</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">40</span> <span style="background-color:yellow;">}</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">author</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">{</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">nickname</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">test</span> <span style="background-color:yellow;">@</span> <span style="background-color:yellow;">example.com</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">email</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">test</span> <span style="background-color:yellow;">@</span> <span style="background-color:yellow;">example.com</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">auth_domain</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">gmail.com</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">}</span> <span style="background-color:yellow;">}</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">{</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">content</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">date</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">{</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">ctime</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">Sat</span> <span style="background-color:yellow;">Jan</span> <span style="background-color:yellow;">23</span> <span style="background-color:yellow;">01</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">12</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">43</span> <span style="background-color:yellow;">2010</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">hour</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">isoweekday</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">6</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">month</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">second</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">43</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">microsecond</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">972000</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">isocalendar</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">2010</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">3</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">6</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">timetuple</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">2010</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">23</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">12</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">43</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">5</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">23</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">-1</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">year</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">2010</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">epoch</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">1264209163.0</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">isoformat</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">2010-01-23T01</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">12</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">43.972000</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">day</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">23</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">minute</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">12</span> <span style="background-color:yellow;">}</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">author</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">{</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">nickname</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">test</span> <span style="background-color:yellow;">@</span> <span style="background-color:yellow;">example.com</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">email</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">test</span> <span style="background-color:yellow;">@</span> <span style="background-color:yellow;">example.com</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">auth_domain</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">gmail.com</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">}</span> <span style="background-color:yellow;">}</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">{</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">content</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">test</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">date</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">{</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">ctime</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">Fri</span> <span style="background-color:yellow;">Jan</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">32</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">13</span> <span style="background-color:yellow;">2010</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">hour</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">isoweekday</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">5</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">month</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">second</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">13</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">microsecond</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">659000</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">isocalendar</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">2010</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">3</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">5</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">timetuple</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">2010</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">32</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">13</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">4</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">-1</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">year</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">2010</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">epoch</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">1264199533.0</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">isoformat</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">2010-01-22T22</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">32</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">13.659000</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">day</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">minute</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">32</span> <span style="background-color:yellow;">}</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">author</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">{</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">nickname</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">test</span> <span style="background-color:yellow;">@</span> <span style="background-color:yellow;">example.com</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">email</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">test</span> <span style="background-color:yellow;">@</span> <span style="background-color:yellow;">example.com</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">auth_domain</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">gmail.com</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">}</span> <span style="background-color:yellow;">}</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">{</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">content</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">date</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">{</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">ctime</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">Fri</span> <span style="background-color:yellow;">Jan</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">29</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">49</span> <span style="background-color:yellow;">2010</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">hour</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">isoweekday</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">5</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">month</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">second</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">49</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">microsecond</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">358000</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">isocalendar</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">2010</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">3</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">5</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">timetuple</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">2010</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">29</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">49</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">4</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">-1</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">year</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">2010</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">epoch</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">1264199389.0</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">isoformat</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">2010-01-22T22</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">29</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">49.358000</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">day</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">minute</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">29</span> <span style="background-color:yellow;">}</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">author</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">{</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">nickname</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">test</span> <span style="background-color:yellow;">@</span> <span style="background-color:yellow;">example.com</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">email</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">test</span> <span style="background-color:yellow;">@</span> <span style="background-color:yellow;">example.com</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">auth_domain</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">gmail.com</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">}</span> <span style="background-color:yellow;">}</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">{</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">content</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">ah</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">works</span> <span style="background-color:yellow;">!</span> <span style="background-color:yellow;">\</span> <span style="background-color:yellow;">r</span> <span style="background-color:yellow;">\</span> <span style="background-color:yellow;">n</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">date</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">{</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">ctime</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">Fri</span> <span style="background-color:yellow;">Jan</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">29</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">2010</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">hour</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">isoweekday</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">5</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">month</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">second</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">microsecond</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">995000</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">isocalendar</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">2010</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">3</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">5</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">timetuple</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">2010</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">29</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">4</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">-1</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">year</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">2010</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">epoch</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">1264199362.0</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">isoformat</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">2010-01-22T22</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">29</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">22.995000</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">day</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">22</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">minute</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">29</span> <span style="background-color:yellow;">}</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">author</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">{</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">nickname</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">test</span> <span style="background-color:yellow;">@</span> <span style="background-color:yellow;">example.com</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">email</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">test</span> <span style="background-color:yellow;">@</span> <span style="background-color:yellow;">example.com</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">auth_domain</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">gmail.com</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">}</span> <span style="background-color:yellow;">}</span> <span style="background-color:yellow;">]</span> </blockquote>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">1</span> </b><br /><p><span style="background-color:yellow;">The</span> <span style="background-color:yellow;">example</span> <span style="background-color:yellow;">provided</span> <span style="background-color:yellow;">by</span> <span style="background-color:yellow;">Jader</span> <span style="background-color:yellow;">Dias</span> <span style="background-color:yellow;">works</span> <span style="background-color:yellow;">fine</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">my</span> <span style="background-color:yellow;">concern</span> <span style="background-color:yellow;">after</span> <span style="background-color:yellow;">some</span> <span style="background-color:yellow;">twaeking.</span> <span style="background-color:yellow;">Remove</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">encode</span> <span style="background-color:yellow;">method</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">contains</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">circular</span> <span style="background-color:yellow;">reference.</span> <span style="background-color:yellow;">The</span> <span style="background-color:yellow;">adjusted</span> <span style="background-color:yellow;">class</span> <span style="background-color:yellow;">should</span> <span style="background-color:yellow;">look</span> <span style="background-color:yellow;">like</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>import datetime  
import time 

from google.appengine.api import users 
from google.appengine.ext import db 
from django.utils import simplejson  


class GqlEncoder(simplejson.JSONEncoder): 

    """Extends JSONEncoder to add support for GQL results and properties. 

    Adds support to simplejson JSONEncoders for GQL results and properties by 
    overriding JSONEncoder's default method. 
    """ 

    # TODO Improve coverage for all of App Engine's Property types. 

    def default(self, obj): 

        """Tests the input object, obj, to encode as JSON.""" 

        if hasattr(obj, '__json__'): 
            return getattr(obj, '__json__')() 

        if isinstance(obj, db.GqlQuery): 
            return list(obj) 

        elif isinstance(obj, db.Model): 
            properties = obj.properties().items() 
            output = {} 
            for field, value in properties: 
                output[field] = getattr(obj, field) 
            return output 

        elif isinstance(obj, datetime.datetime): 
            output = {} 
            fields = ['day', 'hour', 'microsecond', 'minute', 'month', 'second', 'year'] 
            methods = ['ctime', 'isocalendar', 'isoformat', 'isoweekday', 'timetuple'] 
            for field in fields: 
                output[field] = getattr(obj, field) 
            for method in methods: 
                output[method] = getattr(obj, method)() 
            output['epoch'] = time.mktime(obj.timetuple()) 
            return output 

        elif isinstance(obj, time.struct_time): 
            return list(obj) 

        elif isinstance(obj, users.User): 
            output = {} 
            methods = ['nickname', 'email', 'auth_domain'] 
            for method in methods: 
                output[method] = getattr(obj, method)() 
            return output 

        return simplejson.JSONEncoder.default(self, obj) 
</code></pre>
<p><span style="background-color:yellow;">As</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'ve</span> <span style="background-color:yellow;">saved</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">class</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">file</span> <span style="background-color:yellow;">called</span> <span style="background-color:yellow;">utils.py</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">when</span> <span style="background-color:yellow;">appropriate</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">import</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">using</span> </p>
<pre><code>import utils
</code></pre>
<p><span style="background-color:yellow;">Then</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">just</span> <span style="background-color:yellow;">call</span> <span style="background-color:yellow;">utils.GqlEncoder</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">.encode</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">results</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">example</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>query = User.all()
results = query.fetch(10)

self.response.headers['Content-Type'] = "text/plain" # Alt. application/json
self.response.out.write( utils.GqlEncoder().encode(results) )
</code></pre>
<p><span style="background-color:yellow;">The</span> <span style="background-color:yellow;">result</span> <span style="background-color:yellow;">should</span> <span style="background-color:yellow;">look</span> <span style="background-color:yellow;">something</span> <span style="background-color:yellow;">like</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'ve</span> <span style="background-color:yellow;">added</span> <span style="background-color:yellow;">some</span> <span style="background-color:yellow;">line</span> <span style="background-color:yellow;">feeds</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">order</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">make</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">bit</span> <span style="background-color:yellow;">easier</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">read</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </p>
<pre><code>[
{"date": {"ctime": "Tue Feb 23 10:41:21 2010", "hour": 10, "isoweekday": 2, "month": 2, 
        "second": 21, "microsecond": 495535, "isocalendar": [2010, 8, 2], "timetuple": [2010, 2, 23, 10, 41, 21, 1, 54, -1], 
        "year": 2010, "epoch": 1266921681.0, "isoformat": "2010-02-23T10:41:21.495535", "day": 23, "minute": 41}, 
"claimed_id": "https:\/\/www.google.com\/accounts\/o8\/id?id=abcdefghijklmnopqrstuvxyz", 
"display_name": "Alfred E Neumann", 
"email": null, 
"full_name": "Alfred E Neumann"
}, 
{"date": {"ctime": "Tue Feb 23 11:00:54 2010", "hour": 11, "isoweekday": 2, "month": 2, 
        "second": 54, "microsecond": 805261, "isocalendar": [2010, 8, 2], "timetuple": [2010, 2, 23, 11, 0, 54, 1, 54, -1], 
        "year": 2010, "epoch": 1266922854.0, "isoformat": "2010-02-23T11:00:54.805261", "day": 23, "minute": 0}, 
"claimed_id": "http:\/\/openid.domain.net\/john", 
"display_name": "", 
"email": "jp@domain.net", 
"full_name": "John Parnefjord"
}
]
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">2</span> </b><br /><p><span style="background-color:yellow;">json</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">used</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">serialize</span> <span style="background-color:yellow;">anything</span> <span style="background-color:yellow;">more</span> <span style="background-color:yellow;">than</span> <span style="background-color:yellow;">basic</span> <span style="background-color:yellow;">types</span> <span style="background-color:yellow;">such</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">dicts</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">lists</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">ints/longs</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">strings</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">comprehensive</span> <span style="background-color:yellow;"></span> . <span style="background-color:yellow;">For</span> <span style="background-color:yellow;">example</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">even</span> <span style="background-color:yellow;">these</span> <span style="background-color:yellow;">simple</span> <span style="background-color:yellow;">commands</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">work</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>import json
json.dumps(object())
</code></pre>
<p><span style="background-color:yellow;">If</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">want</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">serialize</span> <span style="background-color:yellow;">django</span> <span style="background-color:yellow;">objects</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">should</span> <span style="background-color:yellow;">refer</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">django</span> <span style="background-color:yellow;">documentation</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">serialization</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">will</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">their</span> <span style="background-color:yellow;">own</span> <span style="background-color:yellow;">libraries</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">they</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">support</span> <span style="background-color:yellow;">json</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">3</span> </b><br /><p><span style="background-color:yellow;">Since</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">could</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">find</span> <span style="background-color:yellow;">an</span> <span style="background-color:yellow;">appropriate</span> <span style="background-color:yellow;">solution</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">wrote</span> <span style="background-color:yellow;">my</span> <span style="background-color:yellow;">own</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">exactly</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">JSON</span> <span style="background-color:yellow;">serializer</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">Javascript</span> <span style="background-color:yellow;">serializer</span> </p>
<pre><code>from google.appengine.ext import db
from google.appengine.api.datastore_types import *

def dumpStr(obj):
    return "'" + obj + "'"

def dumps(obj):
    if isinstance(obj, str):
        return dumpStr(obj)
    elif obj == None:
        return None
    elif isinstance(obj, list):
        items = [];
        for item in obj:
            items.append(dumps(item))
        return '[' + ','.join(items) + ']'
    elif isinstance(obj, datetime.datetime):
        return "new Date('%s')" % obj.ctime()
    properties = [];
    for property in dir(obj):
        if property[0] != '_':
            value = obj.__getattribute__(property)
            valueClass = str(value.__class__)
            if not(('function' in valueClass) or ('built' in valueClass) or ('method' in valueClass)):
                value = dumps(value)
                if value != None:
                    properties.append("'" + property + "':" + value)
    if len(properties) == 0:
        return str(obj)
    else:
        return '{' + ','.join(properties) + '}'
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">4</span> </b><br /><p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">got</span> <span style="background-color:yellow;">demented</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">few</span> <span style="background-color:yellow;">days</span> <span style="background-color:yellow;">trying</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">myself</span> <span style="background-color:yellow;">-</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">want</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">jqGrid</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">jQuery</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">seriously</span> <span style="background-color:yellow;">need</span> <span style="background-color:yellow;">some</span> <span style="background-color:yellow;">method</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">returning</span> <span style="background-color:yellow;">GQL</span> <span style="background-color:yellow;">results</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">JSON</span> <span style="background-color:yellow;">without</span> <span style="background-color:yellow;">hand-cranking</span> <span style="background-color:yellow;">them</span> <span style="background-color:yellow;">every</span> <span style="background-color:yellow;">time.</span> <span style="background-color:yellow;">However</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">looks</span> <span style="background-color:yellow;">like</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'m</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">only</span> <span style="background-color:yellow;">one</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">journey</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">App</span> <span style="background-color:yellow;">Engine</span> <span style="background-color:yellow;">blog</span> <span style="background-color:yellow;">gave</span> <span style="background-color:yellow;">me</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">answer</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">need</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">there</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">new</span> <span style="background-color:yellow;">project</span> <span style="background-color:yellow;">called</span> <span style="background-color:yellow;">ProtoRPC</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">takes</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">little</span> <span style="background-color:yellow;">effort</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">learn</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">apply</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">since</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">intended</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">become</span> <span style="background-color:yellow;">part</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">SDK</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">suggest</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">go.</span> <span style="background-color:yellow;">It</span> <span style="background-color:yellow;">does</span> <span style="background-color:yellow;">what</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">want</span> <span style="background-color:yellow;">anyway</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">5</span> </b><br /><p><span style="background-color:yellow;">From</span> <span style="background-color:yellow;">what</span> <span style="background-color:yellow;">i</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">understand</span> <span style="background-color:yellow;">-</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">i</span> <span style="background-color:yellow;">am</span> <span style="background-color:yellow;">new</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">python</span> <span style="background-color:yellow;">-</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">google</span> <span style="background-color:yellow;">app</span> <span style="background-color:yellow;">engine</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">work</span> <span style="background-color:yellow;">around</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">serialize</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">model</span> <span style="background-color:yellow;">object</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">dictioanry</span> <span style="background-color:yellow;">python</span> <span style="background-color:yellow;">object</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">then</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">simple</span> <span style="background-color:yellow;">json</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">dump</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">json</span> <span style="background-color:yellow;">string</span> <span style="background-color:yellow;">-</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">makes</span> <span style="background-color:yellow;">no</span> <span style="background-color:yellow;">sense</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">me</span> <span style="background-color:yellow;">-</span> <span style="background-color:yellow;">maybe</span> <span style="background-color:yellow;">someone</span> <span style="background-color:yellow;">has</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">know</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">serialise</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">ditionary</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">pickel</span> ? <span style="background-color:yellow;"></span> <span style="background-color:yellow;">Any</span> <span style="background-color:yellow;">help</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">would</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">HELP</span> <span style="background-color:yellow;">!</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">impressed</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">google</span> <span style="background-color:yellow;">app</span> <span style="background-color:yellow;">engine</span> <span style="background-color:yellow;">has</span> <span style="background-color:yellow;">no</span> <span style="background-color:yellow;">inbuilt</span> <span style="background-color:yellow;">solution</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">this</span> . </p>
<br />