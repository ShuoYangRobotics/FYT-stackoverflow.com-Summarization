<h3><span style="background-color:yellow;">Question</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">ID-38987</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </h3><h2><span style="background-color:yellow;">How</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">merge</span> <span style="background-color:yellow;">two</span> <span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">dictionaries</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">single</span> <span style="background-color:yellow;">expression</span> ? </h2><p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">two</span> <span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">dictionaries</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">want</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">write</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">single</span> <span style="background-color:yellow;">expression</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">returns</span> <span style="background-color:yellow;">these</span> <span style="background-color:yellow;">two</span> <span style="background-color:yellow;">dictionaries</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">merged.</span> <span style="background-color:yellow;">The</span> <span style="background-color:yellow;">update</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">method</span> <span style="background-color:yellow;">would</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">what</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">need</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">returned</span> <span style="background-color:yellow;">its</span> <span style="background-color:yellow;">result</span> <span style="background-color:yellow;">instead</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">modifying</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">dict</span> <span style="background-color:yellow;">in-place</span> . </p>
<pre><code>>>> x = {'a':1, 'b': 2}
>>> y = {'b':10, 'c': 11}
>>> z = x.update(y)
>>> print z
None
>>> x
{'a': 1, 'b': 10, 'c': 11}
</code></pre>
<p><span style="background-color:yellow;">So</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">want</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">final</span> <span style="background-color:yellow;">merged</span> <span style="background-color:yellow;">dict</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">z</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">x.</span> <span style="background-color:yellow;">How</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">this</span> ? </p>
<br /><h3><span style="background-color:yellow;">Answers</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">Total-11</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </h3><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">0</span> </b><br /><p><span style="background-color:yellow;">In</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">case</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">what</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>z = dict(x.items() + y.items())
</code></pre>
<p><span style="background-color:yellow;">This</span> <span style="background-color:yellow;">will</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">want</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">put</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">final</span> <span style="background-color:yellow;">dict</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">z</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">make</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">value</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">b</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">properly</span> <span style="background-color:yellow;">overridden</span> <span style="background-color:yellow;">by</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">second</span> <span style="background-color:yellow;">dict</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">value</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>>>> x = {'a':1, 'b': 2}
>>> y = {'b':10, 'c': 11}
>>> z = dict(x.items() + y.items())
>>> z
{'a': 1, 'c': 11, 'b': 10}
</code></pre>
<p><span style="background-color:yellow;">If</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">3</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">only</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">little</span> <span style="background-color:yellow;">more</span> <span style="background-color:yellow;">complicated.</span> <span style="background-color:yellow;">To</span> <span style="background-color:yellow;">create</span> <span style="background-color:yellow;">z</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>>>> z = dict(list(x.items()) + list(y.items()))
>>> z
{'a': 1, 'c': 11, 'b': 10}
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">1</span> </b><br /><p><span style="background-color:yellow;">Another</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">more</span> <span style="background-color:yellow;">concise</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">option</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>z = dict(x, **y)
</code></pre>
<p><span style="background-color:yellow;">Note</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">has</span> <span style="background-color:yellow;">become</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">popular</span> <span style="background-color:yellow;">answer</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">important</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">point</span> <span style="background-color:yellow;">out</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">y</span> <span style="background-color:yellow;">has</span> <span style="background-color:yellow;">any</span> <span style="background-color:yellow;">non-string</span> <span style="background-color:yellow;">keys</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">fact</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">works</span> <span style="background-color:yellow;">at</span> <span style="background-color:yellow;">all</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">an</span> <span style="background-color:yellow;">abuse</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">CPython</span> <span style="background-color:yellow;">implementation</span> <span style="background-color:yellow;">detail</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">does</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">work</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">CPython</span> <span style="background-color:yellow;">3.2</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">PyPy</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">IronPython</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">Jython.</span> <span style="background-color:yellow;">Also</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">Guido</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">fan</span> . <span style="background-color:yellow;">So</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">ca</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">recommend</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">technique</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">forward-compatible</span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">cross-implementation</span> <span style="background-color:yellow;">portable</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">really</span> <span style="background-color:yellow;">means</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">should</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">avoided</span> <span style="background-color:yellow;">entirely</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">2</span> </b><br /><p><span style="background-color:yellow;">This</span> <span style="background-color:yellow;">probably</span> <span style="background-color:yellow;">wo</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">popular</span> <span style="background-color:yellow;">answer</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">almost</span> <span style="background-color:yellow;">certainly</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">want</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">this.</span> <span style="background-color:yellow;">If</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">want</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">copy</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">merge</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">then</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">copy</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">deepcopy</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">depending</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">what</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">want</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">then</span> <span style="background-color:yellow;">update.</span> <span style="background-color:yellow;">The</span> <span style="background-color:yellow;">two</span> <span style="background-color:yellow;">lines</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">much</span> <span style="background-color:yellow;">more</span> <span style="background-color:yellow;">readable</span> <span style="background-color:yellow;">-</span> <span style="background-color:yellow;">more</span> <span style="background-color:yellow;">Pythonic</span> <span style="background-color:yellow;">-</span> <span style="background-color:yellow;">than</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">single</span> <span style="background-color:yellow;">line</span> <span style="background-color:yellow;">creation</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">.items</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">+</span> <span style="background-color:yellow;">.items</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> . <span style="background-color:yellow;">Explicit</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">better</span> <span style="background-color:yellow;">than</span> <span style="background-color:yellow;">implicit</span> . </p>
<p><span style="background-color:yellow;">In</span> <span style="background-color:yellow;">addition</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">when</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">.items</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">pre</span> <span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">3.0</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">'re</span> <span style="background-color:yellow;">creating</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">new</span> <span style="background-color:yellow;">list</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">contains</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">items</span> <span style="background-color:yellow;">from</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">dict.</span> <span style="background-color:yellow;">If</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">dictionaries</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">large</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">then</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">quite</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">lot</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">overhead</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">two</span> <span style="background-color:yellow;">large</span> <span style="background-color:yellow;">lists</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">will</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">thrown</span> <span style="background-color:yellow;">away</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">soon</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">merged</span> <span style="background-color:yellow;">dict</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">created</span> <span style="background-color:yellow;"></span> . <span style="background-color:yellow;">update</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">work</span> <span style="background-color:yellow;">more</span> <span style="background-color:yellow;">efficiently</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">because</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">run</span> <span style="background-color:yellow;">through</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">second</span> <span style="background-color:yellow;">dict</span> <span style="background-color:yellow;">item-by-item</span> . </p>
<p><span style="background-color:yellow;">In</span> <span style="background-color:yellow;">terms</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">time</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>>>> timeit.Timer("dict(x, **y)", "x = dict(zip(range(1000), range(1000)))\ny=dict(zip(range(1000,2000), range(1000,2000)))").timeit(100000)
15.52571702003479
>>> timeit.Timer("temp = x.copy()\ntemp.update(y)", "x = dict(zip(range(1000), range(1000)))\ny=dict(zip(range(1000,2000), range(1000,2000)))").timeit(100000)
15.694622993469238
>>> timeit.Timer("dict(x.items() + y.items())", "x = dict(zip(range(1000), range(1000)))\ny=dict(zip(range(1000,2000), range(1000,2000)))").timeit(100000)
41.484580039978027
</code></pre>
<p><span style="background-color:yellow;">IMO</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">tiny</span> <span style="background-color:yellow;">slowdown</span> <span style="background-color:yellow;">between</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">first</span> <span style="background-color:yellow;">two</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">worth</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">readability.</span> <span style="background-color:yellow;">In</span> <span style="background-color:yellow;">addition</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">keyword</span> <span style="background-color:yellow;">arguments</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">dictionary</span> <span style="background-color:yellow;">creation</span> <span style="background-color:yellow;">was</span> <span style="background-color:yellow;">only</span> <span style="background-color:yellow;">added</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">2.3</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">whereas</span> <span style="background-color:yellow;">copy</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">update</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">will</span> <span style="background-color:yellow;">work</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">older</span> <span style="background-color:yellow;">versions</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">3</span> </b><br /><p><span style="background-color:yellow;">Carl</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">follow-up</span> <span style="background-color:yellow;">answer</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">asked</span> <span style="background-color:yellow;">about</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">relative</span> <span style="background-color:yellow;">performance</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">these</span> <span style="background-color:yellow;">two</span> <span style="background-color:yellow;">alternatives</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>z1 = dict(x.items() + y.items())
z2 = dict(x, **y)
</code></pre>
<p><span style="background-color:yellow;">On</span> <span style="background-color:yellow;">my</span> <span style="background-color:yellow;">machine</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">at</span> <span style="background-color:yellow;">least</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">fairly</span> <span style="background-color:yellow;">ordinary</span> <span style="background-color:yellow;">x86_64</span> <span style="background-color:yellow;">running</span> <span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">2.5.2</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">alternative</span> <span style="background-color:yellow;">z2</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">only</span> <span style="background-color:yellow;">shorter</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">simpler</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">also</span> <span style="background-color:yellow;">significantly</span> <span style="background-color:yellow;">faster.</span> <span style="background-color:yellow;">You</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">verify</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">yourself</span> <span style="background-color:yellow;">using</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">timeit</span> <span style="background-color:yellow;">module</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">comes</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">Python</span> . </p>
<p><span style="background-color:yellow;">Example</span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">identical</span> <span style="background-color:yellow;">dictionaries</span> <span style="background-color:yellow;">mapping</span> <span style="background-color:yellow;">20</span> <span style="background-color:yellow;">consecutive</span> <span style="background-color:yellow;">integers</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">themselves</span> </p>
<pre><code>% python -m timeit -s 'x=y=dict((i,i) for i in range(20))' 'z1=dict(x.items() + y.items())'
100000 loops, best of 3: 5.67 usec per loop
% python -m timeit -s 'x=y=dict((i,i) for i in range(20))' 'z2=dict(x, **y)' 
100000 loops, best of 3: 1.53 usec per loop
</code></pre>
<p><span style="background-color:yellow;">z2</span> <span style="background-color:yellow;">wins</span> <span style="background-color:yellow;">by</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">factor</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">3.5</span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">so.</span> <span style="background-color:yellow;">Different</span> <span style="background-color:yellow;">dictionaries</span> <span style="background-color:yellow;">seem</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">yield</span> <span style="background-color:yellow;">quite</span> <span style="background-color:yellow;">different</span> <span style="background-color:yellow;">results</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">z2</span> <span style="background-color:yellow;">always</span> <span style="background-color:yellow;">seems</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">come</span> <span style="background-color:yellow;">out</span> <span style="background-color:yellow;">ahead.</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">If</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">get</span> <span style="background-color:yellow;">inconsistent</span> <span style="background-color:yellow;">results</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">same</span> <span style="background-color:yellow;">test</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">try</span> <span style="background-color:yellow;">passing</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">-r</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">number</span> <span style="background-color:yellow;">larger</span> <span style="background-color:yellow;">than</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">default</span> <span style="background-color:yellow;">3.</span> <span style="background-color:yellow;"></span> </p>
<p><span style="background-color:yellow;">Example</span> <span style="background-color:yellow;">2</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">non-overlapping</span> <span style="background-color:yellow;">dictionaries</span> <span style="background-color:yellow;">mapping</span> <span style="background-color:yellow;">252</span> <span style="background-color:yellow;">short</span> <span style="background-color:yellow;">strings</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">integers</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">vice</span> <span style="background-color:yellow;">versa</span> </p>
<pre><code>% python -m timeit -s 'from htmlentitydefs import codepoint2name as x, name2codepoint as y' 'z1=dict(x.items() + y.items())'
1000 loops, best of 3: 260 usec per loop
% python -m timeit -s 'from htmlentitydefs import codepoint2name as x, name2codepoint as y' 'z2=dict(x, **y)'               
10000 loops, best of 3: 26.9 usec per loop
</code></pre>
<p><span style="background-color:yellow;">z2</span> <span style="background-color:yellow;">wins</span> <span style="background-color:yellow;">by</span> <span style="background-color:yellow;">about</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">factor</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">10.</span> <span style="background-color:yellow;">That</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">pretty</span> <span style="background-color:yellow;">big</span> <span style="background-color:yellow;">win</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">my</span> <span style="background-color:yellow;">book</span> <span style="background-color:yellow;">!</span> </p>
<p><span style="background-color:yellow;">After</span> <span style="background-color:yellow;">comparing</span> <span style="background-color:yellow;">those</span> <span style="background-color:yellow;">two</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">wondered</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">z1</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">poor</span> <span style="background-color:yellow;">performance</span> <span style="background-color:yellow;">could</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">attributed</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">overhead</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">constructing</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">two</span> <span style="background-color:yellow;">item</span> <span style="background-color:yellow;">lists</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">turn</span> <span style="background-color:yellow;">led</span> <span style="background-color:yellow;">me</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">wonder</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">variation</span> <span style="background-color:yellow;">might</span> <span style="background-color:yellow;">work</span> <span style="background-color:yellow;">better</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>from itertools import chain
z3 = dict(chain(x.iteritems(), y.iteritems()))
</code></pre>
<p><span style="background-color:yellow;">A</span> <span style="background-color:yellow;">few</span> <span style="background-color:yellow;">quick</span> <span style="background-color:yellow;">tests</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">e.g</span> . </p>
<pre><code>% python -m timeit -s 'from itertools import chain; from htmlentitydefs import codepoint2name as x, name2codepoint as y' 'z3=dict(chain(x.iteritems(), y.iteritems()))'
10000 loops, best of 3: 66 usec per loop
</code></pre>
<p><span style="background-color:yellow;">lead</span> <span style="background-color:yellow;">me</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">conclude</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">z3</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">somewhat</span> <span style="background-color:yellow;">faster</span> <span style="background-color:yellow;">than</span> <span style="background-color:yellow;">z1</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">nearly</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">fast</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">z2</span> . <span style="background-color:yellow;">Definitely</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">worth</span> <span style="background-color:yellow;">all</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">extra</span> <span style="background-color:yellow;">typing</span> . </p>
<p><span style="background-color:yellow;">This</span> <span style="background-color:yellow;">discussion</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">still</span> <span style="background-color:yellow;">missing</span> <span style="background-color:yellow;">something</span> <span style="background-color:yellow;">important</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">performance</span> <span style="background-color:yellow;">comparison</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">these</span> <span style="background-color:yellow;">alternatives</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">obvious</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">merging</span> <span style="background-color:yellow;">two</span> <span style="background-color:yellow;">lists</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">using</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">update</span> <span style="background-color:yellow;">method.</span> <span style="background-color:yellow;">To</span> <span style="background-color:yellow;">try</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">keep</span> <span style="background-color:yellow;">things</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">an</span> <span style="background-color:yellow;">equal</span> <span style="background-color:yellow;">footing</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">expressions</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">none</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">modify</span> <span style="background-color:yellow;">x</span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">y</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'m</span> <span style="background-color:yellow;">going</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">make</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">copy</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">x</span> <span style="background-color:yellow;">instead</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">modifying</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">in-place</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">follows</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>z0 = dict(x)
z0.update(y)
</code></pre>
<p><span style="background-color:yellow;">A</span> <span style="background-color:yellow;">typical</span> <span style="background-color:yellow;">result</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>% python -m timeit -s 'from htmlentitydefs import codepoint2name as x, name2codepoint as y' 'z0=dict(x); z0.update(y)'
10000 loops, best of 3: 26.9 usec per loop
</code></pre>
<p><span style="background-color:yellow;">In</span> <span style="background-color:yellow;">other</span> <span style="background-color:yellow;">words</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">z0</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">z2</span> <span style="background-color:yellow;">seem</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">essentially</span> <span style="background-color:yellow;">identical</span> <span style="background-color:yellow;">performance.</span> <span style="background-color:yellow;">Do</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">think</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">might</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">coincidence</span> ? <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">n't...</span> . </p>
<p><span style="background-color:yellow;">In</span> <span style="background-color:yellow;">fact</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'d</span> <span style="background-color:yellow;">go</span> <span style="background-color:yellow;">so</span> <span style="background-color:yellow;">far</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">claim</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">impossible</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">pure</span> <span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">any</span> <span style="background-color:yellow;">better</span> <span style="background-color:yellow;">than</span> <span style="background-color:yellow;">this.</span> <span style="background-color:yellow;">And</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">significantly</span> <span style="background-color:yellow;">better</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">C</span> <span style="background-color:yellow;">extension</span> <span style="background-color:yellow;">module</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">imagine</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">folks</span> <span style="background-color:yellow;">might</span> <span style="background-color:yellow;">well</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">interested</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">incorporating</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">variation</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">approach</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">into</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">core.</span> <span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">uses</span> <span style="background-color:yellow;">dict</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">lots</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">places</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">optimizing</span> <span style="background-color:yellow;">its</span> <span style="background-color:yellow;">operations</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">big</span> <span style="background-color:yellow;">deal</span> . </p>
<p><span style="background-color:yellow;">[</span> <span style="background-color:yellow;">UPDATE</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">You</span> <span style="background-color:yellow;">could</span> <span style="background-color:yellow;">also</span> <span style="background-color:yellow;">write</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">as</span> </p>
<pre><code>z0 = x.copy()
z0.update(y)
</code></pre>
<p><span style="background-color:yellow;">as</span> <span style="background-color:yellow;">Tony</span> <span style="background-color:yellow;">does</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">surprisingly</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">difference</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">notation</span> <span style="background-color:yellow;">turns</span> <span style="background-color:yellow;">out</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">any</span> <span style="background-color:yellow;">measurable</span> <span style="background-color:yellow;">effect</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">performance.</span> <span style="background-color:yellow;">Use</span> <span style="background-color:yellow;">whichever</span> <span style="background-color:yellow;">looks</span> <span style="background-color:yellow;">right</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">you.</span> <span style="background-color:yellow;">Of</span> <span style="background-color:yellow;">course</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">he</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">absolutely</span> <span style="background-color:yellow;">correct</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">point</span> <span style="background-color:yellow;">out</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">two-statement</span> <span style="background-color:yellow;">version</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">much</span> <span style="background-color:yellow;">easier</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">understand.</span> <span style="background-color:yellow;">]</span> </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">4</span> </b><br /><p><span style="background-color:yellow;">An</span> <span style="background-color:yellow;">alternative</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>z = x.copy()
z.update(y)
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">5</span> </b><br /><p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">wanted</span> <span style="background-color:yellow;">something</span> <span style="background-color:yellow;">similar</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">ability</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">specify</span> <span style="background-color:yellow;">how</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">values</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">duplicate</span> <span style="background-color:yellow;">keys</span> <span style="background-color:yellow;">were</span> <span style="background-color:yellow;">merged</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">so</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">hacked</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">out</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">heavily</span> <span style="background-color:yellow;">tested</span> <span style="background-color:yellow;">!</span> <span style="background-color:yellow;"></span> . <span style="background-color:yellow;">Obviously</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">single</span> <span style="background-color:yellow;">expression</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">single</span> <span style="background-color:yellow;">fn.</span> <span style="background-color:yellow;">call</span> . </p>
<pre><code>def merge(d1, d2, merge=lambda x,y:y):
    """
    Merges two dictionaries, non-destructively, combining 
    values on duplicate keys as defined by the optional merge
    function.  The default behavior replaces the values in d1
    with corresponding values in d2.  (There is no other generally
    applicable merge strategy, but often you'll have homogeneous 
    types in your dicts, so specifying a merge technique can be 
    valuable.)

    Examples:

    >>> d1
    {'a': 1, 'c': 3, 'b': 2}
    >>> merge(d1, d1)
    {'a': 1, 'c': 3, 'b': 2}
    >>> merge(d1, d1, lambda x,y: x+y)
    {'a': 2, 'c': 6, 'b': 4}

    """
    result = dict(d1)
    for k,v in d2.iteritems():
        if k in result:
            result[k] = merge(result[k], v)
        else:
            result[k] = v
    return result
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">6</span> </b><br /><pre><code>x = {'a':1, 'b': 2}
y = {'b':10, 'c': 11}
z = dict(x.items() + y.items())
print z
</code></pre>
<p><span style="background-color:yellow;">For</span> <span style="background-color:yellow;">items</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">keys</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">both</span> <span style="background-color:yellow;">dictionaries</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">'b</span> <span style="background-color:yellow;">'</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">control</span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">one</span> <span style="background-color:yellow;">ends</span> <span style="background-color:yellow;">up</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">output</span> <span style="background-color:yellow;">by</span> <span style="background-color:yellow;">putting</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">one</span> <span style="background-color:yellow;">last</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">7</span> </b><br /><p><span style="background-color:yellow;">The</span> <span style="background-color:yellow;">best</span> <span style="background-color:yellow;">version</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">could</span> <span style="background-color:yellow;">think</span> <span style="background-color:yellow;">while</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">using</span> <span style="background-color:yellow;">copy</span> <span style="background-color:yellow;">would</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>from itertools import chain
x = {'a':1, 'b': 2}
y = {'b':10, 'c': 11}
dict(chain(x.iteritems(), y.iteritems()))
</code></pre>
<p><span style="background-color:yellow;">It</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">faster</span> <span style="background-color:yellow;">than</span> <span style="background-color:yellow;">dict</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">x.items</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">+</span> <span style="background-color:yellow;">y.items</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">fast</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">n</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">copy</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">n.update</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">b</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">at</span> <span style="background-color:yellow;">least</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">CPython.</span> <span style="background-color:yellow;">This</span> <span style="background-color:yellow;">version</span> <span style="background-color:yellow;">also</span> <span style="background-color:yellow;">works</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">3</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">change</span> <span style="background-color:yellow;">iteritems</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">items</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">automatically</span> <span style="background-color:yellow;">done</span> <span style="background-color:yellow;">by</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">2to3</span> <span style="background-color:yellow;">tool</span> . </p>
<p><span style="background-color:yellow;">Personally</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">like</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">version</span> <span style="background-color:yellow;">best</span> <span style="background-color:yellow;">because</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">describes</span> <span style="background-color:yellow;">fairly</span> <span style="background-color:yellow;">good</span> <span style="background-color:yellow;">what</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">want</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">single</span> <span style="background-color:yellow;">functional</span> <span style="background-color:yellow;">syntax.</span> <span style="background-color:yellow;">The</span> <span style="background-color:yellow;">only</span> <span style="background-color:yellow;">minor</span> <span style="background-color:yellow;">problem</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">does</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">make</span> <span style="background-color:yellow;">completely</span> <span style="background-color:yellow;">obvious</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">values</span> <span style="background-color:yellow;">from</span> <span style="background-color:yellow;">y</span> <span style="background-color:yellow;">takes</span> <span style="background-color:yellow;">precedence</span> <span style="background-color:yellow;">over</span> <span style="background-color:yellow;">values</span> <span style="background-color:yellow;">from</span> <span style="background-color:yellow;">x</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">believe</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">difficult</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">figure</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">out</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">8</span> </b><br /><p><span style="background-color:yellow;">While</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">question</span> <span style="background-color:yellow;">has</span> <span style="background-color:yellow;">already</span> <span style="background-color:yellow;">been</span> <span style="background-color:yellow;">answered</span> <span style="background-color:yellow;">several</span> <span style="background-color:yellow;">times</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">simple</span> <span style="background-color:yellow;">solution</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">problem</span> <span style="background-color:yellow;">has</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">been</span> <span style="background-color:yellow;">listed</span> <span style="background-color:yellow;">yet</span> . </p>
<pre><code>x = {'a':1, 'b': 2}
y = {'b':10, 'c': 11}
z4 = {}
z4.update(x)
z4.update(y)
</code></pre>
<p><span style="background-color:yellow;">It</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">fast</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">z0</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">evil</span> <span style="background-color:yellow;">z2</span> <span style="background-color:yellow;">mentioned</span> <span style="background-color:yellow;">above</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">easy</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">understand</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">change</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">9</span> </b><br /><p><span style="background-color:yellow;">If</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">think</span> <span style="background-color:yellow;">lambdas</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">evil</span> <span style="background-color:yellow;">then</span> <span style="background-color:yellow;">read</span> <span style="background-color:yellow;">no</span> <span style="background-color:yellow;">further</span> . <span style="background-color:yellow;">As</span> <span style="background-color:yellow;">requested</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">write</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">fast</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">memory-efficient</span> <span style="background-color:yellow;">solution</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">one</span> <span style="background-color:yellow;">expression</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>x = {'a':1, 'b':2}
y = {'b':10, 'c':11}
z = (lambda a, b: (lambda a_copy: a_copy.update(b) or a_copy)(a.copy()))(x, y)
print z
{'a': 1, 'c': 11, 'b': 10}
print x
{'a': 1, 'b': 2}
</code></pre>
<p><span style="background-color:yellow;">As</span> <span style="background-color:yellow;">suggested</span> <span style="background-color:yellow;">above</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">using</span> <span style="background-color:yellow;">two</span> <span style="background-color:yellow;">lines</span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">writing</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">function</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">probably</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">better</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">go</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">10</span> </b><br /><pre><code>def merge(d1, d2):
    for k1,v1 in d1.iteritems():
        if not k1 in d2:
            d2[k1] = v1
        elif isinstance(v1, dict):
            merge(v1, d2[k1])
    return d2
</code></pre>
<br />