<h3><span style="background-color:yellow;">Question</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">ID-4173904</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </h3><h2><span style="background-color:yellow;">String</span> <span style="background-color:yellow;">coverage</span> <span style="background-color:yellow;">optimization</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">Python</span> </h2><p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">initial</span> <span style="background-color:yellow;">string</span> . </p>
<pre><code>'bananaappleorangestrawberryapplepear'
</code></pre>
<p><span style="background-color:yellow;">And</span> <span style="background-color:yellow;">also</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">tuple</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">strings</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>('apple', 'plepe', 'leoran', 'lemon')
</code></pre>
<p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">want</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">function</span> <span style="background-color:yellow;">so</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">from</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">initial</span> <span style="background-color:yellow;">string</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">tuple</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">strings</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">obtain</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>'bananaxxxxxxxxxgestrawberryxxxxxxxar'
</code></pre>
<p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">know</span> <span style="background-color:yellow;">how</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">imperatively</span> <span style="background-color:yellow;">by</span> <span style="background-color:yellow;">finding</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">word</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">initial</span> <span style="background-color:yellow;">string</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">every</span> <span style="background-color:yellow;">word</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">then</span> <span style="background-color:yellow;">loop</span> <span style="background-color:yellow;">character</span> <span style="background-color:yellow;">by</span> <span style="background-color:yellow;">character</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">all</span> <span style="background-color:yellow;">initial</span> <span style="background-color:yellow;">string</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">replaced</span> <span style="background-color:yellow;">words</span> . </p>
<p><span style="background-color:yellow;">But</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">very</span> <span style="background-color:yellow;">efficient</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">ugly.</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">suspect</span> <span style="background-color:yellow;">there</span> <span style="background-color:yellow;">should</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">some</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">doing</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">more</span> <span style="background-color:yellow;">elegantly</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">functional</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">itertools</span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">something.</span> <span style="background-color:yellow;">If</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">know</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">library</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">efficiently</span> <span style="background-color:yellow;">please</span> <span style="background-color:yellow;">let</span> <span style="background-color:yellow;">me</span> <span style="background-color:yellow;">know</span> . </p>
<p><span style="background-color:yellow;">UPDATE</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">Justin</span> <span style="background-color:yellow;">Peel</span> <span style="background-color:yellow;">pointed</span> <span style="background-color:yellow;">out</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">case</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">did</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">describe</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">my</span> <span style="background-color:yellow;">initial</span> <span style="background-color:yellow;">question.</span> <span style="background-color:yellow;">If</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">word</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">'aaa</span> <span style="background-color:yellow;">'</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">'aaaaaa</span> <span style="background-color:yellow;">'</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">initial</span> <span style="background-color:yellow;">string</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">output</span> <span style="background-color:yellow;">should</span> <span style="background-color:yellow;">look</span> <span style="background-color:yellow;">like</span> <span style="background-color:yellow;">'xxxxxx'</span> . </p>
<br /><h3><span style="background-color:yellow;">Answers</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">Total-6</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </h3><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">0</span> </b><br /><pre><code>import re

words = ('apple', 'plepe', 'leoran', 'lemon')
s = 'bananaappleorangestrawberryapplepear'

x = set()

for w in words:
    for m in re.finditer(w, s):
        i = m.start()
        for j in range(i, i+len(w)):
            x.add(j)

result = ''.join(('x' if i in x else s[i]) for i in range(len(s)))
print result
</code></pre>
<p><span style="background-color:yellow;">produces</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>bananaxxxxxxxxxgestrawberryxxxxxxxar
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">1</span> </b><br /><p><span style="background-color:yellow;">Here</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">another</span> <span style="background-color:yellow;">answer.</span> <span style="background-color:yellow;">There</span> <span style="background-color:yellow;">might</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">faster</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">replace</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">letters</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">x</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">think</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">necessary</span> <span style="background-color:yellow;">because</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">already</span> <span style="background-color:yellow;">pretty</span> <span style="background-color:yellow;">fast</span> . </p>
<pre><code>import re

def do_xs(s,pats):
    pat = re.compile('('+'|'.join(pats)+')')

    sout = list(s)
    i = 0
    match = pat.search(s)
    while match:
        span = match.span()
        sout[span[0]:span[1]] = ['x']*(span[1]-span[0])
        i = span[0]+1
        match = pat.search(s,i)
    return ''.join(sout)

txt = 'bananaappleorangestrawberryapplepear'
pats = ('apple', 'plepe', 'leoran', 'lemon')
print do_xs(txt,pats)
</code></pre>
<p><span style="background-color:yellow;">Basically</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">create</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">regex</span> <span style="background-color:yellow;">pattern</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">will</span> <span style="background-color:yellow;">match</span> <span style="background-color:yellow;">any</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">input</span> <span style="background-color:yellow;">patterns.</span> <span style="background-color:yellow;">Then</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">just</span> <span style="background-color:yellow;">keep</span> <span style="background-color:yellow;">restarting</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">search</span> <span style="background-color:yellow;">starting</span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;">after</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">starting</span> <span style="background-color:yellow;">position</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">most</span> <span style="background-color:yellow;">recent</span> <span style="background-color:yellow;">match.</span> <span style="background-color:yellow;">There</span> <span style="background-color:yellow;">might</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">problem</span> <span style="background-color:yellow;">though</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">one</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">input</span> <span style="background-color:yellow;">patterns</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">prefix</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">another</span> <span style="background-color:yellow;">input</span> <span style="background-color:yellow;">pattern</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">2</span> </b><br /><p><span style="background-color:yellow;">Assuming</span> <span style="background-color:yellow;">we</span> <span style="background-color:yellow;">'re</span> <span style="background-color:yellow;">restricted</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">working</span> <span style="background-color:yellow;">without</span> <span style="background-color:yellow;">stdlib</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">other</span> <span style="background-color:yellow;">imports</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>s1 = 'bananaappleorangestrawberryapplepear'
t = ('apple', 'plepe', 'leoran', 'lemon')
s2 = s1

solution = 'bananaxxxxxxxxxgestrawberryxxxxxxxar'

for word in t:
    if word not in s1: continue
    index = -1 # Start at -1 so our index search starts at 0
    for iteration in range(s1.count(word)):
        index = s1.find(word, index+1)
        length = len(word)
        before = s2[:index]
        after = s2[index+length:]
        s2 = before + 'x'*length + after

print s2 == solution
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">3</span> </b><br /><pre><code>>>> string_ = 'bananaappleorangestrawberryapplepear'
>>> words = ('apple', 'plepe', 'leoran', 'lemon')
>>> xes = [(string_.find(w), len(w)) for w in words]
>>> xes
[(6, 5), (29, 5), (9, 6), (-1, 5)]
>>> for index, len_ in xes:
...   if index == -1: continue
...   string_ = string_.replace(string_[index:index+len_], 'x'*len_)
...
>>> string_
'bananaxxxxxxxxxgestrawberryxxxxxxxar'
>>>
</code></pre>
<p><span style="background-color:yellow;">There</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">surely</span> <span style="background-color:yellow;">more</span> <span style="background-color:yellow;">effective</span> <span style="background-color:yellow;">ways</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">premature</span> <span style="background-color:yellow;">optimisation</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">root</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">all</span> <span style="background-color:yellow;">evil</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">4</span> </b><br /><pre><code>a = ('apple', 'plepe', 'leoran', 'lemon')
b = 'bananaappleorangestrawberryapplepear'

for fruit in a:
    if a in b:
        b = b.replace(fruit, numberofx's)
</code></pre>
<p><span style="background-color:yellow;">The</span> <span style="background-color:yellow;">only</span> <span style="background-color:yellow;">thing</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">now</span> <span style="background-color:yellow;">his</span> <span style="background-color:yellow;">determine</span> <span style="background-color:yellow;">how</span> <span style="background-color:yellow;">many</span> <span style="background-color:yellow;">X</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">replace</span> <span style="background-color:yellow;">with</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">5</span> </b><br /><pre><code>def mask_words(s, words):
    mask = [False] * len(s)
    for word in words:
        pos = 0
        while True:
            idx = s.find(word, pos)
            if idx == -1:
                break

            length = len(word)
            for i in xrange(idx, idx+length):
                mask[i] = True
            pos = idx+length

    # Sanity check:
    assert len(mask) == len(s)

    result = []
    for masked, c in zip(mask, s):
        result.append('x' if masked else c)

    return "".join(result)
</code></pre>
<br />