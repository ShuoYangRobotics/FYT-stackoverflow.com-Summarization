<h3><span style="background-color:yellow;">Question</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">ID-5774099</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </h3><h2><span style="background-color:yellow;">Defining</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">function</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">counts</span> <span style="background-color:yellow;">relative</span> <span style="background-color:yellow;">frequency</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">Amino</span> <span style="background-color:yellow;">Acids</span> </h2><p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'m</span> <span style="background-color:yellow;">trying</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">calculate</span> <span style="background-color:yellow;">codon</span> <span style="background-color:yellow;">frequency</span> <span style="background-color:yellow;">within</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">given</span> <span style="background-color:yellow;">sequence</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">DNA</span> . </p>
<p><span style="background-color:yellow;">For</span> <span style="background-color:yellow;">example</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>sequence = 'ATGAAGAAA'
codons = ['ATG', 'AAG', 'AAA']
</code></pre>
<p><span style="background-color:yellow;">for</span> <span style="background-color:yellow;">XX</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">codons</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>frequency  = codons.count(XX)/(codons.count(XX)+codons.count(XX2)+codons.count(XX3))
</code></pre>
<p><span style="background-color:yellow;">Note</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">XX2</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">XX3</span> <span style="background-color:yellow;">will</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">always</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">sequence.</span> <span style="background-color:yellow;">Some</span> <span style="background-color:yellow;">codons</span> <span style="background-color:yellow;">may</span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">may</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">multiple</span> <span style="background-color:yellow;">codons</span> . </p>
<p><span style="background-color:yellow;">Example</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">Lysine</span> <span style="background-color:yellow;">has</span> <span style="background-color:yellow;">2</span> <span style="background-color:yellow;">codons</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">AAA</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">AAG</span> </p>
<p><span style="background-color:yellow;">so</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">frequency</span> <span style="background-color:yellow;">of</span> </p>
<pre><code>AAA = codons.count('AAA')/(codons.count('AAA') + codons.count('AAG'))
</code></pre>
<p><span style="background-color:yellow;">How</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">EVERY</span> <span style="background-color:yellow;">codon</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">list</span> ? <span style="background-color:yellow;">How</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">account</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">multiple</span> <span style="background-color:yellow;">codons</span> ? </p>
<br /><h3><span style="background-color:yellow;">Answers</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">Total-6</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </h3><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">0</span> </b><br /><p><span style="background-color:yellow;">use</span> <span style="background-color:yellow;">defaultdict</span> </p>
<pre><code>from collections import defaultdict

mydict = defaultdict(int)

for aa in mysecuence:
    mydict[aa] +=1
</code></pre>
<p><span style="background-color:yellow;">This</span> <span style="background-color:yellow;">works</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">aminoacids</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">proteins</span> <span style="background-color:yellow;"></span> . <span style="background-color:yellow;">For</span> <span style="background-color:yellow;">codons</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">should</span> <span style="background-color:yellow;">iterate</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">sequence</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">3</span> <span style="background-color:yellow;">positions</span> <span style="background-color:yellow;">steps</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">get</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">keys</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">defaultdict.</span> <span style="background-color:yellow;">For</span> <span style="background-color:yellow;">example</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>>>> mysec = "GAUCACTUGCCA"
>>> a = [mysec[i:i+3] for i in range(0,len(mysec), 3)]
>>> print a


['GAU', 'CAC', 'TUG', 'CCA']
</code></pre>
<p><span style="background-color:yellow;">EDIT</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">If</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">want</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">calculate</span> <span style="background-color:yellow;">degeneration</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">should</span> <span style="background-color:yellow;">prepare</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">dictionary</span> <span style="background-color:yellow;">relating</span> <span style="background-color:yellow;">each</span> <span style="background-color:yellow;">codon</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">key</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">its</span> <span style="background-color:yellow;">degenerated</span> <span style="background-color:yellow;">codons</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">value</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">list</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">codons</span> <span style="background-color:yellow;"></span> . <span style="background-color:yellow;">To</span> <span style="background-color:yellow;">calculate</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">frecuency</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">from</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">defaultdict</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">get</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">counts</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">each</span> <span style="background-color:yellow;">codon</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">then</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">each</span> <span style="background-color:yellow;">codon</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">calculate</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">sum</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">counts</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">degenerated</span> <span style="background-color:yellow;">codons</span> <span style="background-color:yellow;">read</span> <span style="background-color:yellow;">from</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">dictionary</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">codons</span> <span style="background-color:yellow;">indicated</span> <span style="background-color:yellow;">above.</span> <span style="background-color:yellow;">Then</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">calculate</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">frecuency</span> . </p>
<p><span style="background-color:yellow;">EDIT</span> <span style="background-color:yellow;">2</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">Here</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">real</span> <span style="background-color:yellow;">example</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>from collections import defaultdict

#the first 600 nucleotides from GenBank: AAHX01097212.1
rna = ("tcccccgcagcttcgggaacgtgcgggctcgggagggaggggcctggcgccgggcgcgcg"
       "cctgcgccccaccccgccccaccctggcgggtctcgcgcgcccggcccgcctcctgtcaa"
       "ccccagcgcggcggtcaggtggtccccagcccttggccccagcctccagcttcctggtcc"
       "ctcgggctctgagtcctgtctccggcagatcgcctttctgattgttctcctgcgcagctg"
       "gaggtgtatagcccctagccgagctatggtgcctcagcagatgtgaggaggtagtgggtc"
       "aggataaacccgcgcactccataataacgtgccagggctcagtgacttgggtctgcatta")

seq = rna.upper().replace('T', 'U')

#RNA codon table from http://en.wikipedia.org/wiki/Genetic_code
degenerated = (('GCU', 'GCC', 'GCA', 'GCG'),
               ('UUA', 'UUG', 'CUU', 'CUC', 'CUA', 'CUG'),
               ('CGU', 'CGC', 'CGA', 'CGG', 'AGA', 'AGG'),
               ('AAA', 'AAG'), ('AAU', 'AAC'), ('GAU', 'GAC'),
               ('UUU', 'UUC'), ('UGU', 'UGC'), ('CCU', 'CCC', 'CCA', 'CCG'),
               ('CAA', 'CAG'), ('UCU', 'UCC', 'UCA', 'UCG', 'AGU', 'AGC'),
               ('GAA', 'GAG'), ('ACU', 'ACC', 'ACA', 'ACG'),
               ('GGU', 'GGC', 'GGA', 'GGG'), ('CAU', 'CAC'), ('UAU', 'UAC'),
               ('AUU', 'AUC', 'AUA'), ('GUU', 'GUC', 'GUA', 'GUG'),
               ('UAA', 'UGA', 'UAG'))

#prepare the dictio of degenerated codons
degen_dict = {}
for codons in degenerated:
    for codon in codons:
        degen_dict[codon] = codons

#query_codons
max_seq = len(seq)
query_codons = [seq[i:i+3] for i in range(0, max_seq, 3)]

#prepare dictio of counts:
counts = defaultdict(int)
for codon in query_codons:
    counts[codon] +=1

#actual calculation of frecuencies
data = {}
for codon in query_codons:
    if codon in  degen_dict:
        totals = sum(counts[deg] for deg in degen_dict[codon])
        frecuency = float(counts[codon]) / totals
    else:
        frecuency = 1.00

    data[codon] = frecuency

#print results
for codon, frecuency in data.iteritems():
    print "%s  -> %.2f" %(codon, frecuency)


#produces:
GUC  -> 0.57
AUA  -> 1.00
ACG  -> 0.50
AAC  -> 1.00
CCU  -> 0.25
UAU  -> 1.00
..........
GCU  -> 0.19
GAU  -> 1.00
UAG  -> 0.33
CUC  -> 0.38
UUA  -> 0.13
UGA  -> 0.33
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">1</span> </b><br /><p><span style="background-color:yellow;">take</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">look</span> <span style="background-color:yellow;">at</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">here</span> <span style="background-color:yellow;">they</span> <span style="background-color:yellow;">define</span> <span style="background-color:yellow;">python</span> <span style="background-color:yellow;">scripts</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">Peptide</span> <span style="background-color:yellow;">Library</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">example</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">maybe</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">find</span> <span style="background-color:yellow;">them</span> <span style="background-color:yellow;">useful</span> </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">2</span> </b><br /><p><span style="background-color:yellow;">If</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">sequence</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">correct</span> <span style="background-color:yellow;">reading</span> <span style="background-color:yellow;">frame</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>>>> import collections
>>> 
>>> code = {     'ttt': 'F', 'tct': 'S', 'tat': 'Y', 'tgt': 'C',
...              'ttc': 'F', 'tcc': 'S', 'tac': 'Y', 'tgc': 'C',
...              'tta': 'L', 'tca': 'S', 'taa': '*', 'tga': '*',
...              'ttg': 'L', 'tcg': 'S', 'tag': '*', 'tgg': 'W',
...              'ctt': 'L', 'cct': 'P', 'cat': 'H', 'cgt': 'R',
...              'ctc': 'L', 'ccc': 'P', 'cac': 'H', 'cgc': 'R',
...              'cta': 'L', 'cca': 'P', 'caa': 'Q', 'cga': 'R',
...              'ctg': 'L', 'ccg': 'P', 'cag': 'Q', 'cgg': 'R',
...              'att': 'I', 'act': 'T', 'aat': 'N', 'agt': 'S',
...              'atc': 'I', 'acc': 'T', 'aac': 'N', 'agc': 'S',
...              'ata': 'I', 'aca': 'T', 'aaa': 'K', 'aga': 'R',
...              'atg': 'M', 'acg': 'T', 'aag': 'K', 'agg': 'R',
...              'gtt': 'V', 'gct': 'A', 'gat': 'D', 'ggt': 'G',
...              'gtc': 'V', 'gcc': 'A', 'gac': 'D', 'ggc': 'G',
...              'gta': 'V', 'gca': 'A', 'gaa': 'E', 'gga': 'G',
...              'gtg': 'V', 'gcg': 'A', 'gag': 'E', 'ggg': 'G'
...         }
>>> def count_codons(cds):
...     counts = collections.defaultdict(int)
...     for i in range(0,len(cds),3):
...        codon = cds[i:i+3]
...        counts[codon] += 1
...     return counts
... 
>>> def translate(cds, code):
...     return "".join((code[cds[i:i+3]] for i in range(0, len(cds), 3)))
... 
>>> seq = 'ATGAAGAAA'
>>> 
>>> codon_counts = count_codons(seq.lower())
>>> trans_seq = translate(seq.lower(), code)
>>> 
>>> [(codon, code[codon], float(codon_counts[codon])/trans_seq.count(code[codon])) for codon in codon_counts.keys()]
[('atg', 'M', 1.0), ('aag', 'K', 0.5), ('aaa', 'K', 0.5)]
>>> 
</code></pre>
<p><span style="background-color:yellow;">other</span> <span style="background-color:yellow;">info</span> <span style="background-color:yellow;">:</span> </p>
<p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">think</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">asking</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">find</span> <span style="background-color:yellow;">something</span> <span style="background-color:yellow;">called</span> <span style="background-color:yellow;">codon</span> <span style="background-color:yellow;">usage</span> . </p>
<p><span style="background-color:yellow;">There</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">tools</span> <span style="background-color:yellow;">online</span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">allow</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">find</span> <span style="background-color:yellow;">codon</span> <span style="background-color:yellow;">usage.</span> <span style="background-color:yellow;">This</span> <span style="background-color:yellow;">one</span> <span style="background-color:yellow;">also</span> <span style="background-color:yellow;">allows</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">offline</span> <span style="background-color:yellow;">use</span> . </p>
<p><span style="background-color:yellow;">http</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">//www.bioinformatics.org/sms2/codon_usage.html</span> </p>
<p><span style="background-color:yellow;">and</span> <span style="background-color:yellow;">results</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">'Fraction</span> <span style="background-color:yellow;">'</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">what</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">asking</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </p>
<pre><code>Results for 9 residue sequence "sample sequence one" starting "ATGAAGAAA"
AmAcid   Codon     Number        /1000     Fraction   .. 

Ala      GCG         0.00         0.00         0.00 
Ala      GCA         0.00         0.00         0.00 
Ala      GCT         0.00         0.00         0.00 
Ala      GCC         0.00         0.00         0.00 

Cys      TGT         0.00         0.00         0.00 
Cys      TGC         0.00         0.00         0.00 

Asp      GAT         0.00         0.00         0.00 
Asp      GAC         0.00         0.00         0.00 

Glu      GAG         0.00         0.00         0.00 
Glu      GAA         0.00         0.00         0.00 

Phe      TTT         0.00         0.00         0.00 
Phe      TTC         0.00         0.00         0.00 

Gly      GGG         0.00         0.00         0.00 
Gly      GGA         0.00         0.00         0.00 
Gly      GGT         0.00         0.00         0.00 
Gly      GGC         0.00         0.00         0.00 

His      CAT         0.00         0.00         0.00 
His      CAC         0.00         0.00         0.00 

Ile      ATA         0.00         0.00         0.00 
Ile      ATT         0.00         0.00         0.00 
Ile      ATC         0.00         0.00         0.00 

Lys      AAG         1.00       333.33         0.50 
Lys      AAA         1.00       333.33         0.50 

Leu      TTG         0.00         0.00         0.00 
Leu      TTA         0.00         0.00         0.00 
Leu      CTG         0.00         0.00         0.00 
Leu      CTA         0.00         0.00         0.00 
Leu      CTT         0.00         0.00         0.00 
Leu      CTC         0.00         0.00         0.00 

Met      ATG         1.00       333.33         1.00 

Asn      AAT         0.00         0.00         0.00 
Asn      AAC         0.00         0.00         0.00 

Pro      CCG         0.00         0.00         0.00 
Pro      CCA         0.00         0.00         0.00 
Pro      CCT         0.00         0.00         0.00 
Pro      CCC         0.00         0.00         0.00 

Gln      CAG         0.00         0.00         0.00 
Gln      CAA         0.00         0.00         0.00 

Arg      AGG         0.00         0.00         0.00 
Arg      AGA         0.00         0.00         0.00 
Arg      CGG         0.00         0.00         0.00 
Arg      CGA         0.00         0.00         0.00 
Arg      CGT         0.00         0.00         0.00 
Arg      CGC         0.00         0.00         0.00 

Ser      AGT         0.00         0.00         0.00 
Ser      AGC         0.00         0.00         0.00 
Ser      TCG         0.00         0.00         0.00 
Ser      TCA         0.00         0.00         0.00 
Ser      TCT         0.00         0.00         0.00 
Ser      TCC         0.00         0.00         0.00 

Thr      ACG         0.00         0.00         0.00 
Thr      ACA         0.00         0.00         0.00 
Thr      ACT         0.00         0.00         0.00 
Thr      ACC         0.00         0.00         0.00 

Val      GTG         0.00         0.00         0.00 
Val      GTA         0.00         0.00         0.00 
Val      GTT         0.00         0.00         0.00 
Val      GTC         0.00         0.00         0.00 

Trp      TGG         0.00         0.00         0.00 

Tyr      TAT         0.00         0.00         0.00 
Tyr      TAC         0.00         0.00         0.00 

End      TGA         0.00         0.00         0.00 
End      TAG         0.00         0.00         0.00 
End      TAA         0.00         0.00         0.00 
</code></pre>
<p><span style="background-color:yellow;">cusp</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">codon</span> <span style="background-color:yellow;">usage</span> <span style="background-color:yellow;">tool</span> <span style="background-color:yellow;">from</span> <span style="background-color:yellow;">EMBOSS</span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">also</span> <span style="background-color:yellow;">may</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">worth</span> <span style="background-color:yellow;">taking</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">look</span> <span style="background-color:yellow;">at</span> . </p>
<p><span style="background-color:yellow;">You</span> <span style="background-color:yellow;">may</span> <span style="background-color:yellow;">want</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">checkout</span> <span style="background-color:yellow;">BioPython</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">working</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">biological</span> <span style="background-color:yellow;">sequences.</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">believe</span> <span style="background-color:yellow;">they</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">codon</span> <span style="background-color:yellow;">usage</span> <span style="background-color:yellow;">module</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">3</span> </b><br /><ul><span style="background-color:yellow;">a</span> <span style="background-color:yellow;">codon</span> <span style="background-color:yellow;">table</span> <span style="background-color:yellow;">containing</span> <span style="background-color:yellow;">ALL</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">64</span> <span style="background-color:yellow;">codons</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">even</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">non-degenarated</span> <span style="background-color:yellow;">ones</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">they</span> <span style="background-color:yellow;">constitute</span> <span style="background-color:yellow;">one</span> <span style="background-color:yellow;">element</span> <span style="background-color:yellow;">groups</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">counting</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">occurences</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">each</span> <span style="background-color:yellow;">codon</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">group</span> <span style="background-color:yellow;">at</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">same</span> <span style="background-color:yellow;">time</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">occurences</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">codons</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">counted</span> <span style="background-color:yellow;">during</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">iteration</span> <span style="background-color:yellow;">codon</span> <span style="background-color:yellow;">table</span> <span style="background-color:yellow;">comprising</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">names</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">coded</span> <span style="background-color:yellow;">amino</span> <span style="background-color:yellow;">acids</span> <span style="background-color:yellow;">-&gt</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">good</span> <span style="background-color:yellow;">display</span> </ul>
<p><span style="background-color:yellow;">code</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>from collections import defaultdict

# the first 600 nucleotides from GenBank: AAHX01097212.1
adn = ("tcccccgcagcttcgggaacgtgcgggctcgggagggaggggcctggcgccgggcgcgcg"
       "cctgcgccccaccccgccccaccctggcgggtctcgcgcgcccggcccgcctcctgtcaa"
       "ccccagcgcggcggtcaggtggtccccagcccttggccccagcctccagcttcctggtcc"
       "ctcgggctctgagtcctgtctccggcagatcgcctttctgattgttctcctgcgcagctg"
       "gaggtgtatagcccctagccgagctatggtgcctcagcagatgtgaggaggtagtgggtc"
       "aggataaacccgcgcactccataataacgtgccagggctcagtgacttgggtctgcatta")

arn = adn.upper().replace('T','U')

#RNA codon table from http://en.wikipedia.org/wiki/Genetic_code
codon_table = ((('GCU', 'GCC', 'GCA', 'GCG'),  'Alanine'),
               (('UUA', 'UUG', 'CUU', 'CUC', 'CUA', 'CUG'),  'Leucine'),
               (('CGU', 'CGC', 'CGA', 'CGG', 'AGA', 'AGG'),  'Arginine'),
               (('AAA', 'AAG'),  'Lysine'),
               (('AAU', 'AAC'),  'Asparagine'),
               (('AUG',),  'Methionine'),
               (('GAU', 'GAC'),  'Aspartic acid' ),              
               (('UUU', 'UUC'),  'Phenylalanine'),
               (('UGU', 'UGC'),  'Cysteine'),
               (('CCU', 'CCC', 'CCA', 'CCG'),  'Proline') ,
               (('CAA', 'CAG'),  'Glutamine'),
               (('UCU', 'UCC', 'UCA', 'UCG', 'AGU', 'AGC'),  'Serine'),
               (('GAA', 'GAG'),  'Glutamic acid'),
               (('ACU', 'ACC', 'ACA', 'ACG'),  'Threonine'),
               (('GGU', 'GGC', 'GGA', 'GGG'),  'Glycine'),
               (('UGG',),  'Tryptophane'),
               (('CAU', 'CAC'),  'Histidine'),
               (('UAU', 'UAC'),  'Tyrosine'),
               (('AUU', 'AUC', 'AUA'),  'Isoleucine'),
               (('GUU', 'GUC', 'GUA', 'GUG'),  'Valine'),
               (('UAA', 'UGA', 'UAG'),  'STOP')            )

siblings = dict( (cod, codgroup) for codgroup,aa in codon_table for cod in codgroup )

cod_count, grp_count, freq = defaultdict(int), defaultdict(int), {}

for cod in (arn[i:i+3] for i in xrange(0,len(arn),3)):
    cod_count[cod] += 1
    grp_count[siblings[cod]] += 1

for cod in siblings.iterkeys(): # the keys of siblings are the 64 codons
    if siblings[cod] in grp_count:
        freq[cod] = float(cod_count[cod])/grp_count[siblings[cod]]
    else:
        freq[cod] = '-* Missing *-'


display = '\n'.join(aa.rjust(13)+\
                '\n'.join('%s  %-16s' % (cod.rjust(18 if i else 5),freq[cod])
                          for i,cod in enumerate(codgrp))
                for codgrp,aa in codon_table)


# editing addition:

def outputResults(filename,arn,codon_table,displ):

    li = ['This file is named %s' % filename]

    li.append('The sequence of ARN:\n%s' %\
              '\n'.join(arn[i:i+42] for i in xrange(0,len(arn),42)))
    li.append('Size of the sequence : '+str(len(arn)))

    li.append('Codon_table:\n'+\
              '\n'.join('%s : %s' % (u,v) for u,v in codon_table))

    li.append('Frequency results :\n'+displ)

    with open(filename,'w') as f:
        f.writelines('\n\n'.join(li))


outputResults('ARN_mem.txt',arn,codon_table,display)
print display 
</code></pre>
<p>. </p>
<h2><span style="background-color:yellow;">EDIT</span> </h2>
<p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'ve</span> <span style="background-color:yellow;">added</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">function</span> <span style="background-color:yellow;">outputResults</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">show</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">manner</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">record</span> <span style="background-color:yellow;">data</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">results</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">file</span> </p>
<p><span style="background-color:yellow;">The</span> <span style="background-color:yellow;">resulting</span> <span style="background-color:yellow;">file</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">content</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>This file is named ARN_mem.txt

The sequence of ARN:
UCCCCCGCAGCUUCGGGAACGUGCGGGCUCGGGAGGGAGGGG
CCUGGCGCCGGGCGCGCGCCUGCGCCCCACCCCGCCCCACCC
UGGCGGGUCUCGCGCGCCCGGCCCGCCUCCUGUCAACCCCAG
CGCGGCGGUCAGGUGGUCCCCAGCCCUUGGCCCCAGCCUCCA
GCUUCCUGGUCCCUCGGGCUCUGAGUCCUGUCUCCGGCAGAU
CGCCUUUCUGAUUGUUCUCCUGCGCAGCUGGAGGUGUAUAGC
CCCUAGCCGAGCUAUGGUGCCUCAGCAGAUGUGAGGAGGUAG
UGGGUCAGGAUAAACCCGCGCACUCCAUAAUAACGUGCCAGG
GCUCAGUGACUUGGGUCUGCAUUA

Size of the sequence : 360

Codon_table:
('GCU', 'GCC', 'GCA', 'GCG') : Alanine
('UUA', 'UUG', 'CUU', 'CUC', 'CUA', 'CUG') : Leucine
('CGU', 'CGC', 'CGA', 'CGG', 'AGA', 'AGG') : Arginine
('AAA', 'AAG') : Lysine
('AAU', 'AAC') : Asparagine
('AUG',) : Methionine
('GAU', 'GAC') : Aspartic acid
('UUU', 'UUC') : Phenylalanine
('UGU', 'UGC') : Cysteine
('CCU', 'CCC', 'CCA', 'CCG') : Proline
('CAA', 'CAG') : Glutamine
('UCU', 'UCC', 'UCA', 'UCG', 'AGU', 'AGC') : Serine
('GAA', 'GAG') : Glutamic acid
('ACU', 'ACC', 'ACA', 'ACG') : Threonine
('GGU', 'GGC', 'GGA', 'GGG') : Glycine
('UGG',) : Tryptophane
('CAU', 'CAC') : Histidine
('UAU', 'UAC') : Tyrosine
('AUU', 'AUC', 'AUA') : Isoleucine
('GUU', 'GUC', 'GUA', 'GUG') : Valine
('UAA', 'UGA', 'UAG') : STOP

Frequency results :
      Alanine  GCU  0.1875          
               GCC  0.375           
               GCA  0.25            
               GCG  0.1875          
      Leucine  UUA  0.125           
               UUG  0.0             
               CUU  0.25            
               CUC  0.375   
etc.............
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">4</span> </b><br /><p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'m</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">sure</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'ve</span> <span style="background-color:yellow;">fully</span> <span style="background-color:yellow;">understood</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">question</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">think</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">need</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">split</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">calculations</span> <span style="background-color:yellow;">into</span> <span style="background-color:yellow;">two</span> <span style="background-color:yellow;">stages</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">first</span> <span style="background-color:yellow;">count</span> <span style="background-color:yellow;">how</span> <span style="background-color:yellow;">many</span> <span style="background-color:yellow;">times</span> <span style="background-color:yellow;">each</span> <span style="background-color:yellow;">codon</span> <span style="background-color:yellow;">occurs</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">then</span> <span style="background-color:yellow;">work</span> <span style="background-color:yellow;">out</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">frequencies.</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'ve</span> <span style="background-color:yellow;">come</span> <span style="background-color:yellow;">up</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">following</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>from collections import defaultdict

# Initial sequence.
sequence = "AAABOBAACAAAFOOAACBARAAAAAA"

# Which codons are grouped together.
groups = (
    ('AAA', 'AAC'),
    ('BOB',),
    ('FOO', 'BAR', 'BAA'),
)

# Separate into list of codons.
codonList = []
for codons in range(0, len(sequence), 3):
    codonList.append(sequence[codons:codons+3])

# Count how many times each codon is used.
counts = defaultdict(int)
for codon in codonList:
    counts[codon] += 1

# Go through and calculate frequencies of each codon.
freqs = {}
for group in groups:
    total = float(sum(counts[codon] for codon in group))
    for codon in group:
        freqs[codon] = counts[codon] / total

# Done.
print freqs
</code></pre>
<p><span style="background-color:yellow;">Note</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">explicit</span> <span style="background-color:yellow;">conversion</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">total</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">floating-point</span> <span style="background-color:yellow;">number</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">last</span> <span style="background-color:yellow;">loop.</span> <span style="background-color:yellow;">If</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">left</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">an</span> <span style="background-color:yellow;">integer</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">subsequent</span> <span style="background-color:yellow;">division</span> <span style="background-color:yellow;">will</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">either</span> <span style="background-color:yellow;">0</span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">2.x</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">so</span> <span style="background-color:yellow;">we</span> <span style="background-color:yellow;">need</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">convert</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">get</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">floating-point</span> <span style="background-color:yellow;">output.</span> <span style="background-color:yellow;">The</span> <span style="background-color:yellow;">output</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">get</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>blair@blair-eeepc:~$ python codons.py 
{'BAR': 0.5, 'AAC': 0.33333333333333331, 'BAA': 0.0, 'AAA': 0.66666666666666663, 'BOB': 1.0, 'FOO': 0.5}
</code></pre>
<p><span style="background-color:yellow;">Is</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">sort</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">output</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">were</span> <span style="background-color:yellow;">looking</span> <span style="background-color:yellow;">for</span> ? </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">5</span> </b><br /><p><span style="background-color:yellow;">PLY</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">parser</span> <span style="background-color:yellow;">module</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">has</span> <span style="background-color:yellow;">some</span> <span style="background-color:yellow;">nice</span> <span style="background-color:yellow;">debugging</span> <span style="background-color:yellow;">features</span> <span style="background-color:yellow;">;</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">very</span> <span style="background-color:yellow;">good</span> <span style="background-color:yellow;">at</span> <span style="background-color:yellow;">tasks</span> <span style="background-color:yellow;">like</span> <span style="background-color:yellow;">this..</span> . </p>
<pre><code>from ply import lex

tokens = (
    'CODON',
)
t_CODON = (
    r"ATG|"
    r"AAG|"
    r"AAF|"
    r"AAC|"
    r"BOB|"
    r"FOO|"
    r"BAR|"
    r"AAA"
)
def t_error(t):
    raise TypeError("Unknown codon '%s'" % (t.value,))
lex.lex()
sequence = "AAABOBAACAAAFOOAACBARAAAAAA"
ccount = dict()
total = 0.0
lex.input(sequence)
for tok in iter(lex.token, None):
    if ccount.get(tok.value, False):
        ccount[tok.value] += 1
    else:
        ccount[tok.value] = 1
    total += 1.0

for codon,count in ccount.items():
    print "Frequency of %s is %f" % (codon, count/total)
</code></pre>
<p><span style="background-color:yellow;">Running</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;">produces..</span> . </p>
<pre><code>[mpenning@Bucksnort ~]$ python codon.py
Frequency of BAR is 0.111111
Frequency of BOB is 0.111111
Frequency of FOO is 0.111111
Frequency of AAA is 0.444444
Frequency of AAC is 0.222222
</code></pre>
<p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'m</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">little</span> <span style="background-color:yellow;">lost</span> <span style="background-color:yellow;">when</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">start</span> <span style="background-color:yellow;">introducing</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">chemical</span> <span style="background-color:yellow;">terminology</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">probably</span> <span style="background-color:yellow;">take</span> <span style="background-color:yellow;">over</span> <span style="background-color:yellow;">from</span> <span style="background-color:yellow;">here..</span> . </p>
<br />