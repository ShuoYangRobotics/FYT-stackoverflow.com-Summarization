<h3><span style="background-color:yellow;">Question</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">ID-877295</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </h3><h2><span style="background-color:yellow;">python</span> <span style="background-color:yellow;">dict.add_by_value</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">dict_2</span> <span style="background-color:yellow;"></span> ? </h2><p><span style="background-color:yellow;">The</span> <span style="background-color:yellow;">problem</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>>>> a = dict(a=1,b=2    )
>>> b = dict(    b=3,c=2)

>>> c = ???

c = {'a': 1, 'b': 5, 'c': 2}
</code></pre>
<p><span style="background-color:yellow;">So</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">idea</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">two</span> <span style="background-color:yellow;">add</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">dictionaries</span> <span style="background-color:yellow;">by</span> <span style="background-color:yellow;">int/float</span> <span style="background-color:yellow;">values</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">shortest</span> <span style="background-color:yellow;">form</span> . <span style="background-color:yellow;">Here</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">one</span> <span style="background-color:yellow;">solution</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'ve</span> <span style="background-color:yellow;">devised</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">like</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">cause</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">long</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>c = dict([(i,a.get(i,0) + b.get(i,0)) for i in set(a.keys()+b.keys())])
</code></pre>
<p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">think</span> <span style="background-color:yellow;">there</span> <span style="background-color:yellow;">must</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">shorter/concise</span> <span style="background-color:yellow;">solution</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">maybe</span> <span style="background-color:yellow;">something</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">reduce</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">operator</span> <span style="background-color:yellow;">module</span> ? <span style="background-color:yellow;">itertools</span> ? <span style="background-color:yellow;"></span> <span style="background-color:yellow;">...</span> <span style="background-color:yellow;">Any</span> <span style="background-color:yellow;">ideas</span> ? </p>
<p></p>
<p><span style="background-color:yellow;">Update</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'m</span> <span style="background-color:yellow;">really</span> <span style="background-color:yellow;">hoping</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">find</span> <span style="background-color:yellow;">something</span> <span style="background-color:yellow;">more</span> <span style="background-color:yellow;">elegant</span> <span style="background-color:yellow;">like</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">reduce</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">operator.add</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">key</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">itemgetter</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">0</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">+</span> <span style="background-color:yellow;">b</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">"</span> . <span style="background-color:yellow;"></span> <span style="background-color:yellow;">Obviously</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">real</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">should</span> <span style="background-color:yellow;">get</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">idea</span> <span style="background-color:yellow;"></span> . <span style="background-color:yellow;">But</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">seems</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">may</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">dream</span> . </p>
<p></p>
<p><span style="background-color:yellow;">Update</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">Still</span> <span style="background-color:yellow;">loking</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">more</span> <span style="background-color:yellow;">concise</span> <span style="background-color:yellow;">solutions.</span> <span style="background-color:yellow;">Maybe</span> <span style="background-color:yellow;">groupby</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">help</span> ? <span style="background-color:yellow;">The</span> <span style="background-color:yellow;">solution</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'ve</span> <span style="background-color:yellow;">come</span> <span style="background-color:yellow;">up</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">using</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">reduce</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">/</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">groupby</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">actually</span> <span style="background-color:yellow;">concise</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>from itertools import groupby
from operator import itemgetter,add

c = dict( [(i,reduce(add,map(itemgetter(1), v))) \
              for i,v in groupby(sorted(a.items()+b.items()), itemgetter(0))] )
</code></pre>
<br /><h3><span style="background-color:yellow;">Answers</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">Total-7</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </h3><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">0</span> </b><br /><p><span style="background-color:yellow;">solving</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">terms</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">length</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">performance</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'d</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">following</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>>>> from collections import defaultdict
>>> def d_sum(a, b):
        d = defaultdict(int, a)
        for k, v in b.items():
            d[k] += v
        return dict(d)
>>> a = {'a': 1, 'b': 2}
>>> b = {'c': 2, 'b': 3}
>>> d_sum(a, b)
{'a': 1, 'c': 2, 'b': 5}
</code></pre>
<p><span style="background-color:yellow;">it</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">also</span> <span style="background-color:yellow;">py3k-compatible</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">unlike</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">original</span> <span style="background-color:yellow;">code</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">1</span> </b><br /><p><span style="background-color:yellow;">If</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">want</span> <span style="background-color:yellow;">short</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">'re</span> <span style="background-color:yellow;">there</span> . </p>
<p><span style="background-color:yellow;">If</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">want</span> <span style="background-color:yellow;">clean</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">inherit</span> <span style="background-color:yellow;">from</span> <span style="background-color:yellow;">Ber</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">defaultdict</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">overload</span> <span style="background-color:yellow;">__add__</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>from collections import defaultdict

class summable(defaultdict):
    def __add__(self, rhs):
        new = summable()
        for i in (self.keys() + rhs.keys()):
            new[i] = self.get(i, 0) + rhs.get(i, 0)
        return new

a = summable(int, a=1, b=2)
b = summable(int, b=3, c=4)
c = a + b
print c
</code></pre>
<p><span style="background-color:yellow;">Gives</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>>>> 
defaultdict(None, {'a': 1, 'c': 4, 'b': 5})
>>>
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">2</span> </b><br /><p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">think</span> <span style="background-color:yellow;">one</span> <span style="background-color:yellow;">line</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">already</span> <span style="background-color:yellow;">pretty</span> <span style="background-color:yellow;">short</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;"></span> </p>
<p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">may</span> <span style="background-color:yellow;">become</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">half</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">line</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">defaultdict</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">remove</span> <span style="background-color:yellow;">some</span> <span style="background-color:yellow;">unnecessary</span> <span style="background-color:yellow;">list</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">set</span> <span style="background-color:yellow;">creations</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>from collections import defaultdict

a = defaultdict(int, a=1, b=2)
b = defaultdict(int, b=3, c=4)

c = dict((k, a[k]+b[k]) for k in (a.keys() + b.keys()))
print c
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">3</span> </b><br /><p><span style="background-color:yellow;">In</span> <span style="background-color:yellow;">my</span> <span style="background-color:yellow;">first</span> <span style="background-color:yellow;">impression</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">will</span> <span style="background-color:yellow;">write</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>>>> c = a.copy()
>>> for k in b: c[k] = c.get(k, 0) + b[k]
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">4</span> </b><br /><p><span style="background-color:yellow;">The</span> <span style="background-color:yellow;">first</span> <span style="background-color:yellow;">thing</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">think</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">bit</span> <span style="background-color:yellow;">more</span> <span style="background-color:yellow;">efficient</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">IMO</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">bit</span> <span style="background-color:yellow;">more</span> <span style="background-color:yellow;">elegant</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">still</span> <span style="background-color:yellow;">too</span> <span style="background-color:yellow;">much</span> <span style="background-color:yellow;">typing.</span> <span style="background-color:yellow;">Actually</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">about</span> <span style="background-color:yellow;">equivalent</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">kcwu</span> <span style="background-color:yellow;">'s</span> . </p>
<pre><code>c = reduce(lambda(d, k): [d.update({k: d.get(k, 0) + b[k]}), d][1], b, a.copy())
</code></pre>
<p><span style="background-color:yellow;">It</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">really</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">shame</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">dict.update</span> <span style="background-color:yellow;">does</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">return</span> <span style="background-color:yellow;">self</span> . <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">guess</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">way.</span> <span style="background-color:yellow;">If</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">did</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">...</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">d</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">trick</span> <span style="background-color:yellow;">would</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">unnecessary</span> . </p>
<p></p>
<blockquote><span style="background-color:yellow;">Perl</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">Easy</span> <span style="background-color:yellow;">things</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">easy</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">hard</span> <span style="background-color:yellow;">things</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">possible</span> <span style="background-color:yellow;">"</span> </blockquote>
<pre><code>%a = (a => 1, b => 2);
%b = (b => 3, c => 2);

%c = (%a, map {$_ => $a{$_} + $b{$_}} keys %b);
</code></pre>
<blockquote><span style="background-color:yellow;">Haskell</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">Easy</span> <span style="background-color:yellow;">things</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">hard</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">hard</span> <span style="background-color:yellow;">things</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">easy</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">Hard</span> <span style="background-color:yellow;">things</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">easy</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">impossible</span> <span style="background-color:yellow;">just</span> <span style="background-color:yellow;">happened</span> <span style="background-color:yellow;">"</span> </blockquote>
<pre><code>import qualified Data.Map as M

a = M.fromList [('a', 1), ('b', 2)]
b = M.fromList [('b', 3), ('c', 2)]

c = M.unionWith (+) a b
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">5</span> </b><br /><h3><span style="background-color:yellow;">Comment</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">@</span> <span style="background-color:yellow;">John</span> <span style="background-color:yellow;">Pirie</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">answer</span> <span style="background-color:yellow;">:</span> </h3>
<p><span style="background-color:yellow;">Here</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">implementation</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">does</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">self.keys</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">+</span> <span style="background-color:yellow;">rhs.keys</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </p>
<pre><code>from collections import defaultdict

class sumdict(defaultdict):
    def __add__(self, rhs):
        d = self.copy() 
        d += rhs
        return d
    __radd__ = lambda self, lhs: self + lhs
    def __iadd__(self, rhs):
        for k, v in rhs.items():
            self[k] += v
        return self

a = sumdict(int, a=1, b=2)
b = dict(b=3, c=4)
c = b + a
a += b

assert a == c == {'a': 1, 'c': 4, 'b': 5} != b
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">6</span> </b><br /><pre><code>def GenerateSum():
  for k in set(a).union(b):
    yield k, a.get(k, 0) + b.get(k, 0)

e = dict(GenerateSum())
print e
</code></pre>
<p><span style="background-color:yellow;">or</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">one</span> <span style="background-color:yellow;">liner</span> <span style="background-color:yellow;">:</span> </p>
<pre><code> print dict((k, a.get(k,0) + b.get(k,0)) for k in set(a).union(b))
</code></pre>
<br />