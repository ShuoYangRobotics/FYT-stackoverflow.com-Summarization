<h3><span style="background-color:yellow;">Question</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">ID-6629876</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </h3><h2><span style="background-color:yellow;">How</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">make</span> <span style="background-color:yellow;">an</span> <span style="background-color:yellow;">anonymous</span> <span style="background-color:yellow;">function</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">without</span> <span style="background-color:yellow;">Christening</span> <span style="background-color:yellow;">it</span> ? </h2><p><span style="background-color:yellow;">Is</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">possible</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">put</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">function</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">data</span> <span style="background-color:yellow;">structure</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">without</span> <span style="background-color:yellow;">first</span> <span style="background-color:yellow;">giving</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">name</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">def</span> ? </p>
<pre><code># This is the behaviour I want. Prints "hi".
def myprint(msg):
    print msg
f_list = [ myprint ]
f_list[0]('hi')
# The word "myprint" is never used again. Why litter the namespace with it?
</code></pre>
<p><span style="background-color:yellow;">The</span> <span style="background-color:yellow;">body</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">lambda</span> <span style="background-color:yellow;">function</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">severely</span> <span style="background-color:yellow;">limited</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">so</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">ca</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">them</span> . </p>
<p><span style="background-color:yellow;">Edit</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">For</span> <span style="background-color:yellow;">reference</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">more</span> <span style="background-color:yellow;">like</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">real-life</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;">where</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">encountered</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">problem</span> . </p>
<pre><code>def handle_message( msg ):
    print msg
def handle_warning( msg ):
    global num_warnings, num_fatals
    num_warnings += 1
    if ( is_fatal( msg ) ):
        num_fatals += 1
handlers = (
    ( re.compile( '^<\w+> (.*)' ), handle_message ),
    ( re.compile( '^\*{3} (.*)' ), handle_warning ),
)
# There are really 10 or so handlers, of similar length.
# The regexps are uncomfortably separated from the handler bodies,
# and the code is unnecessarily long.

for line in open( "log" ):
    for ( regex, handler ) in handlers:
        m = regex.search( line )
        if ( m ): handler( m.group(1) )
</code></pre>
<br /><h3><span style="background-color:yellow;">Answers</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">Total-14</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </h3><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">0</span> </b><br /><p><span style="background-color:yellow;">Nicer</span> <span style="background-color:yellow;">DRY</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">solve</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">actual</span> <span style="background-color:yellow;">problem</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>def message(msg):
    print msg
message.re = '^<\w+> (.*)'

def warning(msg):
    global num_warnings, num_fatals
    num_warnings += 1
    if ( is_fatal( msg ) ):
        num_fatals += 1
warning.re = '^\*{3} (.*)'

handlers = [(re.compile(x.re), x) for x in [
        message,
        warning,
        foo,
        bar,
        baz,
    ]]
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">1</span> </b><br /><p><span style="background-color:yellow;">This</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">based</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">Udi</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">nice</span> <span style="background-color:yellow;">answer</span> . </p>
<p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">think</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">difficulty</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">creating</span> <span style="background-color:yellow;">anonymous</span> <span style="background-color:yellow;">functions</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">bit</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">red</span> <span style="background-color:yellow;">herring.</span> <span style="background-color:yellow;">What</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">really</span> <span style="background-color:yellow;">want</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">keep</span> <span style="background-color:yellow;">related</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;">together</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">make</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;">neat.</span> <span style="background-color:yellow;">So</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">think</span> <span style="background-color:yellow;">decorators</span> <span style="background-color:yellow;">may</span> <span style="background-color:yellow;">work</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">you</span> . </p>
<pre><code>import re

# List of pairs (regexp, handler)
handlers = []

def handler_for(regexp):
    """Declare a function as handler for a regular expression."""
    def gethandler(f):
        handlers.append((re.compile(regexp), f))
        return f
    return gethandler

@handler_for(r'^<\w+> (.*)')
def handle_message(msg):
    print msg

@handler_for(r'^\*{3} (.*)')
def handle_warning(msg):
    global num_warnings, num_fatals
    num_warnings += 1
    if is_fatal(msg):
        num_fatals += 1
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">2</span> </b><br /><p><span style="background-color:yellow;">If</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">want</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">keep</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">clean</span> <span style="background-color:yellow;">namespace</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">del</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>def myprint(msg):
    print msg
f_list = [ myprint ]
del myprint
f_list[0]('hi')
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">3</span> </b><br /><p><span style="background-color:yellow;">Continuing</span> <span style="background-color:yellow;">Gareth</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">clean</span> <span style="background-color:yellow;">approach</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">modular</span> <span style="background-color:yellow;">self</span> <span style="background-color:yellow;">contained</span> <span style="background-color:yellow;">solution</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>import re

# in util.py
class GenericLogProcessor(object):

    def __init__(self):
      self.handlers = [] # List of pairs (regexp, handler)

    def register(self, regexp):
        """Declare a function as handler for a regular expression."""
        def gethandler(f):
            self.handlers.append((re.compile(regexp), f))
            return f
        return gethandler

    def process(self, file):
        """Process a file line by line and execute all handlers by registered regular expressions"""
        for line in file:
            for regex, handler in self.handlers:
                m = regex.search(line)
                if (m):
                  handler(m.group(1))      

# in log_processor.py
log_processor = GenericLogProcessor()

@log_processor.register(r'^<\w+> (.*)')
def handle_message(msg):
    print msg

@log_processor.register(r'^\*{3} (.*)')
def handle_warning(msg):
    global num_warnings, num_fatals
    num_warnings += 1
    if is_fatal(msg):
        num_fatals += 1

# in your code
with open("1.log") as f:
  log_processor.process(f)
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">4</span> </b><br /><p><span style="background-color:yellow;">As</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">stated</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">ca</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">done.</span> <span style="background-color:yellow;">But</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">approximate</span> <span style="background-color:yellow;">it</span> . </p>
<pre><code>def create_printer():
  def myprint(x):
    print x
  return myprint

x = create_printer()
</code></pre>
<p><span style="background-color:yellow;">myprint</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">effectively</span> <span style="background-color:yellow;">anonymous</span> <span style="background-color:yellow;">here</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">since</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">variable</span> <span style="background-color:yellow;">scope</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">was</span> <span style="background-color:yellow;">created</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">no</span> <span style="background-color:yellow;">longer</span> <span style="background-color:yellow;">accessible</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">caller.</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">See</span> <span style="background-color:yellow;">closures</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">Python</span> . <span style="background-color:yellow;"></span> </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">5</span> </b><br /><p><span style="background-color:yellow;">The</span> <span style="background-color:yellow;">only</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">make</span> <span style="background-color:yellow;">an</span> <span style="background-color:yellow;">anonymous</span> <span style="background-color:yellow;">function</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">lambda</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">know</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">they</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">only</span> <span style="background-color:yellow;">contain</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">single</span> <span style="background-color:yellow;">expression</span> . </p>
<p><span style="background-color:yellow;">You</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">create</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">number</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">functions</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">same</span> <span style="background-color:yellow;">name</span> <span style="background-color:yellow;">so</span> <span style="background-color:yellow;">at</span> <span style="background-color:yellow;">least</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">think</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">new</span> <span style="background-color:yellow;">names</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">each</span> <span style="background-color:yellow;">one</span> . </p>
<p><span style="background-color:yellow;">It</span> <span style="background-color:yellow;">would</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">great</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">truly</span> <span style="background-color:yellow;">anonymous</span> <span style="background-color:yellow;">functions</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">syntax</span> <span style="background-color:yellow;">ca</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">support</span> <span style="background-color:yellow;">them</span> <span style="background-color:yellow;">easily</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">6</span> </b><br /><p><span style="background-color:yellow;">Personally</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">'d</span> <span style="background-color:yellow;">just</span> <span style="background-color:yellow;">name</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">something</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">fret</span> <span style="background-color:yellow;">about</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">hanging</span> <span style="background-color:yellow;">around</span> <span style="background-color:yellow;">"</span> . <span style="background-color:yellow;">The</span> <span style="background-color:yellow;">only</span> <span style="background-color:yellow;">thing</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">'ll</span> <span style="background-color:yellow;">gain</span> <span style="background-color:yellow;">by</span> <span style="background-color:yellow;">using</span> <span style="background-color:yellow;">suggestions</span> <span style="background-color:yellow;">such</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">redefining</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">later</span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">using</span> <span style="background-color:yellow;">del</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">drop</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">name</span> <span style="background-color:yellow;">out</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">namespace</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">potential</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">confusion</span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">bugs</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">someone</span> <span style="background-color:yellow;">later</span> <span style="background-color:yellow;">comes</span> <span style="background-color:yellow;">along</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">moves</span> <span style="background-color:yellow;">some</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;">around</span> <span style="background-color:yellow;">without</span> <span style="background-color:yellow;">groking</span> <span style="background-color:yellow;">what</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">'re</span> <span style="background-color:yellow;">doing</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">7</span> </b><br /><p><span style="background-color:yellow;">If</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">'re</span> <span style="background-color:yellow;">concerned</span> <span style="background-color:yellow;">about</span> <span style="background-color:yellow;">polluting</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">namespace</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">create</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">functions</span> <span style="background-color:yellow;">inside</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">another</span> <span style="background-color:yellow;">function.</span> <span style="background-color:yellow;">Then</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">'re</span> <span style="background-color:yellow;">only</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">polluting</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">local</span> <span style="background-color:yellow;">namespace</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">create_functions</span> <span style="background-color:yellow;">function</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">outer</span> <span style="background-color:yellow;">namespace</span> . </p>
<pre><code>def create_functions():
    def myprint(msg):
        print msg
    return [myprint]

f_list = create_functions()
f_list[0]('hi')
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">8</span> </b><br /><p><span style="background-color:yellow;">The</span> <span style="background-color:yellow;">only</span> <span style="background-color:yellow;">option</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">lambda</span> <span style="background-color:yellow;">expression</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">like</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">mention.</span> <span style="background-color:yellow;">Without</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">possible.</span> <span style="background-color:yellow;">That</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">python</span> <span style="background-color:yellow;">works</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">9</span> </b><br /><p><span style="background-color:yellow;">As</span> <span style="background-color:yellow;">all</span> <span style="background-color:yellow;">said</span> <span style="background-color:yellow;">lambda</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">only</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">think</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">about</span> <span style="background-color:yellow;">lambda</span> <span style="background-color:yellow;">limitations</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">how</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">avoid</span> <span style="background-color:yellow;">them</span> <span style="background-color:yellow;">-</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">example</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">lists</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">dicts</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">comprehensions</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">so</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">order</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">what</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">want</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>funcs = [lambda x,y: x+y, lambda x,y: x-y, lambda x,y: x*y, lambda x: x]
funcs[0](1,2)
>>> 3
funcs[1](funcs[0](1,2),funcs[0](2,2))
>>> -1
[func(x,y) for x,y in zip(xrange(10),xrange(10,20)) for func in funcs]
</code></pre>
<p><span style="background-color:yellow;">EDITED</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">print</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">try</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">look</span> <span style="background-color:yellow;">at</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">pprint</span> <span style="background-color:yellow;">module</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">control-flow</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>add = True
(funcs[0] if add else funcs[1])(1,2)
>>> 3

from pprint import pprint
printMsg = lambda isWarning, msg: pprint('WARNING: ' + msg) if isWarning else pprint('MSG:' + msg)
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">10</span> </b><br /><p><span style="background-color:yellow;">You</span> <span style="background-color:yellow;">should</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">cause</span> <span style="background-color:yellow;">eval</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">evil</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">compile</span> <span style="background-color:yellow;">function</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">run</span> <span style="background-color:yellow;">time</span> <span style="background-color:yellow;">using</span> <span style="background-color:yellow;">FunctionType</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">compile</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>>>> def f(msg): print msg
>>> type(f)
 <type 'function'>
>>> help(type(f))
...
class function(object)
 |  function(code, globals[, name[, argdefs[, closure]]])
 |
 |  Create a function object from a code object and a dictionary.
 |  The optional name string overrides the name from the code object.
 |  The optional argdefs tuple specifies the default argument values.
 |  The optional closure tuple supplies the bindings for free variables.    
...

>>> help(compile)
Help on built-in function compile in module __builtin__:

compile(...)
    compile(source, filename, mode[, flags[, dont_inherit]]) -> code object

    Compile the source string (a Python module, statement or expression)
    into a code object that can be executed by the exec statement or eval().
    The filename will be used for run-time error messages.
    The mode must be 'exec' to compile a module, 'single' to compile a
    single (interactive) statement, or 'eval' to compile an expression.
    The flags argument, if present, controls which future statements influence
    the compilation of the code.
    The dont_inherit argument, if non-zero, stops the compilation inheriting
    the effects of any future statements in effect in the code calling
    compile; if absent or zero these statements do influence the compilation,
    in addition to any features explicitly specified.
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">11</span> </b><br /><p><span style="background-color:yellow;">You</span> <span style="background-color:yellow;">could</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">exec</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>def define(arglist, body):
    g = {}
    exec("def anonfunc({0}):\n{1}".format(arglist,
                                     "\n".join("    {0}".format(line)
                                               for line in body.splitlines())), g)
    return g["anonfunc"]

f_list = [define("msg", "print(msg)")]
f_list[0]('hi')
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">12</span> </b><br /><p><span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">really</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">really</span> <span style="background-color:yellow;">does</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">want</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">this.</span> <span style="background-color:yellow;">Not</span> <span style="background-color:yellow;">only</span> <span style="background-color:yellow;">does</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">any</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">define</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">multi-line</span> <span style="background-color:yellow;">anonymous</span> <span style="background-color:yellow;">function</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">function</span> <span style="background-color:yellow;">definitions</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">return</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">function</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">so</span> <span style="background-color:yellow;">even</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">were</span> <span style="background-color:yellow;">syntactically</span> <span style="background-color:yellow;">valid..</span> . </p>
<pre><code>mylist.sort(key=def _(v):
                    try:
                        return -v
                    except:
                        return None)
</code></pre>
<p><span style="background-color:yellow;">...</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">still</span> <span style="background-color:yellow;">would</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">work.</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">Although</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">guess</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">were</span> <span style="background-color:yellow;">syntactically</span> <span style="background-color:yellow;">valid</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">they</span> <span style="background-color:yellow;">'d</span> <span style="background-color:yellow;">make</span> <span style="background-color:yellow;">function</span> <span style="background-color:yellow;">definitions</span> <span style="background-color:yellow;">return</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">function</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">so</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">would</span> <span style="background-color:yellow;">work.</span> <span style="background-color:yellow;"></span> </p>
<p><span style="background-color:yellow;">So</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">write</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">own</span> <span style="background-color:yellow;">function</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">make</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">function</span> <span style="background-color:yellow;">from</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">string</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">using</span> <span style="background-color:yellow;">exec</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">course</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">pass</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">triply-quoted</span> <span style="background-color:yellow;">string.</span> <span style="background-color:yellow;">It</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">kinda</span> <span style="background-color:yellow;">ugly</span> <span style="background-color:yellow;">syntactically</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">works</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>def function(text, cache={}):

    # strip everything before the first paren in case it's "def foo(...):"
    if not text.startswith("("):
        text = text[text.index("("):]

    # keep a cache so we don't recompile the same func twice
    if text in cache:
        return cache[text]

    exec "def func" + text
    func.__name__ = "<anonymous>"

    cache[text] = func
    return func

    # never executed; forces func to be local (a tiny bit more speed)
    func = None
</code></pre>
<p><span style="background-color:yellow;">Usage</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>mylist.sort(key=function("""(v):
                                try:
                                    return -v
                                except:
                                    return None"""))
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">13</span> </b><br /><p><span style="background-color:yellow;">If</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">function</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">complicated</span> <span style="background-color:yellow;">enough</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">fit</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">lambda</span> <span style="background-color:yellow;">function</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">then</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">readability</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">sake</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">would</span> <span style="background-color:yellow;">probably</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">best</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">define</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">normal</span> <span style="background-color:yellow;">block</span> <span style="background-color:yellow;">anyway</span> . </p>
<br />