<h3><span style="background-color:yellow;">Question</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">ID-6770002</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </h3><h2><span style="background-color:yellow;">Looking</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">more</span> <span style="background-color:yellow;">pythonic</span> <span style="background-color:yellow;">list</span> <span style="background-color:yellow;">comparison</span> <span style="background-color:yellow;">solution</span> </h2><p><span style="background-color:yellow;">Ok</span> <span style="background-color:yellow;">so</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">two</span> <span style="background-color:yellow;">lists</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>x = [1, 2, 3, 4]
y = [1, 1, 2, 5, 6]
</code></pre>
<p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">compare</span> <span style="background-color:yellow;">them</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">such</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">so</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">get</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">following</span> <span style="background-color:yellow;">output</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>x = [3, 4]
y = [1, 5, 6]
</code></pre>
<p><span style="background-color:yellow;">The</span> <span style="background-color:yellow;">basic</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">idea</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">go</span> <span style="background-color:yellow;">through</span> <span style="background-color:yellow;">each</span> <span style="background-color:yellow;">list</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">compare</span> <span style="background-color:yellow;">them.</span> <span style="background-color:yellow;">If</span> <span style="background-color:yellow;">they</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">an</span> <span style="background-color:yellow;">element</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">common</span> <span style="background-color:yellow;">remove</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">element.</span> <span style="background-color:yellow;">But</span> <span style="background-color:yellow;">only</span> <span style="background-color:yellow;">one</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">element</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">all</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">them.</span> <span style="background-color:yellow;">If</span> <span style="background-color:yellow;">they</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">an</span> <span style="background-color:yellow;">element</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">common</span> <span style="background-color:yellow;">leave</span> <span style="background-color:yellow;">it.</span> <span style="background-color:yellow;">Two</span> <span style="background-color:yellow;">identical</span> <span style="background-color:yellow;">lists</span> <span style="background-color:yellow;">would</span> <span style="background-color:yellow;">become</span> <span style="background-color:yellow;">x</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">y</span> <span style="background-color:yellow;">=</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">]</span> </p>
<p><span style="background-color:yellow;">Here</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">my</span> <span style="background-color:yellow;">rather</span> <span style="background-color:yellow;">hacked</span> <span style="background-color:yellow;">up</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">pretty</span> <span style="background-color:yellow;">lame</span> <span style="background-color:yellow;">solution.</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">hoping</span> <span style="background-color:yellow;">other</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">recommend</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">better</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">/</span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">more</span> <span style="background-color:yellow;">pythonic</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">doing</span> <span style="background-color:yellow;">this.</span> <span style="background-color:yellow;">3</span> <span style="background-color:yellow;">loops</span> <span style="background-color:yellow;">seems</span> <span style="background-color:yellow;">excessive..</span> . </p>
<pre><code>    done = True

    while not done:
        done = False
        for x in xlist:
            for y in ylist:
                if x == y:
                    xlist.remove(x)
                    ylist.remove(y)
                    done = False
        print xlist, ylist
</code></pre>
<p><span style="background-color:yellow;">Thanks</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">always</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">taking</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">time</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">read</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">question.</span> <span style="background-color:yellow;">XOXO</span> </p>
<br /><h3><span style="background-color:yellow;">Answers</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">Total-6</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </h3><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">0</span> </b><br /><p><span style="background-color:yellow;">It</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">possible</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">data</span> <span style="background-color:yellow;">structure</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">looking</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">multiset</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">bag</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">so</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">good</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">implement</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">collections.Counter</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>>>> from collections import Counter
>>> x = Counter([1, 2, 3, 4])
>>> y = Counter([1, 1, 2, 5, 6])
>>> x - y
Counter({3: 1, 4: 1})
>>> y - x
Counter({1: 1, 5: 1, 6: 1})
</code></pre>
<p><span style="background-color:yellow;">If</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">want</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">convert</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">Counter</span> <span style="background-color:yellow;">objects</span> <span style="background-color:yellow;">back</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">lists</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">multiplicity</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">elements</span> <span style="background-color:yellow;">method</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>>>> list((x - y).elements())
[3, 4]
>>> list((y - x).elements())
[1, 5, 6]
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">1</span> </b><br /><p><span style="background-color:yellow;">To</span> <span style="background-color:yellow;">build</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">Gareth</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">answer</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>>>> a = Counter([1, 2, 3, 4])
>>> b = Counter([1, 1, 2, 5, 6])
>>> (a - b).elements()
[3, 4]
>>> (b - a).elements()
[1, 5, 6]
</code></pre>
<p><span style="background-color:yellow;">Benchmark</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>from collections import Counter
from collections import defaultdict
import random

# short lists
#a = [1, 2, 3, 4, 7, 8, 9]
#b = [1, 1, 2, 5, 6, 8, 8, 10]

# long lists
a = []
b = []

for i in range(0, 1000):
    q = random.choice((1, 2, 3, 4))
    if q == 1:
        a.append(i)
    elif q == 2:
        b.append(i)
    elif q == 3:
        a.append(i)
        b.append(i)
    else:
        a.append(i)
        b.append(i)
        b.append(i)

# Modifies the lists in-place! Naughty! And it doesn't actually work, to boot.
def original(xlist, ylist):
    done = False

    while not done:
        done = True
        for x in xlist:
            for y in ylist:
                if x == y:
                    xlist.remove(x)
                    ylist.remove(y)
                    done = False
    return xlist, ylist # not strictly necessary, see above


def counter(xlist, ylist):
    x = Counter(xlist)
    y = Counter(ylist)
    return ((x-y).elements(), (y-x).elements())


def nasty(xlist, ylist):
    x = sum(([i]*(xlist.count(i)-ylist.count(i)) for i in set(xlist)),[])
    y = sum(([i]*(ylist.count(i)-xlist.count(i)) for i in set(ylist)),[])

    return x, y


def gnibbler(xlist, ylist):
    d = defaultdict(int)
    for i in xlist: d[i] += 1
    for i in ylist: d[i] -= 1
    return [k for k,v in d.items() for i in range(v)], [k for k,v in d.items() for i in range(-v)]

# substitute algorithm to test in the call
for x in range(0, 100000):
    original(list(a), list(b))
</code></pre>
<p><span style="background-color:yellow;">Running</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">Insufficiently</span> <span style="background-color:yellow;">Rigorous</span> <span style="background-color:yellow;">Benchmarks</span> <span style="background-color:yellow;">[</span> <span style="background-color:yellow;">tm</span> <span style="background-color:yellow;">]</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">short</span> <span style="background-color:yellow;">lists</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">original</span> <span style="background-color:yellow;">ones</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">long</span> <span style="background-color:yellow;">lists</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">randomly</span> <span style="background-color:yellow;">generated</span> <span style="background-color:yellow;">lists</span> <span style="background-color:yellow;">approximately</span> <span style="background-color:yellow;">1000</span> <span style="background-color:yellow;">entries</span> <span style="background-color:yellow;">long</span> <span style="background-color:yellow;">with</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">mix</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">matches</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">repeats</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">times</span> <span style="background-color:yellow;">given</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">multipliers</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">Original</span> <span style="background-color:yellow;">algorithm</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </p>
<pre><code>    100K iterations, short lists    1K iterations, long lists
Original     1.0                           1.0
Counter      9.3                           0.06
Nasty        2.9                           1.4
Gnibbler     2.4                           0.02
</code></pre>
<p><span style="background-color:yellow;">Note</span> <span style="background-color:yellow;">1</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">The</span> <span style="background-color:yellow;">creation</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">Counter</span> <span style="background-color:yellow;">object</span> <span style="background-color:yellow;">seems</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">overshadow</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">actual</span> <span style="background-color:yellow;">algorithm</span> <span style="background-color:yellow;">at</span> <span style="background-color:yellow;">small</span> <span style="background-color:yellow;">list</span> <span style="background-color:yellow;">sizes</span> . </p>
<p><span style="background-color:yellow;">Note</span> <span style="background-color:yellow;">2</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">Original</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">gnibbler</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">same</span> <span style="background-color:yellow;">at</span> <span style="background-color:yellow;">list</span> <span style="background-color:yellow;">lengths</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">approximately</span> <span style="background-color:yellow;">35</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">above</span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">gnibbler</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">Counter</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">faster</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">2</span> </b><br /><p><span style="background-color:yellow;">If</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">care</span> <span style="background-color:yellow;">about</span> <span style="background-color:yellow;">order</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">collections.Counter</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">one</span> <span style="background-color:yellow;">line</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>>>> Counter(x)-Counter(y)
Counter({3: 1, 4: 1})

>>> Counter(y)-Counter(x)
Counter({1: 1, 5: 1, 6: 1})
</code></pre>
<p><span style="background-color:yellow;">If</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">care</span> <span style="background-color:yellow;">about</span> <span style="background-color:yellow;">order</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">probably</span> <span style="background-color:yellow;">iterate</span> <span style="background-color:yellow;">through</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">lists</span> <span style="background-color:yellow;">grabbing</span> <span style="background-color:yellow;">elements</span> <span style="background-color:yellow;">from</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">above</span> <span style="background-color:yellow;">dictionaries</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>def prune(seq, toPrune):
    """Prunes elements from front of seq in O(N) time"""
    remainder = Counter(seq)-Counter(toPrune)
    R = []
    for x in reversed(seq):
        if remainder.get(x):
            remainder[x] -= 1
            R.insert(0,x)
    return R
</code></pre>
<p><span style="background-color:yellow;">Demo</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>>>> prune(x,y)
[3, 4]
>>> prune(y,x)
[1, 1, 5, 6]
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">3</span> </b><br /><p><span style="background-color:yellow;">Just</span> <span style="background-color:yellow;">using</span> <span style="background-color:yellow;">collections.defaultdict</span> <span style="background-color:yellow;">so</span> <span style="background-color:yellow;">will</span> <span style="background-color:yellow;">work</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">Python2.5</span> <span style="background-color:yellow;">+</span> </p>
<pre><code>>>> x = [1, 2, 3, 4]
>>> y = [1, 1, 2, 5, 6]
>>> from collections import defaultdict
>>> d = defaultdict(int)
>>> for i in x:
...  d[i] += 1
... 
>>> for i in y:
...  d[i] -= 1
... 
>>> [k for k,v in d.items() for i in range(v)]
[3, 4]
>>> [k for k,v in d.items() for i in range(-v)]
[1, 5, 6]
</code></pre>
<p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">find</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">better</span> <span style="background-color:yellow;">than</span> <span style="background-color:yellow;">range</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">xrange</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">number</span> <span style="background-color:yellow;">repetitions</span> <span style="background-color:yellow;">get</span> <span style="background-color:yellow;">large</span> </p>
<pre><code>>>> from itertools import repeat
>>> [k for k,v in d.items() for i in repeat(None, v)]
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">4</span> </b><br /><p><span style="background-color:yellow;">Quite</span> <span style="background-color:yellow;">nasty</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">P</span> </p>
<pre><code>a = sum(([i]*(x.count(i)-y.count(i)) for i in set(x)),[])
b = sum(([i]*(y.count(i)-x.count(i)) for i in set(y)),[])

x,y = a,b
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">5</span> </b><br /><p><span style="background-color:yellow;">This</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">simple</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">dont</span> <span style="background-color:yellow;">care</span> <span style="background-color:yellow;">about</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">duplicates</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>>>> x=[1,2,3,4]
>>> y=[1,1,2,5,6]
>>> list(set(x).difference(set(y)))
[3, 4]
>>> list(set(y).difference(set(x)))
[5, 6]
</code></pre>
<br />