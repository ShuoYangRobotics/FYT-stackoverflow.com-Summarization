<h3><span style="background-color:yellow;">Question</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">ID-1322068</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </h3><h2><span style="background-color:yellow;">How</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">determinate</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">Is</span> <span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">variable</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">instance</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">built-in</span> <span style="background-color:yellow;">type</span> ? </h2><p><span style="background-color:yellow;">I</span> <span style="background-color:yellow;">need</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">determinate</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">variable</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">instance</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">native</span> <span style="background-color:yellow;">type</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">str</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">int</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">float</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">bool</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">list</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">dict</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">so</span> <span style="background-color:yellow;">on.</span> <span style="background-color:yellow;">Is</span> <span style="background-color:yellow;">there</span> <span style="background-color:yellow;">elegant</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">doing</span> <span style="background-color:yellow;">it</span> ? <span style="background-color:yellow;">Or</span> </p>
<pre><code>if myvar in (str, int, float, bool):
</code></pre>
<p><span style="background-color:yellow;">are</span> <span style="background-color:yellow;">only</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">it</span> ? </p>
<br /><h3><span style="background-color:yellow;">Answers</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">Total-6</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">:</span> </h3><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">0</span> </b><br /><p><span style="background-color:yellow;">You</span> <span style="background-color:yellow;">appear</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">interested</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">assuring</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">simplejson</span> <span style="background-color:yellow;">will</span> <span style="background-color:yellow;">handle</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">types.</span> <span style="background-color:yellow;">This</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">done</span> <span style="background-color:yellow;">trivially</span> <span style="background-color:yellow;">by</span> </p>
<pre><code>try:
    json.dumps( object )
except TypeError:
    print "Can't convert", object
</code></pre>
<p><span style="background-color:yellow;">Which</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">more</span> <span style="background-color:yellow;">reliable</span> <span style="background-color:yellow;">than</span> <span style="background-color:yellow;">trying</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">guess</span> <span style="background-color:yellow;">which</span> <span style="background-color:yellow;">types</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">JSON</span> <span style="background-color:yellow;">implementation</span> <span style="background-color:yellow;">handles</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">1</span> </b><br /><p><span style="background-color:yellow;">The</span> <span style="background-color:yellow;">types</span> <span style="background-color:yellow;">module</span> <span style="background-color:yellow;">contains</span> <span style="background-color:yellow;">all</span> <span style="background-color:yellow;">types</span> . </p>
<p><span style="background-color:yellow;">Just</span> <span style="background-color:yellow;">put</span> <span style="background-color:yellow;">all</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">ones</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">want</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">list</span> <span style="background-color:yellow;">or</span> <span style="background-color:yellow;">tuple</span> <span style="background-color:yellow;">primitiveTypes</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>if type(myvar) in primitiveTypes:
    ...
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">2</span> </b><br /><p><span style="background-color:yellow;">What</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">native</span> <span style="background-color:yellow;">type</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">Python</span> ? <span style="background-color:yellow;">Please</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">base</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">types</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">Duck</span> <span style="background-color:yellow;">Typing</span> . </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">3</span> </b><br /><p><span style="background-color:yellow;">Not</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">I</span> <span style="background-color:yellow;">know</span> <span style="background-color:yellow;">why</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">would</span> <span style="background-color:yellow;">want</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">there</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">any</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">simple</span> <span style="background-color:yellow;">"</span> <span style="background-color:yellow;">types</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">Python</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">all</span> <span style="background-color:yellow;">objects.</span> <span style="background-color:yellow;">But</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">works</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>type(theobject).__name__ in dir(__builtins__)
</code></pre>
<p><span style="background-color:yellow;">But</span> <span style="background-color:yellow;">explicitly</span> <span style="background-color:yellow;">listing</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">types</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">probably</span> <span style="background-color:yellow;">better</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">clearer.</span> <span style="background-color:yellow;">Or</span> <span style="background-color:yellow;">even</span> <span style="background-color:yellow;">better</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">Changing</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">application</span> <span style="background-color:yellow;">so</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">n't</span> <span style="background-color:yellow;">need</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">know</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">difference</span> . </p>
<p><span style="background-color:yellow;">Update</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;">The</span> <span style="background-color:yellow;">problem</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">needs</span> <span style="background-color:yellow;">solving</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">how</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">make</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">serializer</span> <span style="background-color:yellow;">for</span> <span style="background-color:yellow;">objects</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">even</span> <span style="background-color:yellow;">those</span> <span style="background-color:yellow;">built-in.</span> <span style="background-color:yellow;">The</span> <span style="background-color:yellow;">best</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">do</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">not</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">make</span> <span style="background-color:yellow;">a</span> <span style="background-color:yellow;">big</span> <span style="background-color:yellow;">phat</span> <span style="background-color:yellow;">serializer</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">treats</span> <span style="background-color:yellow;">builtins</span> <span style="background-color:yellow;">differently</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">but</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">look</span> <span style="background-color:yellow;">up</span> <span style="background-color:yellow;">serializers</span> <span style="background-color:yellow;">based</span> <span style="background-color:yellow;">on</span> <span style="background-color:yellow;">type</span> . </p>
<p><span style="background-color:yellow;">Something</span> <span style="background-color:yellow;">like</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>def IntSerializer(theint):
    return str(theint)

def StringSerializer(thestring):
    return repr(thestring)

def MyOwnSerializer(value):
    return "whatever"

serializers = {
    int: IntSerializer,
    str: StringSerializer,
    mymodel.myclass: MyOwnSerializer,
}

def serialize(ob):
    try:
        return ob.serialize() #For objects that know they need to be serialized
    except AttributeError:
        # Look up the serializer amongst the serializer based on type.
        # Default to using "repr" (works for most builtins).
        return serializers.get(type(ob), repr)(ob)
</code></pre>
<p><span style="background-color:yellow;">This</span> <span style="background-color:yellow;">way</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">easily</span> <span style="background-color:yellow;">add</span> <span style="background-color:yellow;">new</span> <span style="background-color:yellow;">serializers</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">code</span> <span style="background-color:yellow;">is</span> <span style="background-color:yellow;">easy</span> <span style="background-color:yellow;">to</span> <span style="background-color:yellow;">maintain</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">clear</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">as</span> <span style="background-color:yellow;">each</span> <span style="background-color:yellow;">type</span> <span style="background-color:yellow;">has</span> <span style="background-color:yellow;">its</span> <span style="background-color:yellow;">own</span> <span style="background-color:yellow;">serializer.</span> <span style="background-color:yellow;">Notice</span> <span style="background-color:yellow;">how</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">fact</span> <span style="background-color:yellow;">that</span> <span style="background-color:yellow;">some</span> <span style="background-color:yellow;">types</span> <span style="background-color:yellow;">are</span> <span style="background-color:yellow;">builtin</span> <span style="background-color:yellow;">became</span> <span style="background-color:yellow;">completely</span> <span style="background-color:yellow;">irrelevant.</span> <span style="background-color:yellow;">:</span> <span style="background-color:yellow;"></span> </p>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">4</span> </b><br /><p><span style="background-color:yellow;">Built</span> <span style="background-color:yellow;">in</span> <span style="background-color:yellow;">type</span> <span style="background-color:yellow;">function</span> <span style="background-color:yellow;">may</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">helpful</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>>>> a = 5
>>> type(a)
<type 'int'>
</code></pre>
<br /><b><span style="background-color:yellow;">#</span> <span style="background-color:yellow;">5</span> </b><br /><p><span style="background-color:yellow;">building</span> <span style="background-color:yellow;">off</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">S.Lott</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">answer</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">should</span> <span style="background-color:yellow;">have</span> <span style="background-color:yellow;">something</span> <span style="background-color:yellow;">like</span> <span style="background-color:yellow;">this</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>
from simplejson import JSONEncoder

class JSONEncodeAll(JSONEncoder):
  def default(self, obj):
    try:
      return JSONEncoder.default(self, obj)
    except TypeError:
      ## optionally
      # try:
      #   # you'd have to add this per object, but if an object wants to do something
      #   # special then it can do whatever it wants
      #   return obj.__json__()
      # except AttributeError:
      ##

      # ...do whatever you are doing now...
      # (which should be creating an object simplejson understands)
</code></pre>
<p><span style="background-color:yellow;">to</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">:</span> </p>
<pre><code>
>>> json = JSONEncodeAll()

>>> json.encode(myObject)
# whatever myObject looks like when it passes through your serialization code
</code></pre>
<p><span style="background-color:yellow;">these</span> <span style="background-color:yellow;">calls</span> <span style="background-color:yellow;">will</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">special</span> <span style="background-color:yellow;">class</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">simplejson</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">take</span> <span style="background-color:yellow;">care</span> <span style="background-color:yellow;">of</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">object</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">will.</span> <span style="background-color:yellow;">Otherwise</span> <span style="background-color:yellow;">your</span> <span style="background-color:yellow;">catchall</span> <span style="background-color:yellow;">functionality</span> <span style="background-color:yellow;">will</span> <span style="background-color:yellow;">be</span> <span style="background-color:yellow;">triggered</span> <span style="background-color:yellow;">,</span> <span style="background-color:yellow;">and</span> <span style="background-color:yellow;">possibly</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">depending</span> <span style="background-color:yellow;">if</span> <span style="background-color:yellow;">you</span> <span style="background-color:yellow;">use</span> <span style="background-color:yellow;">the</span> <span style="background-color:yellow;">optional</span> <span style="background-color:yellow;">part</span> <span style="background-color:yellow;"></span> <span style="background-color:yellow;">an</span> <span style="background-color:yellow;">object</span> <span style="background-color:yellow;">can</span> <span style="background-color:yellow;">define</span> <span style="background-color:yellow;">it</span> <span style="background-color:yellow;">'s</span> <span style="background-color:yellow;">own</span> <span style="background-color:yellow;">serialization</span> </p>
<br />