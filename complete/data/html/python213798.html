<h3>Question (ID-213798):</h3><h2>Would Python make a good substitute for the Windows command-line/batch scripts?</h2><p>I've got some experience with <a href="http://en.wikipedia.org/wiki/Bash_%28Unix_shell%29" rel="nofollow">Bash</a>, which I don't mind, but now that I'm doing a lot of Windows development I'm needing to do basic stuff/write basic scripts using 
the Windows command-line language. For some reason said language really irritates me, so I was considering learning Python and using that instead.</p>

<p>Is Python suitable for such things? Moving files around, creating scripts to do things like unzipping a backup and restoring a SQL database, etc.</p>
<br /><h3>Answers (Total-12):</h3><b>#0</b><br /><p>Python is well suited for these tasks, and I would guess much easier to develop in and debug than Windows batch files.</p>

<p>The question is, I think, how easy and painless it is to ensure that all the computers that you have to run these scripts on, have Python installed.</p>
<br /><b>#1</b><br /><p>Sure, python is a pretty good choice for those tasks (I'm sure many will recommend PowerShell instead).</p>

<p>Here is a fine introduction from that point of view:</p>

<p><a href="http://www.redhatmagazine.com/2008/02/07/python-for-bash-scripters-a-well-kept-secret/" rel="nofollow">http://www.redhatmagazine.com/2008/02/07/python-for-bash-scripters-a-well-kept-secret/</a></p>

<p>EDIT: About gnud's concern: <a href="http://www.portablepython.com/" rel="nofollow">http://www.portablepython.com/</a></p>
<br /><b>#2</b><br /><h2>Summary</h2>

<p><strong>Windows</strong>: no need to think, use Python.
<strong>Unix</strong>: quick or run-it-once scripts are for Bash, serious and/or long life time scripts are for Python.</p>

<h2>The big talk</h2>

<p>In a Windows environment, Python is definitely the best choice since <a href="http://en.wikipedia.org/wiki/Command_Prompt" rel="nofollow">cmd</a> is crappy and PowerShell has not really settled yet. What's more Python can run on several platform so it's a better investment. Finally, Python has a huge set of library so you will almost never hit the "god-I-can't-do-that" wall. This is not true for cmd and PowerShell.</p>

<p>In a Linux environment, this is a bit different. A lot of one liners are shorter, faster, more efficient and often more readable in pure Bash. But if you know your quick and dirty script is going to stay around for a while or will need to be improved, go for Python since it's far easier to maintain and extend and <a href="http://www.google.fr/url?sa=t&amp;source=web&amp;ct=res&amp;cd=2&amp;url=http%3A%2F%2Fwww.dabeaz.com%2Fgenerators%2FGenerators.pdf&amp;ei=yRn7SJDYCIbS0QXFvq2JDw&amp;usg=AFQjCNE6b1w4feELQFUppm2-GFCzYyd2UQ&amp;sig2=nUjS8CM2Pd77W_HXUq4tRw" rel="nofollow">you will be able to do most of the task you can do with GNU tools with the standard library</a>. And if you can't, you can still call the command-line from a Python script.</p>

<p>And of course you can call Python from the shell using -c option:</p>

<pre><code>python -c  "for line in open('/etc/fstab') : print line"
</code></pre>

<p>Some more literature about Python used for system administration tasks:</p>

<ul>
<li><p><a href="http://www.ibm.com/developerworks/aix/library/au-python/" rel="nofollow">The IBM lab point of view</a>.</p></li>
<li><p><a href="http://www.unixreview.com/documents/s=9083/sam0401d/" rel="nofollow">A nice example to compare bash and python to script report</a>.</p></li>
<li><p><a href="http://www.samag.com/documents/s=8964/sam0312a/0312a.htm" rel="nofollow">The basics</a>.</p></li>
<li><p><a href="http://rads.stackoverflow.com/amzn/click/0596515820" rel="nofollow">The must-have book</a>.</p></li>
</ul>
<br /><b>#3</b><br /><p>Are you aware of <a href="http://www.microsoft.com/windowsserver2003/technologies/management/powershell/default.mspx" rel="nofollow">PowerShell</a>?</p>
<br /><b>#4</b><br /><p>@BKB definitely has a valid concern. Here's a couple links you'll want to check if you run into any issues that can't be solved with the standard library:</p>

<ul>
<li><a href="http://sourceforge.net/projects/pywin32/" rel="nofollow">Pywin32</a> is a package for working with low-level win32 APIs (advanced file system modifications, COM interfaces, etc.)</li>
<li><a href="http://timgolden.me.uk/python/" rel="nofollow">Tim Golden's Python page</a>: he maintains a WMI wrapper package that builds off of Pywin32, but be sure to also check out his <a href="http://timgolden.me.uk/python/win32_how_do_i.html" rel="nofollow">"Win32 How Do I"</a> page for details on how to accomplish typical Windows tasks in Python.</li>
</ul>
<br /><b>#5</b><br /><p>Anything is a good replacement for the Batch file system in windows.  Perl, Python, Powershell are all good choices.</p>
<br /><b>#6</b><br /><p>Python is certainly well suited to that. If you're going down that road, you might also want to investigate <a href="http://scons.org" rel="nofollow">SCons</a> which is a build system itself built with Python. The cool thing is the build scripts are actually full-blown Python scripts themselves, so you can do anything in the build script that you could otherwise do in Python. It makes <code>make</code> look pretty anemic in comparison.</p>

<p>Upon rereading your question, I should note that SCons is more suited to building software projects than to writing system maintenance scripts. But I wouldn't hesitate to recommend Python to you in any case.</p>
<br /><b>#7</b><br /><p>Python, along with <a href="http://sourceforge.net/projects/pywin32/" rel="nofollow">Pywin32</a>, would be fine for Windows automation.  However, VBScript or JScript used with the Winows Scripting Host works just as well, and requires nothing additional to install.</p>
<br /><b>#8</b><br /><p>I've been using a lot of <a href="http://msdn.microsoft.com/en-us/library/15x4407c.aspx" rel="nofollow">Windows Script Files</a> lately. More powerful than batch scripts, and since it uses Windows scripting, there's nothing to install.</p>
<br /><b>#9</b><br /><p>I've done a decent amount of scripting in both Linux/Unix and Windows environments, in Python, Perl, batch files, Bash, etc. My advice is that if it's possible, install Cygwin and use Bash (it sounds from your description like installing a scripting language or env isn't a problem?). You'll be more comfortable with that since the transition is minimal.</p>

<p>If that's not an option, then here's my take. Batch files are very kludgy and limited, but make a lot of sense for simple tasks like 'copy some files' or 'restart this service'. Python will be cleaner, easier to maintain, and much more powerful. However, the downside is that either you end up calling external applications from Python with subprocess, popen or similar. Otherwise, you end up writing a bunch more code to do things that are comparatively simple in batch files, like copying a folder full of files. A lot of this depends on what your scripts are doing. Text/string processing is going to be much cleaner in Python, for example.</p>

<p>Lastly, it's probably not an attractive alternative, but you might also  consider VBScript as an alternative. I don't enjoy working with it as a language personally, but if portability is any kind of concern then it wins out by virtue of being available out of the box in any copy of Windows. Because of this I've found myself writing scripts that were unwieldy as batch files in VBScript instead, since I can't usually depend on Python or Perl or Bash being available on Windows.</p>
<br /><b>#10</b><br /><p>As a follow up, after some experimentation the thing I've found Python most useful for is any situation involving text manipulation (yourStringHere.replace(), regexes for more complex stuff) or testing some basic concept really quickly, which it is excellent for.</p>

<p>For stuff like SQL DB restore scripts I find I still usually just resort to batch files, as it's usually either something short enough that it actually takes more Python code to make the appropriate system calls or I can reuse snippets of code from other people reducing the writing time to just enough to tweak existing code to fit my needs.</p>

<p>As an addendum I would highly recommend <a href="http://ipython.scipy.org/" rel="nofollow">IPython</a> as a great interactive shell complete with tab completion and easy docstring access.</p>
<br /><b>#11</b><br /><p>As much as I love python, I don't think it a good choice to replace basic windows batch scripts. </p>

<p>I can't see see someone having to import modules like sys, os or getopt to do basic things you can do with shell like call a program, check environment variable or an argument.</p>

<p>Also, in my experience, goto is much easier to understand to most sysadmins than a function call.</p>
<br />