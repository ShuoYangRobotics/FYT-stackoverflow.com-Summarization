<h3>Question (ID-2397295):</h3><h2>Web scraping with Python</h2><p>I'm currently trying to scrape a website that has fairly poorly-formatted HTML (often missing closing tags, no use of classes or ids so it's incredibly difficult to go straight to the element you want, etc.).  I've been using BeautifulSoup with some success so far but every once and a while (though quite rarely), I run into a page where BeautifulSoup creates the HTML tree a bit differently from (for example) Firefox or Webkit.  While this is understandable as the formatting of the HTML leaves this ambiguous, if I were able to get the same parse tree as Firefox or Webkit produces I would be able to parse things much more easily.
The problems are usually something like the site opens a <code>&lt;b&gt;</code> tag twice and when BeautifulSoup sees the second <code>&lt;b&gt;</code> tag, it immediately closes the first while Firefox and Webkit nest the <code>&lt;b&gt;</code> tags.</p>

<p>Is there a web scraping library for Python (or even any other language (I'm getting desperate)) that can reproduce the parse tree generated by Firefox or WebKit (or at least get closer than BeautifulSoup in cases of ambiguity).</p>
<br /><h3>Answers (Total-9):</h3><b>#0</b><br /><p>Use <a href="http://www.crummy.com/software/BeautifulSoup/" rel="nofollow"><code>BeautifulSoup</code></a> as a tree builder for <a href="http://code.google.com/p/html5lib/" rel="nofollow"><code>html5lib</code></a>:</p>

<pre><code>from html5lib import HTMLParser, treebuilders

parser = HTMLParser(tree=treebuilders.getTreeBuilder("beautifulsoup"))

text = "a&lt;b&gt;b&lt;b&gt;c"
soup = parser.parse(text)
print soup.prettify()
</code></pre>

<p>Output:</p>

<pre><code>&lt;html&gt;
 &lt;head&gt;
 &lt;/head&gt;
 &lt;body&gt;
  a
  &lt;b&gt;
   b
   &lt;b&gt;
    c
   &lt;/b&gt;
  &lt;/b&gt;
 &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<br /><b>#1</b><br /><p>You can drive a browser of your choice with <a href="http://seleniumhq.org/projects/remote-control/" rel="nofollow">SeleniumRC</a>.</p>
<br /><b>#2</b><br /><p>You may want to take a look at Mechanize module:</p>

<p><a href="http://wwwsearch.sourceforge.net/mechanize/" rel="nofollow">http://wwwsearch.sourceforge.net/mechanize/</a></p>
<br /><b>#3</b><br /><p><a href="http://code.google.com/p/pywebkitgtk/source/checkout" rel="nofollow">pyWebKitGTK</a> looks like it might be of some help.</p>

<p>Also here is a dude that had to do the same thing but get the export of the content after javascript ran, <a href="http://blog.motane.lu/2009/06/18/pywebkitgtk-execute-javascript-from-python/" rel="nofollow">execute javascript from python using pyWebKitGTK</a>.</p>

<p>pyWebkitGTK at the <a href="http://wiki.python.org/moin/PyWebkitGtk" rel="nofollow">cheeseshop</a>.</p>

<p>You can also <a href="http://blog.motane.lu/2009/07/07/downloading-a-pages-content-with-python-and-webkit/" rel="nofollow">do this with pyQt</a>.</p>
<br /><b>#4</b><br /><p>Well, WebKit is open source so you could use its own parser (in the WebCore component), if any language is acceptable</p>
<br /><b>#5</b><br /><p>Ian Bicking once wrote that surprisingly lxml could be better at parsing soups than BeautifulSoup: <a href="http://blog.ianbicking.org/2008/12/10/lxml-an-underappreciated-web-scraping-library/" rel="nofollow">http://blog.ianbicking.org/2008/12/10/lxml-an-underappreciated-web-scraping-library/</a> (Just mentioning for reference, haven't tried that personally)</p>
<br /><b>#6</b><br /><p>have you tried <a href="http://scrapy.org/" rel="nofollow">scrapy</a>? </p>

<blockquote>
  <p>Scrapy is a fast high-level screen
  scraping and web crawling framework,
  used to crawl websites and extract
  structured data from their pages. It
  can be used for a wide range of
  purposes, from data mining to
  monitoring and automated testing.</p>
</blockquote>
<br /><b>#7</b><br /><p>From the documentation it seems that <a href="http://www.crummy.com/software/BeautifulSoup/documentation.html#Other%20Built-In%20Parsers" rel="nofollow">ICantBelieveItsBeautifulSoup</a> parser is what you want:</p>

<blockquote>
  <p>ICantBelieveItsBeautifulSoup is also a
  subclass of BeautifulSoup. It has HTML
  heuristics that conform more closely
  to the HTML standard, but ignore how
  HTML is used in the real world. For
  instance, it's valid HTML to nest &lt;B&gt;
  tags, but in the real world a nested
  &lt;B&gt; tag almost always means that the
  author forgot to close the first &lt;B&gt;
  tag. If you run into someone who
  actually nests &lt;B&gt; tags, then you can
  use ICantBelieveItsBeautifulSoup.</p>
</blockquote>
<br /><b>#8</b><br /><p>this one looks good to me I am using it myself : link [http://code.google.com/p/webscraping/]</p>
<br />