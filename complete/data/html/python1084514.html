<h3>Question (ID-1084514):</h3><h2>Make your program USE a gui</h2><p>I'd like to write a program able to "use" other programs by taking control of the mouse/keyboard and being able to "see" what's on the screen.</p>

<p>I used <a href="http://www.autoitscript.com/autoit3/" rel="nofollow">AutoIt</a> to do something similar, but I had to cheat sometimes because the language is not that powerful, or maybe it's just that I suck and I'm not able to do that much with it :P </p>

<p>So... I need to:</p>

<ul>
<li>Take screenshots, then I will compare them to make the program "understand", but it needs to "see"</li>
<li>Use the mouse: move, click and release, it's simple, isn't it?</li>
<li>Using the keyboard: pressing some keys, or key combinations, including special keys like <kbd>Alt</kbd>,<kbd>Ctrl</kbd> etc...</li>
</ul>

<p>How can I do that in python?<br/>
Does it works in both linux and windows? (this could be really really cool, but it is not necessary)</p>
<br /><h3>Answers (Total-6):</h3><b>#0</b><br /><p>You can use <a href="http://www.tizmoi.net/watsup/intro.html" rel="nofollow">WATSUP</a> under Windows.</p>
<br /><b>#1</b><br /><p>I've had some luck with similar tasks using <a href="http://pywinauto.openqa.org/" rel="nofollow">PyWinAuto</a>.</p>

<blockquote>
  <p>pywinauto is a set of python modules
  to automate the Microsoft Windows GUI.
  At it's simplest it allows you to send
  mouse and keyboard actions to windows
  dialogs and controls.</p>
</blockquote>

<p>It also has some support for capturing images of dialogs and such using the Python Imaging Library <a href="http://www.pythonware.com/products/pil/" rel="nofollow">PIL</a>.</p>
<br /><b>#2</b><br /><p>If you are comfortable with pascal, a really powerful keyboard/mouse/screen-reading program is SCAR: <a href="http://freddy1990.com/index.php?page=product&amp;name=scar" rel="nofollow">http://freddy1990.com/index.php?page=product&amp;name=scar</a>  It can do OCR, bitmap finding, color finding, etc.  It's often used for automating online games, but it can be used for any situation where you want to simulate a human reading the screen and giving input.</p>
<br /><b>#3</b><br /><p>AutoIt is completely capable of doing everything you mentioned.  When I'm wanting to do some automation but use the features of Python, I find it easiest to use <a href="http://www.google.com/url?sa=t&amp;source=web&amp;ct=res&amp;cd=1&amp;url=http%3A%2F%2Fwww.autoitscript.com%2Fautoit3%2Fdownloads.shtml&amp;ei=Yk9TSsOsDYnWNfza6fQI&amp;usg=AFQjCNEBCnVe6pRuxIzX%5FUE4U%5F3O8SVYOg&amp;sig2=t4kpjNbgspeikHz2SBkIGg" rel="nofollow">AutoItX</a> which is a DLL/COM control.</p>

<p>Taken from <a href="http://stackoverflow.com/questions/151846/get-other-running-processes-window-sizes-in-python/155587#155587">this answer</a> of mine:</p>

<pre><code>import win32com.client
oAutoItX = win32com.client.Dispatch( "AutoItX3.Control" )

oAutoItX.Opt("WinTitleMatchMode", 2) #Match text anywhere in a window title

width = oAutoItX.WinGetClientSizeWidth("Firefox")
height = oAutoItX.WinGetClientSizeHeight("Firefox")

print width, height
</code></pre>
<br /><b>#4</b><br /><p>There are numerous software packages that already do this. I believe <a href="http://en.wikipedia.org/wiki/HP%5FQuickTest%5FProfessional" rel="nofollow">HP QuickTest Pro</a> has this functionality. This seems to be in the category of automated <a href="http://en.wikipedia.org/wiki/Regression%5Ftesting" rel="nofollow">regression testing</a>.</p>
<br /><b>#5</b><br /><p>I've used the Windows (only) <a href="http://msdn.microsoft.com/en-us/library/ms646310%28VS.85%29.aspx" rel="nofollow">Input API</a> to write a VNC-like remote-control application in the past.  It lets you fake keyboard and mouse input nicely at a system level (ie not just posting events to a single application).</p>

<p>If you're trying to do any sort of automated testing of whole systems at the GUI level, <a href="http://www.usenix.org/event/usenix05/tech/freenix/full%5Fpapers/zeldovich/zeldovich%5Fhtml/index.html" rel="nofollow">this excellent USENIX paper</a> describing automated responsiveness testing is a must-read.</p>
<br />