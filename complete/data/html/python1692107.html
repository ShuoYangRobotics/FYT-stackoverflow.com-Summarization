<h3>Question (ID-1692107):</h3><h2>Performance difference in alternative switches in Python</h2><p>I have read a few articles around alternatives to the switch statement in Python. Mainly using dicts instead of lots of if's and elif's. However none really answer the question: is there one with better performance or efficiency? I have read a few arguments that if's and elifs would have to check each statement and becomes inefficient with many ifs and elif's. However using dicts gets around that, but you end up having to create new modules to call which cancels the performance gain anyways. The only difference in the end being readability.</p>

<p>Can anyone comment on this, is there really any difference in the long run? Does anyone regularly use the alternative? Only reason I ask is because I am going to end up having 30-40 elif/if's and possibly more in the future. Any input is appreciated. Thanks.</p>
<br /><h3>Answers (Total-6):</h3><b>#0</b><br /><p><code>dict</code>'s perfomance is typically going to be unbeatable, because a lookup into a <code>dict</code> is going to be O(1) except in rare and practically never-observed cases (where they key involves user-coded types with lousy hashing;-).  You don't have to "create new modules" as you say, just arbitrary callables, and that creation, which is performed just once to prep the dict, is <strong>not</strong> particularly costly anyway -- during operation, it's just one lookup and one call, greased lightning time.</p>

<p>As others have suggested, try <code>timeit</code> to experiment with a few micro-benchmarks of the alternatives.  My prediction: with a few dozen possibilities in play, as you mention you have, you'll be slapping your forehead about ever considering anything <strong>but</strong> a dict of callables!-)</p>

<p>If you find it too hard to run your own benchmarks and can supply some specs, I guess we can benchmark the alternatives for you, but it would be really more instructive if you tried to do it yourself before you ask SO for help!-)</p>
<br /><b>#1</b><br /><p>Your concern should be about the readability and maintainability of the code, rather than its efficiency. This applies in most scenarios, and particularly in the one you describe now. The efficiency difference is likely to be negligible (you can easily check it with a small amount of benchmarking code), but 30-40 elif's are a warning sign - perhaps something can be abstracted away and make the code more readable. Describe your case, and perhaps someone can come up with a better design.</p>
<br /><b>#2</b><br /><p>With all performance/profiling questions, the right answer is "test each case yourself for your specific needs."</p>

<p>One great tool for this is <code>timeit</code> which you can learn about <a href="http://docs.python.org/library/timeit.html" rel="nofollow">in the python docs</a>.</p>

<p>In general I have seen no performance issues related to using a dictionary in place of other languages <code>switch</code> statement. My guess would be that the comparison in performance would depend on the number of alternatives. Who knows, there may be a tipping point where one becomes better than the other.</p>

<p>If you (or anyone else) tests it, feel free to post your results.</p>
<br /><b>#3</b><br /><p>I think a dict will gain advantage over the alternative sequence of <code>if</code> statements as the number of cases goes up, since the key lookup only requires one hash operation. Otherwise if you only have a few cases, a few <code>if</code> statements are better. A dict is probably a more elegant solution for what you are doing. Either way, the performance difference wont really be noticeable in your case.</p>
<br /><b>#4</b><br /><p>Times when you'd use a switch in many languages you would use a dict in Python. A switch statement, if added to Python (it's been considered), would not be able to give any real performance gain anyways.</p>

<p>dicts are used ubiquitously in Python. CPython dicts are an insanely-efficient, robust hashtable implementation. Lookup is O(1), as opposed to traversing an elif chain, which is O(n). (30-40 probably doesn't qualify as big enough for this to matter tons anyways). I am not sure what you mean about creating new modules to call, but using dicts is very scalable and easy. </p>

<p>As for actual performance gain, that is impossible to really tackle effectively abstractly. Write your code in the most straightforward and maintainable way (you're using Python forgoshsakes!) and then see if it's too slow. If it is, profile it and find out what places it needs to be sped up to make a real difference.</p>
<br /><b>#5</b><br /><p>I ran a few benchmarks (see <a href="https://gist.github.com/729134" rel="nofollow">here</a>). Using lists of function pointers is fastest,if your keys are sequential integers. For the general case: Alex Martelli is right, dictionary are fastest.</p>
<br />