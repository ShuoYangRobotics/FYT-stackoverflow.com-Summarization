<h3>Question (ID-1596911):</h3><h2>How do you convert a Word Document into very simple html in Python?</h2><p>Every now and then I receive a Word Document that I have to display as a web page.  I'm currently using Django's flatpages to achieve this by grabbing the html content generated by MS Word.  The generated html is quite messy.  Is there a better way that can generate very simple html to solve this issue using Python?</p>
<br /><h3>Answers (Total-7):</h3><b>#0</b><br /><p>A good solution involves uploading into Google Docs and exporting the html version from it. (There must be an api for that?)</p>

<p>It does so many "clean ups"; <a href="http://www.crummy.com/software/BeautifulSoup/" rel="nofollow">Beautiful Soup</a> down the road can be used to make any further changes, as appropriate. It is the most powerful and elegant html parsing library on the planet.</p>

<p>This is a known standard for Journalist companies.</p>
<br /><b>#1</b><br /><p>It depends how much formatting and images you're dealing with. I do one of a couple things:</p>

<ul>
<li><strong>Google Docs</strong>: Probably the closest you'll get to the original formatting and usable HTML.</li>
<li><strong>Markdown</strong>: Abandon formatting. Paste it into a plain text editor, run it through Markdown and fix the rest by hand.</li>
</ul>
<br /><b>#2</b><br /><p>You can also use <a href="http://www.abisource.com/" rel="nofollow">Abiword</a>/<a href="http://wvware.sourceforge.net/" rel="nofollow">wvWare</a> to convert word document to XHTML and then parse it with <a href="http://www.crummy.com/software/BeautifulSoup/" rel="nofollow">BeautifulSoup</a>/<a href="http://effbot.org/zone/element-index.htm" rel="nofollow">ElementTree</a>/etc. to preprocess it if you need. In my experience, Abiword does a pretty good job at converting Word files and produce relatively clean XHTML files.</p>

<p>I should mention that Abiword can be run on the command line, so it's easy to integrate it in an automated process.</p>
<br /><b>#3</b><br /><p>My super-simple app <a href="http://wordoff.org/" rel="nofollow">WordOff</a> has an <a href="http://wordoff.org/api" rel="nofollow">API</a> for cleaning up cruft from Word-exported HTML. You could override the save method of your flatpages model to pipe your HTML through the API the first time it gets saved. Something like this:</p>

<pre><code>import urllib
import urllib2

def decruft(html):
    data = urllib.urlencode({'html' : html})
    req = urllib2.Request('http://wordoff.org/api/clean', data)
    response = urllib2.urlopen(req)
    return response.read()

def save(self, **kwargs):
    if not self.pk: # only de-cruft when content is first added
        self.content = decruft(self.content)
    super(FlatPage, self).save(**kwargs)
</code></pre>
<br /><b>#4</b><br /><p>There are many other approaches, depending on your specific circumstances, beyond the good ones already suggested -- see <a href="http://stackoverflow.com/questions/910730/python-ms-word">this SO question</a> and its answers for a good survey!</p>
<br /><b>#5</b><br /><p>Word 2010 has the ability to "save as filtered web page". This will eliminate the overwhelming majority of the HTML that Word inserts.</p>

<p>Greg Burdett</p>
<br /><b>#6</b><br /><p>I found this web page: <a href="http://www.textfixer.com/html/convert-word-to-html.php" rel="nofollow">http://www.textfixer.com/html/convert-word-to-html.php</a></p>

<p>It converts a formated text to <strong>simple</strong> HTML markup, preserving bold, italic, links and paragraphs, but not adding tags for font-sizes and faces. Exactly what I needed to save some time.</p>
<br />