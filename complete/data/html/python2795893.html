<h3>Question (ID-2795893):</h3><h2>Decoding MIME (HTML+Attachments)</h2><p>I'm planning to write an application that should handle incoming mails. Basically it will act more like a ticketing system than a webmail, so I'm only interested in receiving emails, and not sending them.</p>

<p>I have made a simple prototype that downloads mails and displays the text with downloadable attachments in a web page, but handling mails from Outlook and others is more complicated. I have looked at some of the open source ticketing systems out there, but most of the code is tied to the system and is hard to separate.</p>

<p>Is there a library that understands "rich" mail and makes this job simpler? Preferably in Python, Java, Ruby or Perl. I'm also open to suggestions for any command line mail clients that can be used for this, since the system will not receive large amounts of mail and can afford to launch external processes.</p>

<p><b>Edit:</b></p>

<p>I know about the standard mail libraries in Python and Java and can handle the mail itself, but I'm looking for a library that can help me with the "rich" emails created by Outlook/Thunderbird that contains formatting and inline images.</p>
<br /><h3>Answers (Total-7):</h3><b>#0</b><br /><p>There are several email-handling packages in the Python standard library. I haven't worked with them very much, so I'm not sure whether they do quite what you intend, but if you haven't already I would suggest taking a look at e.g. the <a href="http://docs.python.org/library/email.html" rel="nofollow">email package</a>.</p>

<p>If you're looking for something higher-level than that, I'm sure there are third-party libraries available.</p>
<br /><b>#1</b><br /><p>For Perl, check out <a href="http://search.cpan.org/~rjbs/" rel="nofollow">Ricardo Signes</a>' <a href="http://search.cpan.org/perldoc?Email%3a%3aMIME" rel="nofollow">Email::MIME</a> for parsing multipart messages.  Check out <code>walk_parts</code>, it recursively applies a callback to each part of a multipart message.</p>
<br /><b>#2</b><br /><p>Python has the aptly-named <a href="http://docs.python.org/library/email.html" rel="nofollow"><code>email</code></a> package for handling email messages.</p>
<br /><b>#3</b><br /><p>Java has the <a href="http://java.sun.com/products/javamail/" rel="nofollow">Javamail</a> API that can <a href="http://java.sun.com/developer/onlineTraining/JavaMail/contents.html#GettingAttachments" rel="nofollow">handle MIME attachments</a>.</p>
<br /><b>#4</b><br /><p>PHP has the imap functions
with <code>imap_fetchstructure</code> and <code>imap_fetchbody</code> u can handle all type of Emails but its kinda hard.</p>

<p>U can also look at <a href="http://www.squirrelmail.org/" rel="nofollow">http://www.squirrelmail.org/</a> and rip off the email view part.</p>
<br /><b>#5</b><br /><p>The Zend Framework has a package called Zend_Mail that can handle multipart emails, attachments, MIME content and HTML emails</p>

<p>The link is <a href="http://zendframework.com/manual/en/zend.mail.html" rel="nofollow" title="Zend_Mail">here</a></p>
<br /><b>#6</b><br /><p>What you desire is not available right now in java (as far as I know), you need to receive the email data stream and create your own wrapper over email parser libraries.</p>

<p>I have created similar solution in java that takes in incoming email data stream and gives out an email object that contains email body (plain text and html both), attachments etc.</p>

<p>It's able to handle mails from all of the email clients that I know atleast.</p>

<p>I use <a href="http://james.apache.org/mime4j/" rel="nofollow">mime4j</a>(email data stream parser) for my task and it's much better than java mail api.</p>
<br />