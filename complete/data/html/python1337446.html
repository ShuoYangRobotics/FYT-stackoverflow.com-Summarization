<h3>Question (ID-1337446):</h3><h2>Is there a Python module for converting RTF to plain text?</h2><p>Ideally, I'd like a module or library that doesn't require superuser access to install; I have limited privileges in my working environment.</p>
<br /><h3>Answers (Total-6):</h3><b>#0</b><br /><p>I've been working on a library called Pyth, which can do this:</p>

<p><a href="http://pypi.python.org/pypi/pyth/" rel="nofollow">http://pypi.python.org/pypi/pyth/</a></p>

<p>Converting an RTF file to plaintext looks something like this:</p>

<pre><code>from pyth.plugins.rtf15.reader import Rtf15Reader
from pyth.plugins.plaintext.writer import PlaintextWriter

doc = Rtf15Reader.read(open('sample.rtf'))

print PlaintextWriter.write(doc).getvalue()
</code></pre>

<p>Pyth can also generate RTF files, read and write XHTML, generate documents from Python markup a la Nevow's stan, and has limited experimental support for latex and pdf output. Its RTF support is <a href="http://github.com/brendonh/pyth/blob/master/pyth/plugins/rtf15/reader.py" rel="nofollow">pretty robust</a> -- we use it in production to read RTF files generated by various versions of Word, OpenOffice, Mac TextEdit, EIOffice, and others.</p>
<br /><b>#1</b><br /><p>Have you checked out <a href="http://code.google.com/p/pyrtf-ng/" rel="nofollow">pyrtf-ng</a>?</p>

<p><strong>Update:</strong> The parsing functionality is available if you do a Subversion checkout, but I'm not sure how full-featured it is. (Look in the <code>rtfng.parser.base</code> module.)</p>
<br /><b>#2</b><br /><p>OpenOffice has a RTF reader. You can use python to script OpenOffice, <a href="http://wiki.services.openoffice.org/wiki/Python" rel="nofollow">see here for more info</a>.</p>

<p>You could probably try using the magic com-object on Windows to read anything that smells ms-binary. I wouldn't recommend that though.</p>

<p>Actually parsing the raw data probably won't be very hard, <a href="http://www.infionline.net/~wtnewton/batch/rtf2txt.htm" rel="nofollow">see this example</a> written in .bat/QBasic.</p>

<p><em><a href="http://www.docfrac.net/" rel="nofollow">DocFrac</a> is a free open source converter betweeen RTF, HTML and text. Windows, Linux, ActiveX and DLL platforms available.</em> It will probably be pretty easy to wrap it up in python.</p>

<p><em><a href="http://search.cpan.org/~sargie/RTF-Parser-1.09/lib/RTF/TEXT/Converter.pm" rel="nofollow">RTF::TEXT::Converter</a> - Perl extension for converting RTF into text</em>. (in case You have problems withg DocFrac).</p>

<p>A <a href="http://mail.python.org/pipermail/python-list/2001-May/084812.html" rel="nofollow">discussion</a> on this subject on python mailing list.</p>

<p>Official Rich Text Format (RTF) <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=e5b8ebc2-6ad6-49f0-8c90-e4f763e3f04f&amp;DisplayLang=en" rel="nofollow">Specifications</a>, version 1.7, by Microsoft.</p>

<p>Good luck (with the limited privileges in Your working environment).</p>
<br /><b>#3</b><br /><p>There is good library <a href="http://code.google.com/p/pyrtf-ng/" rel="nofollow">pyrtf-ng</a> for all-purpose RTF handling.</p>
<br /><b>#4</b><br /><p>I ran into the same thing ans I was trying to code it myself. It's not that easy but here is what I had when I decided to go for a commandline app. Its ruby but you can adapt to python very easily.
There is some header garbage to clean up, but you can see more or less the idea.</p>

<pre><code>f = File.open('r.rtf','r')
 b=0
 p=false
 str = ''
 begin
    while (char = f.readchar)
        if char.chr=='{'
   b+=1 
   next
  end
        if char.chr=='}'
   b-=1 
   next
  end
  if char.chr=='\\'
   p=true
   next
  end
  if p==true &amp;&amp; (char.chr==' ' or char.chr=='\n' or char.chr=='\t' or char.chr=='\r')
   p=false 
   next
  end
  if p==true &amp;&amp; (char.chr=='\'')
#this is the source of my headaches. you need to read the code page from the header and encode this.
   p=false 
   str &lt;&lt; '#'
   next
  end
  next if b&gt;2
  next if p
  str &lt;&lt; char.chr
    end
rescue EOFError
end
f.close
</code></pre>
<br /><b>#5</b><br /><p>Conversely, if you want to write RTFs easily from Python, you can use the third-party module <a href="https://github.com/viking-sudo-rm/rtflib/blob/master/rtflib.py" rel="nofollow">rtflib</a>. It's a fairly new and incomplete module but still very powerful and useful. Below is an example that writes "hello world" in rich text to an RTF called helloworld.rtf. This is a very primitive example, and the module can also be used to add colors, italics, tables, and many other aspects of rich text to RTF files.</p>

<pre><code>from rtflib import *
file = RTF("helloworld.rtf")
file.startfile()
file.addstrict()
file.addtext("hello world")
file.writeout()
</code></pre>
<br />