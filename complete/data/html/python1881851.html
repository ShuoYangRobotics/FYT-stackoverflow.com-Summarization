<h3>Question (ID-1881851):</h3><h2>How to unpickle from C code</h2><p>I have a python code computing a matrix, and I would like to use this matrix (or array, or list) from C code.<br>
I wanted to pickle the matrix from the python code, and unpickle it from c code, but I could not find documentation or example on how to do this.
I found something about marshalling data, but nothing about unpickling from C.</p>

<p>Edit :
Commenters Peter H asked if I was working with numpy arrays. The answer is yes.</p>
<br /><h3>Answers (Total-7):</h3><b>#0</b><br /><p>You might want to use something more standardized, like <a href="http://www.json.org/" rel="nofollow">JSON</a>.   You have a JSON module in Python 2.6.  There are 6 different JSON modules for C. </p>

<p>You might want to use something more C-like, like the Python <code>struct</code> module.  It can build a C-compatible object directly, saving you from pickling and unpickling.  <a href="http://docs.python.org/library/struct.html" rel="nofollow">http://docs.python.org/library/struct.html</a></p>
<br /><b>#1</b><br /><p>If it's just a matrix, you could just write it out as a CSV file. Look at the Python csv module for this.
<a href="http://docs.python.org/library/csv.html" rel="nofollow">http://docs.python.org/library/csv.html</a></p>
<br /><b>#2</b><br /><p>Check out the chapter on Serializing Data in Mark Pilgrim's <a href="http://diveintopython3.org/serializing.html" rel="nofollow">Dive Into Python</a>. He states there that "The pickle protocol is Python-specific; there is no guarantee of cross-language compatibility. You probably couldnâ€™t take the [...] pickle file you just created and do anything useful with it in Perl, PHP, Java, or any other language."</p>

<p>Perhaps JSON is a better alternative, also explained in that chapter.</p>
<br /><b>#3</b><br /><p>If you absolutely must use pickling, you can embed Python in your C program and unpickle in C via Python.</p>

<ul>
<li><a href="http://www.linuxjournal.com/article/8497" rel="nofollow">A quick example from Linux Journal</a></li>
<li><a href="http://docs.python.org/extending/extending.html#calling-python-functions-from-c" rel="nofollow">Python Docs</a></li>
<li><a href="http://stackoverflow.com/questions/1056051/how-do-you-call-python-code-from-c-code">http://stackoverflow.com/questions/1056051/how-do-you-call-python-code-from-c-code</a></li>
</ul>
<br /><b>#4</b><br /><p><a href="http://code.google.com/p/protobuf/" rel="nofollow">Protocol Buffers</a> are an interesting approach to serialize information in a cross-language way that's also quite compact and fast (support for C, as opposed to C++, isn't part of the protobuf package as released, but linking in some C++ code may be acceptable in some C projects, or there may be third-party implementations such as <a href="http://code.google.com/p/protobuf-c/" rel="nofollow">protobuf-c</a> -- see <a href="http://code.google.com/p/protobuf/wiki/ThirdPartyAddOns" rel="nofollow">here</a> for a list of other third-party add-ons).</p>
<br /><b>#5</b><br /><p>take a look at module <code>struct</code> ?</p>
<br /><b>#6</b><br /><p>Besides JSON, there are also the <a href="http://code.google.com/p/protobuf/" rel="nofollow"><strong>Google Protocol Buffers</strong></a> which have 'native' support (from Google) for Python, C++ and Java -- and a number of third-party bindings to other languages including C.</p>
<br />