[{"text": ["Using subprocess to run Python script on Windows"], "childNum": 0, "tag": "h2", "senID": 0, "childList": []}, {"text": ["Is there a simple way to run a Python script on Windows/Linux/OS X?"], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"text": ["On the latter two, subprocess.Popen(\"/the/script.py\") works, but on Windows I get the following error:"], "childNum": 1, "tag": "p", "senID": 2, "childList": [{"text": "subprocess.Popen(\"/the/script.py\")", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"code": "<pre>\n<code>\n Traceback (most recent call last):\n  File \"test_functional.py\", line 91, in test_functional\n    log = tvnamerifiy(tmp)\n  File \"test_functional.py\", line 49, in tvnamerifiy\n    stdout = PIPE\n  File \"C:\\Python26\\lib\\subprocess.py\", line 595, in __init__\n    errread, errwrite)\n  File \"C:\\Python26\\lib\\subprocess.py\", line 804, in _execute_child\n    startupinfo)\nWindowsError: [Error 193] %1 is not a valid Win32 application\n</code>\n</pre>\n", "senID": 3}, {"tag": "hr", "senID": 4}, {"text": ["I was writing a quick script to test the overall functionality of a Python-command-line tool (to test it on various platforms).", "Basically it had to create a bunch of files in a temp folder, run the script on this and check the files were renamed correctly."], "childNum": 0, "tag": "p", "senID": 5, "childList": []}, {"text": ["I could have imported the script and called the function, but since it relies on sys.argv and uses sys.exit(), I would have needed to do something like.."], "childNum": 2, "tag": "p", "senID": 6, "childList": [{"text": "sys.argv", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "sys.exit()", "childNum": 0, "tag": "code", "childList": []}]}, {"code": "<pre>\n<code>\n import sys\nimport tvnamer\nsys.argv.append(\"-b\", \"/the/folder\")\ntry:\n    tvnamer.main()\nexcept BaseException, errormsg:\n    print type(errormsg)\n</code>\n</pre>\n", "senID": 7}, {"text": ["Also, I wanted to capture the stdout and stderr for debugging incase something went wrong."], "childNum": 0, "tag": "p", "senID": 8, "childList": []}, {"text": ["Of course a better way would be to write the script in more unit-testable way, but the script is basically \"done\" and I'm doing a final batch of testing before doing a \"1.0\" release (after which I'm going to do a rewrite/restructure, which will be far tidier and more testable)"], "childNum": 0, "tag": "p", "senID": 9, "childList": []}, {"text": ["Basically, it was much easier to simply run the script as a process, after finding the sys.executable variable.", "I would have written it as a shell-script, but that wouldn't have been cross-platform.", "The final script can be found here"], "childNum": 2, "tag": "p", "senID": 10, "childList": [{"text": "sys.executable", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "here", "tag": "a", "pos": 2, "childList": [], "childNum": 0, "href": "http://github.com/dbr/tvdb%5Fapi/blob/c8d7b356cd1a7bb2ab22b510ea74e03a7d27fad6/tests/test%5Ffunctional.py"}]}]