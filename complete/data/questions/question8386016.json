[{"text": ["Check Python code for certain statements"], "childNum": 0, "tag": "h2", "senID": 0, "childList": []}, {"text": ["I'm working on a system that allows users to run their code on our system.", "While their code is sandboxed, I would still like to know if their code is using certain statements, especially imports.", "This is used to do a quick check for malicious code or code that is against the guidelines for the platform, it will not be the only check, since the code is also checked by humans later, but filtering out the worst cases automatically would be preferable."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"text": ["So what would be the best way, without executing the code, to check if their code for example imports sys (or a part of sys)?", "I would hope there's a nicer/better way then regex-searching that code."], "childNum": 2, "tag": "p", "senID": 2, "childList": [{"text": "sys", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "sys", "childNum": 0, "tag": "code", "pos": -1, "childList": []}]}, {"text": ["Bonus question: What about more complex statements?", "For example calling foo from module bar?"], "childNum": 2, "tag": "p", "senID": 3, "childList": [{"text": "foo", "childNum": 0, "tag": "code", "pos": 1, "childList": []}, {"text": "bar", "childNum": 0, "tag": "code", "childList": []}]}, {"text": ["EDIT: This is NOT a question about security.", "It's about finding certain statements inside code.", "See my comment.", "This user-code will only run inside the users sandbox, so they can just ruin their own sandbox.", "But if their code gets 'certified' it can run in other users sandboxes, before it gets certified it needs to be checked.", "And if an automated check can spot the worst offenses, that would be helpful."], "childNum": 0, "tag": "p", "senID": 4, "childList": []}]