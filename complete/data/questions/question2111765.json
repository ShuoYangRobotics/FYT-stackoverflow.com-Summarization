[{"text": ["Problem when using python logging in django and unicode"], "childNum": 0, "tag": "h2", "senID": 0, "childList": []}, {"text": ["totally confused by now...", "I am developing in python/django and using python logging.", "All of my app requires unicode and all my models have only a unicode()`, return u'..' methods implemented.", "Now when logging I have come upon a really strange issue that it took a long time to discover that I could reproduce it.", "I have tried both Py 2.5.5 and Py 2.6.4 and same thing.", "So "], "childNum": 1, "tag": "p", "senID": 1, "childList": [{"text": "unicode", "childNum": 0, "tag": "strong", "pos": 2, "childList": []}]}, {"text": ["Whenever I do some straight forward logging like:"], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"code": "<pre>\n<code>\n logging.debug(u'new value %s' % group)\n</code>\n</pre>\n", "senID": 3}, {"text": ["this calls the models group.unicode(): return unicode(group.name)"], "childNum": 1, "tag": "p", "senID": 4, "childList": [{"text": "unicode", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}]}, {"text": ["My unicode methods all looks like this:"], "childNum": 0, "tag": "p", "senID": 5, "childList": []}, {"code": "<pre>\n<code>\n def __unicode__(self):\n    return u'%s - %s (%s)' % (self.group, self.user.get_full_name(), self.role)\n</code>\n</pre>\n", "senID": 6}, {"text": ["This works even if group.name is XXX or \u00c4\u00c4\u00c4 (requiring unicode).", "But when I for some reason want to log a set, list, dictionary, django-query set and the individual instances in e.g.", "the list might be unicode or not I get into trouble..."], "childNum": 0, "tag": "p", "senID": 7, "childList": []}, {"text": ["So this will get me a UnicodeDecodingError whenever a group.name requires unicode like Lule\u00e5 (my hometown)"], "childNum": 0, "tag": "p", "senID": 8, "childList": []}, {"code": "<pre>\n<code>\n logging.debug(u'new groups %s' % list_of_groups)\n</code>\n</pre>\n", "senID": 9}, {"text": ["Typically I get an error like this:"], "childNum": 0, "tag": "p", "senID": 10, "childList": []}, {"code": "<pre>\n<code>\n Exception Type:     UnicodeDecodeError\nException Value:    ('ascii',  '&lt;RBACInstanceRoleSet: s2 | \\xc3\\x84\\xc3\\x96\\xc3\\x96\\xc3\\x85\\xc3\\x85\\xc3\\x85 Gruppen&gt;]', 106, 107, 'ordinal not in range(128)')\n</code>\n</pre>\n", "senID": 11}, {"text": ["But if I do print list_of_groups everything gets out nice on terminal"], "childNum": 1, "tag": "p", "senID": 12, "childList": [{"text": "print list_of_groups", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"text": ["So, my understanding is that the list starts to generate itself and does repr() on all its elements and they return their values - in this case it should be 's2 | \u00c5\u00c4\u00d6\u00d6', then the list presents itself as (ascii, the-stuff-in-the-list) and then when trying to Decode the ascii into unicode this will of course not work -- since one of the elements in the list has returened a u'...' of itself when repr was done on it."], "childNum": 1, "tag": "p", "senID": 13, "childList": [{"text": "ascii", "childNum": 0, "tag": "em", "pos": 0, "childList": []}]}, {"text": ["But why is this???", "?\u00b4"], "childNum": 0, "tag": "p", "senID": 14, "childList": []}, {"text": ["And why do things work and unicode/ascii is handled correctly whenever I log simple things like group.name and so or group and the unicode methods are called.", "Whenever I get lazy and want to log a list, set or other things go bad whenever a unicode character is encountered..."], "childNum": 1, "tag": "p", "senID": 15, "childList": [{"text": "unicode", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}]}, {"text": ["Some more examples that work and fail.", "If group.name I go to the model field and group calls the __unicode__()"], "childNum": 3, "tag": "p", "senID": 16, "childList": [{"text": "group.name", "childNum": 0, "tag": "code", "pos": 1, "childList": []}, {"text": "group", "childNum": 0, "tag": "code", "childList": []}, {"text": "__unicode__()", "childNum": 0, "tag": "code", "childList": []}]}, {"code": "<pre>\n<code>\n logging.debug(\"1. group: %s \" % group.name) # WORKS\n    logging.debug(u\"2. group: %s \" % group) # WORKS\n    logging.debug(\"3. group: %s \" % group) # FAILS\n    logging.debug(u\"4. group: %s \" % group.name) # WORKS\n    logging.debug(\"5. group: %s \" % group.name) # WORKS\n</code>\n</pre>\n", "senID": 17}, {"text": ["...and I really thought I had a grip on Unicode ;-("], "childNum": 0, "tag": "p", "senID": 18, "childList": []}]