[{"text": ["How do you access an authenticated Google App Engine service from a (non-web) python client?"], "childNum": 0, "tag": "h2", "senID": 0, "childList": []}, {"text": ["I have a Google App Engine app - http://mylovelyapp.appspot.com/\nIt has a page - mylovelypage"], "childNum": 1, "tag": "p", "senID": 1, "childList": [{"text": "http://mylovelyapp.appspot.com/", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://mylovelyapp.appspot.com/"}]}, {"text": ["For the moment, the page just does self.response.out.write('OK')"], "childNum": 1, "tag": "p", "senID": 2, "childList": [{"text": "self.response.out.write('OK')", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"text": ["If I run the following Python at my computer:"], "childNum": 0, "tag": "p", "senID": 3, "childList": []}, {"code": "<pre>\n<code>\n import urllib2\nf = urllib2.urlopen(\"http://mylovelyapp.appspot.com/mylovelypage\")\ns = f.read()\nprint s\nf.close()\n</code>\n</pre>\n", "senID": 4}, {"text": ["it prints \"OK\""], "childNum": 0, "tag": "p", "senID": 5, "childList": []}, {"text": ["the problem is if I add login:required to this page in the app's yaml"], "childNum": 1, "tag": "p", "senID": 6, "childList": [{"text": "login:required", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"text": ["then this prints out the HTML of the Google Accounts login page"], "childNum": 0, "tag": "p", "senID": 7, "childList": []}, {"text": ["I've tried \"normal\" authentication approaches.", "e.g."], "childNum": 0, "tag": "p", "senID": 8, "childList": []}, {"code": "<pre>\n<code>\n passman = urllib2.HTTPPasswordMgrWithDefaultRealm()\n\nauth_handler = urllib2.HTTPBasicAuthHandler()\nauth_handler.add_password(None,\n                          uri='http://mylovelyapp.appspot.com/mylovelypage',\n                          user='billy.bob@gmail.com',\n                          passwd='billybobspasswd')\nopener = urllib2.build_opener(auth_handler)\nurllib2.install_opener(opener)\n</code>\n</pre>\n", "senID": 9}, {"text": ["But it makes no difference - I still get the login page's HTML back."], "childNum": 0, "tag": "p", "senID": 10, "childList": []}, {"text": ["I've tried Google's ClientLogin auth API, but I can't get it to work."], "childNum": 1, "tag": "p", "senID": 11, "childList": [{"text": "Google's ClientLogin auth API", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://code.google.com/apis/accounts/docs/AuthForInstalledApps.html"}]}, {"code": "<pre>\n<code>\n h = httplib2.Http()\n\nauth_uri = 'https://www.google.com/accounts/ClientLogin'\nheaders = {'Content-Type': 'application/x-www-form-urlencoded'}\nmyrequest = \"Email=%s&amp;Passwd=%s&amp;service=ah&amp;source=DALELANE-0.0\" % (\"billy.bob@gmail.com\", \"billybobspassword\")\nresponse, content = h.request(auth_uri, 'POST', body=myrequest, headers=headers)\n\nif response['status'] == '200':\n    authtok = re.search('Auth=(\\S*)', content).group(1)\n\n    headers = {}\n    headers['Authorization'] = 'GoogleLogin auth=%s' % authtok.strip()\n    headers['Content-Length'] = '0'\n\n    response, content = h.request(\"http://mylovelyapp.appspot.com/mylovelypage\", \n                                  'POST', \n                                  body=\"\", \n                                  headers=headers)\n\n    while response['status'] == \"302\":        \n        response, content = h.request(response['location'], 'POST', body=\"\", headers=headers) \n\n    print content\n</code>\n</pre>\n", "senID": 12}, {"text": ["I do seem to be able to get some token correctly, but attempts to use it in the header when I call 'mylovelypage' still just return me the login page's HTML.", ":-( "], "childNum": 0, "tag": "p", "senID": 13, "childList": []}, {"text": ["Can anyone help, please?"], "childNum": 0, "tag": "p", "senID": 14, "childList": []}, {"text": ["Could I use the GData client library to do this sort of thing?", "From\nwhat I've read, I think it should be able to access App Engine apps,\nbut I haven't been any more successful at getting the authentication working for App Engine stuff there either "], "childNum": 1, "tag": "p", "senID": 15, "childList": [{"text": "GData client library", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://code.google.com/p/gdata-python-client/"}]}, {"text": ["Any pointers to samples, articles, or even just keywords I should be\nsearching for to get me started, would be very much appreciated."], "childNum": 0, "tag": "p", "senID": 16, "childList": []}, {"text": ["Thanks!"], "childNum": 0, "tag": "p", "senID": 17, "childList": []}]