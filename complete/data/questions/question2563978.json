[{"text": ["Rewriting Live TCP/IP (Layer 4) (i.e.", "Socket Layer) Streams"], "childNum": 0, "tag": "h2", "senID": 0, "childList": []}, {"text": ["I have a simple problem which I'm sure someone here has done before... "], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"text": ["I want to rewrite Layer 4 TCP/IP streams (Not lower layer individual packets or frames.", ") Ettercap's etterfilter command lets you perform simple live replacements of Layer 4 TCP/IP streams based on fixed strings or regexes.", "Example ettercap scripting code:"], "childNum": 1, "tag": "p", "senID": 2, "childList": [{"text": "etterfilter", "childNum": 0, "tag": "code", "pos": 1, "childList": []}]}, {"code": "<pre>\n<code>\n if (ip.proto == TCP &amp;&amp; tcp.dst == 80) {\n    if (search(DATA.data, \"gzip\")) {\n       replace(\"gzip\", \"    \");\n       msg(\"whited out gzip\\n\");\n    }\n }\n\n if (ip.proto == TCP &amp;&amp; tcp.dst == 80) {\n    if (search(DATA.data, \"deflate\")) {\n       replace(\"deflate\", \"       \"); \n       msg(\"whited out deflate\\n\");\n    }\n }\n</code>\n</pre>\n", "senID": 3}, {"text": ["http://ettercap.sourceforge.net/forum/viewtopic.php?t=2833"], "childNum": 1, "tag": "p", "senID": 4, "childList": [{"text": "http://ettercap.sourceforge.net/forum/viewtopic.php?t=2833", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://ettercap.sourceforge.net/forum/viewtopic.php?t=2833"}]}, {"text": ["I would like to rewrite streams based on my own filter program instead of just simple string replacements.", "Anyone have an idea of how to do this?", "Is there anything other than Ettercap that can do live replacement like this, maybe as a plugin to a VPN software or something?"], "childNum": 0, "tag": "p", "senID": 5, "childList": []}, {"text": ["I would like to have a configuration similar to ettercap's silent bridged sniffing configuration between two Ethernet interfaces.", "This way I can silently filter traffic coming from either direction with no NATing problems.", "Note that my filter is an application that acts as a pipe filter, similar to the design of unix command-line filters:"], "childNum": 1, "tag": "p", "senID": 6, "childList": [{"text": "silent bridged sniffing", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}]}, {"code": "<pre>\n<code>\n &gt;[eth0] &lt;----------&gt; [my filter] &lt;----------&gt; [eth1]&lt;\n</code>\n</pre>\n", "senID": 7}, {"text": ["My filter will be a userspace Python function."], "childNum": 0, "tag": "p", "senID": 8, "childList": []}, {"text": ["What I am already aware of, but are not suitable:"], "childNum": 0, "tag": "p", "senID": 9, "childList": []}, {"tag": "ul", "num": 4, "lis": [{"text": ["Tun/Tap - Works at the lower packet layer, I need to work with the higher layer streams."], "childNum": 0, "tag": "p", "senID": 10, "childList": []}, {"text": ["Ettercap - I can't find any way to do replacements other than the restricted capabilities in the example above."], "childNum": 0, "tag": "p", "senID": 11, "childList": []}, {"text": ["Hooking into some VPN software?", "- I just can't figure out which or exactly how."], "childNum": 0, "tag": "p", "senID": 12, "childList": []}, {"text": ["libnetfilter_queue - Works with lower layer packets, not TCP/IP streams."], "childNum": 0, "tag": "p", "senID": 13, "childList": []}]}, {"text": ["Again, the rewriting should occur at the transport layer (Layer 4) as it does in this example, instead of a lower layer packet-based approach.", "Exact code will help immensely!"], "childNum": 0, "tag": "p", "senID": 14, "childList": []}, {"text": ["Thanks!"], "childNum": 0, "tag": "p", "senID": 15, "childList": []}]