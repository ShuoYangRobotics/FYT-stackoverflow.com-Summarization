[{"text": ["Nginx + fastcgi truncation problem"], "childNum": 0, "tag": "h2", "senID": 0, "childList": []}, {"text": ["I'm running a Django site using the fastcgi interface to nginx.", "However, some pages are being served truncated (i.e.", "the page source just stops, sometimes in the middle of a tag).", "How do I fix this (let me know what extra information is needed, and I'll post it)"], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"text": ["Details:"], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"text": ["I'm using flup, and spawning the fastcgi server with the following command:"], "childNum": 0, "tag": "p", "senID": 3, "childList": []}, {"code": "<pre>\n<code>\n python ./manage.py runfcgi umask=000 maxchildren=5 maxspare=1 minspare=0 method=prefork socket=/path/to/runfiles/django.sock pidfile=/path/to/runfiles/django.pid\n</code>\n</pre>\n", "senID": 4}, {"text": ["The nginx config is as follows:"], "childNum": 0, "tag": "p", "senID": 5, "childList": []}, {"code": "<pre>\n<code>\n # search and replace this: {project_location}\npid /path/to/runfiles/nginx.pid;\nworker_processes  2;\nerror_log /path/to/runfiles/error_log;\nevents {\n    worker_connections  1024;\n    use epoll;\n}\nhttp {\n    # default nginx location\n    include        /etc/nginx/mime.types;\n    default_type    application/octet-stream;\n    log_format main\n        '$remote_addr - $remote_user [$time_local] '\n            '\"$request\" $status $bytes_sent '\n        '\"$http_referer\" \"$http_user_agent\" '\n        '\"$gzip_ratio\"';\n    client_header_timeout  3m;\n    client_body_timeout    3m;\n    send_timeout           3m;\n    connection_pool_size        256;\n    client_header_buffer_size    1k;\n    large_client_header_buffers    4 2k;\n    request_pool_size        4k;\n    output_buffers   4 32k;\n    postpone_output  1460;\n    sendfile        on;\n    tcp_nopush             on;\n    keepalive_timeout      75 20;\n    tcp_nodelay            on;\n    client_max_body_size       10m;\n    client_body_buffer_size    256k;\n    proxy_connect_timeout      90;\n    proxy_send_timeout         90;\n    proxy_read_timeout         90;\n    client_body_temp_path      /path/to/runfiles/client_body_temp;\n    proxy_temp_path            /path/to/runfiles/proxy_temp;\n    fastcgi_temp_path            /path/to/runfiles/fastcgi_temp;\n    gzip on;\n    gzip_min_length  1100;\n    gzip_buffers     4 32k;\n    gzip_types       text/plain text/html application/x-javascript text/xml text/css;\n    ignore_invalid_headers    on;\n    server {\n        listen 80;\n        server_name alpha2.sonyalabs.com;\n        index index.html;\n        root   /path/to/django-root/static;\n        # static resources\n        location ~* ^/static/.*$\n        {\n    \troot   /path/to/django-root;\n                expires 30d;\n                break;\n        }\n        location / {\n            # host and port to fastcgi server\n            fastcgi_pass unix:/path/to/runfiles/django.sock;\n            fastcgi_param PATH_INFO $fastcgi_script_name;\n            fastcgi_param REQUEST_METHOD $request_method;\n            fastcgi_param QUERY_STRING $query_string;\n            fastcgi_param CONTENT_TYPE $content_type;\n            fastcgi_param CONTENT_LENGTH $content_length;\n            fastcgi_pass_header Authorization;\n            fastcgi_intercept_errors off;\n        }\n        location /403.html {\n                root   /usr/local/nginx;\n                access_log   off;\n        }\n        location /401.html {\n                root   /usr/local/nginx;\n                access_log   off;\n        }\n        location /404.html {\n                root   /usr/local/nginx;\n                access_log   off;\n        }\n        location = /_.gif {\n                    empty_gif;\n                access_log   off;\n        }\n            access_log    /path/to/runfiles/localhost.access_log main;\n            error_log    /path/to/runfiles/localhost.error_log;\n        }\n}\n</code>\n</pre>\n", "senID": 6}]