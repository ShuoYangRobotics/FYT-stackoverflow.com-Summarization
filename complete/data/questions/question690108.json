[{"text": ["How to prevent every malicious file upload on my server?", "(check file type)?"], "childNum": 0, "tag": "h2", "senID": 0, "childList": []}, {"text": ["my proble is to avoid that users upload some malicious file on my web-server.", "Im working on linux environment (debian)."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"text": ["Actually the uploads are handled via php by this code:"], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"code": "<pre>\n<code>\n function checkFile($nomeFile, $myExt = false){\nif($myExt != false){ $goodExt = \"_$myExt\".\"_\"; }else{ $goodExt = \"_.jpg_.bmp_.zip_.pdf_.gif_.doc_.xls_.csv_.docx_.rar_\"; }\n$punto = strrpos($nomeFile, '.');\n$ext = \"_\".substr($nomeFile, $punto, 8).\"_\";\nif(stristr($goodExt, $ext)){ return 1; }else{ return 0; }\n}\n</code>\n</pre>\n", "senID": 3}, {"text": ["here i can specify the extensions allowed to be uploaded, and if the file dont meet them i delete as soon as the upload is completed.", "But this way let the user free to change the file extension with a simple rename.. and thats bad for me; even if a file.exe (for example) wont never be executed if is renamed in file.jpg (am i right?", "), i dont want to have potential danger files on my server."], "childNum": 0, "tag": "p", "senID": 4, "childList": []}, {"text": ["There is a way, in php, python, or whatelse can a unix system run easly, to check the truly type of a file?"], "childNum": 0, "tag": "p", "senID": 5, "childList": []}, {"text": ["I've tried the python mimetypes module, but it retrieve the ipotetical mime-type of the file.. based on the extension -.-"], "childNum": 0, "tag": "p", "senID": 6, "childList": []}]