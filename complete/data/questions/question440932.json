[{"text": ["Reading Command Line Arguments of Another Process (Win32 C code)"], "childNum": 0, "tag": "h2", "senID": 0, "childList": []}, {"text": ["I need to be able to list the command line arguments (if any) passed to other running processes.", "I have the PIDs already of the running processes on the system, so basically I need to determine the arguments passed to process with given PID XXX. "], "childNum": 1, "tag": "p", "senID": 1, "childList": [{"text": "XXX", "childNum": 0, "tag": "em", "pos": 1, "childList": []}]}, {"text": ["I'm working on a core piece of a Python module for managing processes.", "The code is written as a Python extension in C and will be wrapped by a higher level Python library.", "The goal of this project is to avoid dependency on third party libs such as the pywin32 extensions, or on ugly hacks like calling 'ps' or taskkill on the command line, so I'm looking for a way to do this in C code."], "childNum": 1, "tag": "p", "senID": 2, "childList": [{"text": "Python module for managing processes", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://code.google.com/p/psutil/"}]}, {"text": ["I've Googled this around and found some brief suggestions of using CreateRemoteThread() to inject myself into the other process, then run GetCommandLine() but I was hoping someone might have some working code samples and/or better suggestions."], "childNum": 2, "tag": "p", "senID": 3, "childList": [{"text": "CreateRemoteThread()", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://msdn.microsoft.com/en-us/library/ms682437%28VS.85%29.aspx"}, {"href": "http://msdn.microsoft.com/en-us/library/ms683156%28VS.85%29.aspx", "text": "GetCommandLine()", "childNum": 0, "tag": "a", "childList": []}]}, {"text": ["UPDATE: I've found full working demo code and a solution using NtQueryProcessInformation on CodeProject: http://www.codeproject.com/KB/threads/GetNtProcessInfo.aspx - It's not ideal since it's \"unsupported\" to cull the information directly from the NTDLL structures but I'll live with it.", "Thanks to all for the suggestions. "], "childNum": 2, "tag": "p", "senID": 4, "childList": [{"text": "UPDATE", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}, {"text": "http://www.codeproject.com/KB/threads/GetNtProcessInfo.aspx", "tag": "a", "pos": -1, "childList": [], "childNum": 0, "href": "http://www.codeproject.com/KB/threads/GetNtProcessInfo.aspx"}]}, {"text": ["UPDATE 2: I managed through more Googling to dig up a C version that does not use C++ code, and is a little more direct/concisely pointed toward this problem.", "See http://wj32.wordpress.com/2009/01/24/howto-get-the-command-line-of-processes/ for details."], "childNum": 2, "tag": "p", "senID": 5, "childList": [{"text": "UPDATE 2", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}, {"text": "http://wj32.wordpress.com/2009/01/24/howto-get-the-command-line-of-processes/", "tag": "a", "pos": 1, "childList": [], "childNum": 0, "href": "http://wj32.wordpress.com/2009/01/24/howto-get-the-command-line-of-processes/"}]}, {"text": ["Thanks!"], "childNum": 0, "tag": "p", "senID": 6, "childList": []}]