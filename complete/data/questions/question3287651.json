[{"text": ["Download a spreadsheet from Google Docs using Python"], "childNum": 0, "tag": "h2", "senID": 0, "childList": []}, {"text": ["Can you produce a Python example of how to download a Google Docs spreadsheet given its key and worksheet ID (gid)?", "I can't."], "childNum": 1, "tag": "p", "senID": 1, "childList": [{"text": "gid", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"text": ["I've scoured versions 1, 2 and 3 of the API.", "I'm having no luck, I can't figure out their  compilcated ATOM-like feeds API, the gdata.docs.service.DocsService._DownloadFile private method says that I'm unauthorized, and I don't want to write an entire Google Login authentication system myself.", "I'm about to stab myself in the face due to frustration."], "childNum": 1, "tag": "p", "senID": 2, "childList": [{"text": "gdata.docs.service.DocsService._DownloadFile", "childNum": 0, "tag": "code", "pos": 1, "childList": []}]}, {"text": ["I have a few spreadsheets and I want to access them like so:"], "childNum": 0, "tag": "p", "senID": 3, "childList": []}, {"code": "<pre>\n<code>\n username = 'mygooglelogin@gmail.com'\npassword = getpass.getpass()\n\ndef get_spreadsheet(key, gid=0):\n    ... (help!) ...\n\nfor row in get_spreadsheet('5a3c7f7dcee4b4f'):\n    cell1, cell2, cell3 = row\n    ...\n</code>\n</pre>\n", "senID": 4}, {"text": ["Please save my face."], "childNum": 0, "tag": "p", "senID": 5, "childList": []}, {"text": ["Update 1: I've tried the following, but no combination of Download() or Export() seems to work.", "(Docs for DocsService here)"], "childNum": 5, "tag": "p", "senID": 6, "childList": [{"text": "Update 1:", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}, {"text": "Download()", "childNum": 0, "tag": "code", "pos": -1, "childList": []}, {"text": "Export()", "childNum": 0, "tag": "code", "pos": -1, "childList": []}, {"text": "DocsService", "childNum": 0, "tag": "code", "pos": 1, "childList": []}, {"href": "http://gdata-python-client.googlecode.com/svn/trunk/pydocs/gdata.docs.service.html", "text": "here", "childNum": 0, "tag": "a", "childList": []}]}, {"code": "<pre>\n<code>\n import gdata.docs.service\nimport getpass\nimport os\nimport tempfile\nimport csv\n\ndef get_csv(file_path):\n  return csv.reader(file(file_path).readlines())\n\ndef get_spreadsheet(key, gid=0):\n  gd_client = gdata.docs.service.DocsService()\n  gd_client.email = 'xxxxxxxxx@gmail.com'\n  gd_client.password = getpass.getpass()\n  gd_client.ssl = False\n  gd_client.source = \"My Fancy Spreadsheet Downloader\"\n  gd_client.ProgrammaticLogin()\n\n  file_path = tempfile.mktemp(suffix='.csv')\n  uri = 'http://docs.google.com/feeds/documents/private/full/%s' % key\n  try:\n    entry = gd_client.GetDocumentListEntry(uri)\n\n    # XXXX - The following dies with RequestError \"Unauthorized\"\n    gd_client.Download(entry, file_path)\n\n    return get_csv(file_path)\n  finally:\n    try:\n      os.remove(file_path)\n    except OSError:\n      pass\n</code>\n</pre>\n", "senID": 7}]