[{"text": ["Making a web interface to a script that takes 30 minutes to execute"], "childNum": 0, "tag": "h2", "senID": 0, "childList": []}, {"text": ["I wrote a python script to process some data from CSV files.", "The script takes between 3 to 30 minutes to complete, depending on the size of the CSV."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"text": ["Now I want to put in a web interface to this, so I can upload the CSV data files from anywhere.", "I wrote a basic HTTP POST upload page and used Python's CGI module - but the script just times out after some time. "], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"text": ["The script outputs HTTP headers at the start, and outputs bits of data after iterating over every line of the CSV.", "As an example, this print statement would trigger every 30 seconds or so."], "childNum": 0, "tag": "p", "senID": 3, "childList": []}, {"code": "<pre>\n<code>\n # at the very top, with the 'import's\nprint \"Content-type: text/html\\n\\n Processing ... &lt;br /&gt;\"\n\n# the really long loop.\nfor currentRecord in csvRecords:\n    count = count + 1\n    print \"On line \" + str(count) + \" &lt;br /&gt;\"\n</code>\n</pre>\n", "senID": 4}, {"text": ["I assumed the browser would receive the headers, and wait since it keeps on receiving little bits of data.", "But what actually seems to happen is it doesn't receive any data at all, and Error 504 times out when given a CSV with lots of lines. "], "childNum": 1, "tag": "p", "senID": 5, "childList": [{"text": "Error 504", "childNum": 0, "tag": "code", "pos": 1, "childList": []}]}, {"text": ["Perhaps there's some caching happening somewhere?", "From the logs,"], "childNum": 0, "tag": "p", "senID": 6, "childList": []}, {"code": "<pre>\n<code>\n [Wed Jan 20 16:59:09 2010] [error] [client ::1] Script timed out before returning headers: datacruncher.py, referer: http://localhost/index.htm\n[Wed Jan 20 17:04:09 2010] [warn] [client ::1] Timeout waiting for output from CGI script /Library/WebServer/CGI-Executables/datacruncher.py, referer: http://localhost/index.htm\n</code>\n</pre>\n", "senID": 7}, {"text": ["What's the best way to resolve this, or, is it not appropriate to run such scripts in a browser?"], "childNum": 0, "tag": "p", "senID": 8, "childList": []}, {"text": ["Edit:\nThis is a script for my own use - I normally intend to use it on my computer, but I thought a web-based interface could come in handy while travelling, or for example from a phone.", "Also, there's really nothing to download - the script will most probably e-mail a report off at the end."], "childNum": 1, "tag": "p", "senID": 9, "childList": [{"text": "Edit:", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}]}]