[[{"text": ["Operating systems are already optimized for such I/O operations.", "So, you can directly write the numbers to file and get a very good speed:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n import tempfile, random\n\nwith tempfile.NamedTemporaryFile(delete=False) as nf:\n    for _ in xrange(1000000):  # xrange() is more efficient than range(), in Python 2\n        nf.write(str(random.randint(0, 1000)))\n</code>\n</pre>\n", "senID": 1}, {"text": ["In practice, the numbers will only be written to the disk when the size-optimized file buffer is full.", "The code in the question and the code above take the same time, on my machine.", "So, I would advise to use the simpler code and to rely on the operating system's built-in optimizations."], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"text": ["If the result fits in memory (which is the case for 1 million numbers), then you can indeed save some I/O operations by creating the final string and then writing it in one go:"], "childNum": 0, "tag": "p", "senID": 3, "childList": []}, {"code": "<pre>\n<code>\n with tempfile.NamedTemporaryFile(delete=False) as nf:\n    nf.write(''.join(str(random.randint(0, 1000)) for _ in xrange(1000000)))\n</code>\n</pre>\n", "senID": 4}, {"text": ["This second approach is 30% faster, on my computer (2.6 s instead of 3.8 s), probably thanks to the single write call (instead of a million write() calls\u2013and probably many fewer actual disk writes)."], "childNum": 1, "tag": "p", "senID": 5, "childList": [{"text": "write()", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"text": ["The \"many big writes\" approach of your question falls in the middle (3.1 s).", "It can be improved, though: it is clearer and more Pythonic to write it like this, though:"], "childNum": 0, "tag": "p", "senID": 6, "childList": []}, {"code": "<pre>\n<code>\n import tempfile, random\n\nwith tempfile.NamedTemporaryFile(delete=False) as nf:\n    for _ in xrange(1000):\n        nf.write(''.join(str(random.randint(0, 1000)) for _ in xrange(1000)))\n</code>\n</pre>\n", "senID": 7}, {"text": ["This solution is equivalent to, but faster than the code in the original question (2.6 s on my machine, instead of 3.8\u00a0s)."], "childNum": 0, "tag": "p", "senID": 8, "childList": []}, {"text": ["In summary, the first, simple approach above might be fast enough for you.", "If it is not and if the whole file can fit in memory, the second approach is both very fast and simple.", "Otherwise, your initial idea (fewer writes, bigger blocks) is good, as it is about as fast as the \"single write\" approach, and still quite simple, when written as above."], "childNum": 0, "tag": "p", "senID": 9, "childList": []}], [{"text": ["Don't use string concatenation in a loop.", "Use str.join instead."], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "str.join", "childNum": 0, "tag": "code", "pos": 1, "childList": []}]}, {"text": ["Your code would look like this:"], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"code": "<pre>\n<code>\n buf = ''.join(str(random.randint(0, 1000)) for j in range(1000))\n</code>\n</pre>\n", "senID": 2}, {"text": ["And note that since you have not specified a separator it will look like this:"], "childNum": 0, "tag": "p", "senID": 3, "childList": []}, {"code": "<pre>\n<code>\n 3847018274193258124003837134....\n</code>\n</pre>\n", "senID": 4}, {"text": ["Change '' to ',' if you want the numbers to be (for example) comma separated."], "childNum": 2, "tag": "p", "senID": 5, "childList": [{"text": "''", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "','", "childNum": 0, "tag": "code", "childList": []}]}, {"text": ["I also don't think you need to buffer yourself as writing to a file should already be buffered."], "childNum": 0, "tag": "p", "senID": 6, "childList": []}], [{"text": ["If you only need to generate some random numbers and you are under linux, try shell command"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n for i in {1..1000000}; do echo $[($RANDOM % 1000)]; done &gt; test.in\n</code>\n</pre>\n", "senID": 1}, {"text": ["ok, i test this code below, it takes about 5 seconds to finish"], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"code": "<pre>\n<code>\n import tempfile, random\n\nnf = tempfile.NamedTemporaryFile(delete=False)\nfor i in xrange(0, 1000000):\n    nf.write(str(random.randint(0, 1000)))\n</code>\n</pre>\n", "senID": 3}], [{"text": ["I am not sure for Python but += is usually an expensive operation as it copies the string to new memory."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["Using some string builder or array that you join is probably much faster."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}], [{"text": ["Like this"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n import random\nimport struct\n\nwith open('binary.dat','wb') as output:\n     for i in xrange(1000000):\n         u = random.randint(0,999999) # number\n         b = struct.pack('i', u) # bytes\n         output.write(b)\n</code>\n</pre>\n", "senID": 1}, {"text": ["This will create 4 million bytes of data.", "1 million 4-byte values.  "], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"text": ["You can read up on struct and the various packing options here: http://docs.python.org/library/struct.html."], "childNum": 2, "tag": "p", "senID": 3, "childList": [{"text": "struct", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"href": "http://docs.python.org/library/struct.html", "text": "http://docs.python.org/library/struct.html", "childNum": 0, "tag": "a", "childList": []}]}], [{"text": ["Doing a million of anything is going to be relatively slow.", "Also, depending on how random you want the numbers, you may want to invest in a more robust random integer generator.", "This is a personal favorite:  http://en.wikipedia.org/wiki/Mersenne_twister"], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "http://en.wikipedia.org/wiki/Mersenne_twister", "tag": "a", "pos": 2, "childList": [], "childNum": 0, "href": "http://en.wikipedia.org/wiki/Mersenne_twister"}]}]]