[[{"text": ["There are two kinds of variables in a class:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"tag": "ul", "num": 2, "lis": [{"text": ["class variables, defined at the class level, and common to all instances"], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"text": ["instance variables, defined within a class method (usually __init__) and qualified by the instance (usually self.", ")."], "childNum": 2, "tag": "p", "senID": 2, "childList": [{"text": "__init__", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "self.", "childNum": 0, "tag": "code", "pos": -1, "childList": []}]}]}, {"text": ["Example"], "childNum": 0, "tag": "p", "senID": 3, "childList": []}, {"code": "<pre>\n<code>\n class SomeClass( object ):\n    classVariable = 0\n    def __init__( self ):\n        self.instanceVariable= 0\n</code>\n</pre>\n", "senID": 4}, {"text": ["The variable named classVariable is part of the class, common to all instances.", "Because of the way Python does search, it's available as a member of self.classVariable, as well as SomeClass.classVariable."], "childNum": 3, "tag": "p", "senID": 5, "childList": [{"text": "classVariable", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "self.classVariable", "childNum": 0, "tag": "code", "pos": 1, "childList": []}, {"text": "SomeClass.classVariable", "childNum": 0, "tag": "code", "childList": []}]}, {"text": ["The variable named instanceVariable is part of the instance (self.", ") and is unique to each instance."], "childNum": 2, "tag": "p", "senID": 6, "childList": [{"text": "instanceVariable", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "self.", "childNum": 0, "tag": "code", "pos": -1, "childList": []}]}, {"text": ["Note.", "There's a third kind, global, but that's not what you're asking about."], "childNum": 0, "tag": "p", "senID": 7, "childList": []}], [{"text": ["Is it fileList you're talking about?", "You have it as a class variable, to make it an instance variable you need to do:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n self.fileList = {'files': [], 'dirs': []}\n</code>\n</pre>\n", "senID": 1}, {"text": ["in you __ init __ function."], "childNum": 0, "tag": "p", "senID": 2, "childList": []}], [{"text": ["Things declared in a class block are class attributes, and class attributes are also accessible through the instance.", "(This principle, in fact, is how methods are bound.", ") Not only that, but default arguments for a function are only evaluated when the function is defined.", "So, to give an example illustrating these two points:"], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "class", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"code": "<pre>\n<code>\n class C(object):\n    list_a = []\n    def __init__(self, list_b=[]):\n        self.list_b = list_b\n\n    def __str__(self):\n        return '%r %r' % (self.list_a, self.list_b)\n\nc1 = C()\nc2 = C()\nc2.list_a = []\nc3 = C([])\n\nc1.list_a.append(1)\nc1.list_b.append(2)\nprint c1\nprint c2\nprint c3\n</code>\n</pre>\n", "senID": 1}, {"text": ["The output for this is:"], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"code": "<pre>\n<code>\n [1] [2]\n[] [2]\n[1] []\n</code>\n</pre>\n", "senID": 3}, {"text": ["c1 and c3 share the same list_a because it's a class attribute; it's not shadowed by an instance attribute like it is on c2.", "c1 and c2 share the same list_b because there is only one list_b default in __init__; a new list isn't created every time the function is called, but passing in your own new list works."], "childNum": 4, "tag": "p", "senID": 4, "childList": [{"text": "list_a", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "list_b", "childNum": 0, "tag": "code", "pos": 1, "childList": []}, {"text": "list_b", "childNum": 0, "tag": "code", "childList": []}, {"text": "__init__", "childNum": 0, "tag": "code", "childList": []}]}], [{"text": ["If you declare your variables outside a class method, inside the body of the class, they will become 'class variables' and be common to all class instances.", "To get instance variables, declare them inside the init function and bind them to 'self', the handler for the current instance."], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "init", "childNum": 0, "tag": "strong", "pos": 1, "childList": []}]}], [{"text": ["As others have pointed out, your problem is that fileList is a class variable which you are mutating."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["However its worth noting another potential pitfall in your code that could lead to a similar problem (though it doesn't in your specific example):"], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"code": "<pre>\n<code>\n def __init__(self, rootDir, ignoreList=[]):\n</code>\n</pre>\n", "senID": 2}, {"text": ["Beware passing mutable parameters (such as this list) as default arguments.", "The list is only created once (when you're defining the __init__ function.", "This means that all instances of the class which have been constructed using the default will use the same list."], "childNum": 1, "tag": "p", "senID": 3, "childList": [{"text": "__init__", "childNum": 0, "tag": "code", "pos": 1, "childList": []}]}, {"text": ["In your example, the list is never modified, so this will not have any repercussions, but if (as you do for fileList) you append to self.ignoreList, then this would affect all such instances, leading to a similar problem to the one you're seeing."], "childNum": 0, "tag": "p", "senID": 4, "childList": []}, {"text": ["This is a very common beginner gotcha - to avoid it, it's a good idea to write such code as something like:"], "childNum": 0, "tag": "p", "senID": 5, "childList": []}, {"code": "<pre>\n<code>\n def __init__(self, rootDir, ignoreList=None):\n    if ignoreList is None:\n        ignoreList = []  # This will create a new empty list for every instance.\n</code>\n</pre>\n", "senID": 6}], [{"text": ["It might be useful if you could post a full working (or failing!", ") example."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["If I do what I think is necessary (i.e., wrap this in Class HashedDir(object): and set self.fileList = {'files': [], 'dirs': []} inside init then it does seem to work."], "childNum": 1, "tag": "p", "senID": 1, "childList": [{"text": "init", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}]}, {"text": ["Which items are you referring to as self.value?", "As per the previous post by sykora, you need to distinguish between code that is run for every instance (in init) and code that is common to all instances."], "childNum": 1, "tag": "p", "senID": 2, "childList": [{"text": "init", "childNum": 0, "tag": "strong", "pos": 1, "childList": []}]}]]