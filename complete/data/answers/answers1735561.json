[[{"text": ["I found shuffle can be abused into solving this"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n from random import shuffle\nL=[\"Anne\",\"Beth\",\"Cath\",\"Dave\",\"Emma\"]\nshuffle(L,int=lambda n:int(n-1))\nprint L\n</code>\n</pre>\n", "senID": 1}, {"text": ["The distribution is not uniform however this was not a requirement."], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"code": "<pre>\n<code>\n #For 100,000 samples\n\n(('Beth', 'Cath', 'Dave', 'Emma', 'Anne'), 13417)\n(('Beth', 'Cath', 'Emma', 'Anne', 'Dave'), 6572)\n(('Beth', 'Dave', 'Anne', 'Emma', 'Cath'), 3417)\n(('Beth', 'Dave', 'Emma', 'Cath', 'Anne'), 6581)\n(('Beth', 'Emma', 'Anne', 'Cath', 'Dave'), 3364)\n(('Beth', 'Emma', 'Dave', 'Anne', 'Cath'), 6635)\n(('Cath', 'Anne', 'Dave', 'Emma', 'Beth'), 1703)\n(('Cath', 'Anne', 'Emma', 'Beth', 'Dave'), 1705)\n(('Cath', 'Dave', 'Beth', 'Emma', 'Anne'), 6583)\n(('Cath', 'Dave', 'Emma', 'Anne', 'Beth'), 3286)\n(('Cath', 'Emma', 'Beth', 'Anne', 'Dave'), 3325)\n(('Cath', 'Emma', 'Dave', 'Beth', 'Anne'), 3421)\n(('Dave', 'Anne', 'Beth', 'Emma', 'Cath'), 1653)\n(('Dave', 'Anne', 'Emma', 'Cath', 'Beth'), 1664)\n(('Dave', 'Cath', 'Anne', 'Emma', 'Beth'), 3349)\n(('Dave', 'Cath', 'Emma', 'Beth', 'Anne'), 6727)\n(('Dave', 'Emma', 'Anne', 'Beth', 'Cath'), 3319)\n(('Dave', 'Emma', 'Beth', 'Cath', 'Anne'), 3323)\n(('Emma', 'Anne', 'Beth', 'Cath', 'Dave'), 1682)\n(('Emma', 'Anne', 'Dave', 'Beth', 'Cath'), 1656)\n(('Emma', 'Cath', 'Anne', 'Beth', 'Dave'), 3276)\n(('Emma', 'Cath', 'Dave', 'Anne', 'Beth'), 6638)\n(('Emma', 'Dave', 'Anne', 'Cath', 'Beth'), 3358)\n(('Emma', 'Dave', 'Beth', 'Anne', 'Cath'), 3346)\n</code>\n</pre>\n", "senID": 3}, {"text": ["For a uniform distribution, this (longer) version can be used"], "childNum": 0, "tag": "p", "senID": 4, "childList": []}, {"code": "<pre>\n<code>\n from random import shuffle,randint\nL=[\"Anne\",\"Beth\",\"Cath\",\"Dave\",\"Emma\"]\nshuffle(L,random=lambda:1,int=lambda n:randint(0,n-2))\nprint L\n\n# For 100,000 samples\n\n(('Beth', 'Cath', 'Dave', 'Emma', 'Anne'), 4157)\n(('Beth', 'Cath', 'Emma', 'Anne', 'Dave'), 4155)\n(('Beth', 'Dave', 'Anne', 'Emma', 'Cath'), 4099)\n(('Beth', 'Dave', 'Emma', 'Cath', 'Anne'), 4141)\n(('Beth', 'Emma', 'Anne', 'Cath', 'Dave'), 4243)\n(('Beth', 'Emma', 'Dave', 'Anne', 'Cath'), 4208)\n(('Cath', 'Anne', 'Dave', 'Emma', 'Beth'), 4219)\n(('Cath', 'Anne', 'Emma', 'Beth', 'Dave'), 4087)\n(('Cath', 'Dave', 'Beth', 'Emma', 'Anne'), 4117)\n(('Cath', 'Dave', 'Emma', 'Anne', 'Beth'), 4127)\n(('Cath', 'Emma', 'Beth', 'Anne', 'Dave'), 4198)\n(('Cath', 'Emma', 'Dave', 'Beth', 'Anne'), 4210)\n(('Dave', 'Anne', 'Beth', 'Emma', 'Cath'), 4179)\n(('Dave', 'Anne', 'Emma', 'Cath', 'Beth'), 4119)\n(('Dave', 'Cath', 'Anne', 'Emma', 'Beth'), 4143)\n(('Dave', 'Cath', 'Emma', 'Beth', 'Anne'), 4203)\n(('Dave', 'Emma', 'Anne', 'Beth', 'Cath'), 4252)\n(('Dave', 'Emma', 'Beth', 'Cath', 'Anne'), 4159)\n(('Emma', 'Anne', 'Beth', 'Cath', 'Dave'), 4193)\n(('Emma', 'Anne', 'Dave', 'Beth', 'Cath'), 4177)\n(('Emma', 'Cath', 'Anne', 'Beth', 'Dave'), 4087)\n(('Emma', 'Cath', 'Dave', 'Anne', 'Beth'), 4150)\n(('Emma', 'Dave', 'Anne', 'Cath', 'Beth'), 4268)\n(('Emma', 'Dave', 'Beth', 'Anne', 'Cath'), 4109)\n</code>\n</pre>\n", "senID": 5}, {"text": ["How it works"], "childNum": 1, "tag": "p", "senID": 6, "childList": [{"text": "How it works", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}]}, {"text": ["Here is the code for random.shuffle()"], "childNum": 1, "tag": "p", "senID": 7, "childList": [{"text": "random.shuffle()", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"code": "<pre>\n<code>\n def shuffle(self, x, random=None, int=int):\n    \"\"\"x, random=random.random -&gt; shuffle list x in place; return None.\n\n    Optional arg random is a 0-argument function returning a random\n    float in [0.0, 1.0); by default, the standard random.random.\n    \"\"\"\n\n    if random is None:\n        random = self.random\n    for i in reversed(xrange(1, len(x))):\n        # pick an element in x[:i+1] with which to exchange x[i]\n        j = int(random() * (i+1))\n        x[i], x[j] = x[j], x[i]\n</code>\n</pre>\n", "senID": 8}, {"text": ["Both solutions work by targeting the line j = int(random() * (i+1))"], "childNum": 1, "tag": "p", "senID": 9, "childList": [{"text": "j = int(random() * (i+1))", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"text": ["The first(non uniform) effectively makes the line work like this"], "childNum": 0, "tag": "p", "senID": 10, "childList": []}, {"code": "<pre>\n<code>\n j = int(random() *(i+1)-1)\n</code>\n</pre>\n", "senID": 11}, {"text": ["So instead of a range of (1..i) we obtain (0..i-1)"], "childNum": 0, "tag": "p", "senID": 12, "childList": []}, {"text": ["The second solution replaces random() with a function that always returns 1, and uses randint instead of int.", "So the line now works like this"], "childNum": 1, "tag": "p", "senID": 13, "childList": [{"text": "random()", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"code": "<pre>\n<code>\n j = randint(0,i-1)\n</code>\n</pre>\n", "senID": 14}], [{"text": ["After shuffling the list of numbers, let the [i]th person write a poem (and buy a present!", ") for the [i+1]th person in the list: that way, there can never be someone who draws him- or herself.", "Of course, the last one should point to the first..."], "childNum": 2, "tag": "p", "senID": 0, "childList": [{"text": "[i]", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "[i+1]", "childNum": 0, "tag": "code", "pos": 1, "childList": []}]}], [{"text": ["Shifting every element in the list by one in a circular manner, as suggested by Bart, is easy:"], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "as suggested by Bart", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://stackoverflow.com/questions/1735561/oneliner-scramble-program/1735584#1735584"}]}, {"code": "<pre>\n<code>\n &gt;&gt;&gt; def shift(seq):\n...     return seq[-1:] + seq[:-1]\n... \n&gt;&gt;&gt; shift(range(10))\n[9, 0, 1, 2, 3, 4, 5, 6, 7, 8]\n</code>\n</pre>\n", "senID": 1}, {"text": ["As for a random solution: in this case the request for a one-liner is not such a good idea, since the obvious function to use, namely random.shuffle, performs its task in place.", "In other words: it has a side effect, something one usually tries to avoid in list comprehensions.", "There is a way around this though, as Paul points out, namely by using random.sample.", "The following code shows two one-liners which use these functions (note the use of not shuffle, to work around the fact that shuffle returns None...):"], "childNum": 10, "tag": "p", "senID": 2, "childList": [{"text": "As for a random solution", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}, {"text": "random.shuffle", "tag": "a", "pos": -1, "childList": [{"text": "random.shuffle", "tag": "code"}], "childNum": 1, "href": "http://docs.python.org/3.1/library/random.html#random.shuffle"}, {"text": "random.shuffle", "childNum": 0, "tag": "code", "pos": -1, "childList": []}, {"text": "side effect", "childNum": 0, "tag": "em", "pos": 1, "childList": []}, {"text": "Paul", "tag": "a", "pos": 2, "childList": [], "childNum": 0, "href": "http://stackoverflow.com/users/170701/paul"}, {"text": "random.sample", "tag": "a", "pos": -1, "childList": [{"text": "random.sample", "tag": "code"}], "childNum": 1, "href": "http://docs.python.org/3.1/library/random.html#random.sample"}, {"text": "random.sample", "childNum": 0, "tag": "code", "pos": -1, "childList": []}, {"text": "not shuffle", "childNum": 0, "tag": "code", "pos": 3, "childList": []}, {"text": "shuffle", "childNum": 0, "tag": "code", "childList": []}, {"text": "None", "childNum": 0, "tag": "code", "childList": []}]}, {"code": "<pre>\n<code>\n &gt;&gt;&gt; from itertools import repeat\n&gt;&gt;&gt; from random import shuffle\n&gt;&gt;&gt; def shake_it(seq):\n...     return next(c for c in repeat(seq[::]) if not shuffle(c) and all(a != b for a, b in zip(seq, c)))\n... \n&gt;&gt;&gt; shake_it(range(10))\n[7, 9, 0, 2, 6, 8, 5, 1, 4, 3]\n&gt;&gt;&gt; \n&gt;&gt;&gt; from itertools import count\n&gt;&gt;&gt; from random import sample\n&gt;&gt;&gt; def shake_it(seq):\n...     return next(c for c in (sample(seq, len(seq)) for _ in count()) if all(a != b for a, b in zip(seq, c)))\n... \n&gt;&gt;&gt; shake_it(range(10))\n[1, 3, 9, 5, 2, 6, 8, 4, 0, 7]\n</code>\n</pre>\n", "senID": 3}, {"text": ["Myself, I'd go with this one:"], "childNum": 0, "tag": "p", "senID": 4, "childList": []}, {"code": "<pre>\n<code>\n &gt;&gt;&gt; def shake_it(seq):\n...     res = seq[::]\n...     while any(a == b for a, b in zip(res, seq)):\n...         shuffle(res)\n...     return res\n... \n&gt;&gt;&gt; shake_it(range(10))\n[5, 7, 9, 2, 6, 8, 3, 0, 4, 1]\n</code>\n</pre>\n", "senID": 5}], [{"text": ["My first Python program in a long while.", "Unlike many of the above programs, this one takes O(n) time."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n s = set(range(10))\nr = list()\nfor i in range(10):\n    s2 = s - set([i])\n    val = s2.pop()\n    r.append(val)\n    s.discard(val)\n\nprint r\n</code>\n</pre>\n", "senID": 1}, {"text": ["UPDATE: Paul showed that the above program was incorrect.", "Thanks, Paul.", "Here's a different, better version of the same program:"], "childNum": 1, "tag": "p", "senID": 2, "childList": [{"text": "UPDATE", "childNum": 0, "tag": "em", "pos": 0, "childList": []}]}, {"code": "<pre>\n<code>\n s = range(10)\nfor i in range(9):\n    r = random.randrange(i+1, 10)\n    s[i], s[r] = s[r], s[i]\n\nprint s\n</code>\n</pre>\n", "senID": 3}], [{"text": ["Here is how you do it with O(n) time and O(1) extra memory:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["Comprehensible code:"], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"code": "<pre>\n<code>\n def shuffle(a)\n  n = a.length\n  (0..n - 2).each do |i|\n    r = rand(n - i - 1) + i + 1\n    a[r], a[i] = a[i], a[r]\n  end\n  a\nend\n</code>\n</pre>\n", "senID": 2}, {"text": ["A one-liner (assumes \"a\" is the array):"], "childNum": 0, "tag": "p", "senID": 3, "childList": []}, {"code": "<pre>\n<code>\n n = a.length and (0..n - 2).each {|i| r = rand(n - i - 1) + i + 1; a[r], a[i] = a[i], a[r]}\n</code>\n</pre>\n", "senID": 4}, {"text": ["The code is in ruby, but without any doubt it's easily translatable to python"], "childNum": 0, "tag": "p", "senID": 5, "childList": []}, {"text": ["Cheers"], "childNum": 0, "tag": "p", "senID": 6, "childList": []}, {"text": ["P.S.", ": The solution modifies the array."], "childNum": 0, "tag": "p", "senID": 7, "childList": []}], [{"text": ["\"One-liner\" in fixed O(n) time:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n import random; a=range(10)  # setup (could read in names instead)\nfor i in range(len(a)-1,0,-1): j=random.randint(0,i-1); a[j],a[i]=a[i],a[j]\nprint a  # output\n</code>\n</pre>\n", "senID": 1}, {"text": ["The loop picks elements from the maximum index (len(a)-1) down to the next-smallest (1).", "The choice pool for element k only includes indices from 0 to k-1; once picked, an element will not be moved again."], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"text": ["After the scramble, no element can reside in its original position, because:"], "childNum": 0, "tag": "p", "senID": 3, "childList": []}, {"tag": "ul", "num": 3, "lis": [{"text": "if element j is picked for some slot i>j, it will stay there", "tag": "none", "senID": 4}, {"text": "otherwise, element j will be swapped with some other element from slot i&lt;j, which will stay there", "tag": "none", "senID": 5}, {"text": "except for the element in slot 0, which will be swapped unconditionally with the element in slot 1 (in the final iteration of the loop) if it has not already been displaced.", "tag": "none", "senID": 6}]}, {"text": ["[edit: this is logically equivalent to the Ruby answer, I think]"], "childNum": 0, "tag": "p", "senID": 7, "childList": []}], [{"text": ["This one is O(N).", "Having the import in the loops is a bit silly, but you wanted a one liner"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n L=range(10)\nfor i in range(1,len(L)):import random;r=random.randint(0,i-1);L[i],L[r]=L[r],L[i]\nprint L\n</code>\n</pre>\n", "senID": 1}, {"text": ["Here is the output distribution when L=range(5) for 100000 samples"], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"code": "<pre>\n<code>\n ((1, 2, 3, 4, 0), 4231)\n((1, 2, 4, 0, 3), 4115)\n((1, 3, 0, 4, 2), 4151)\n((1, 3, 4, 2, 0), 4108)\n((1, 4, 0, 2, 3), 4254)\n((1, 4, 3, 0, 2), 4101)\n((2, 0, 3, 4, 1), 4158)\n((2, 0, 4, 1, 3), 4177)\n((2, 3, 1, 4, 0), 4190)\n((2, 3, 4, 0, 1), 4117)\n((2, 4, 1, 0, 3), 4194)\n((2, 4, 3, 1, 0), 4205)\n((3, 0, 1, 4, 2), 4325)\n((3, 0, 4, 2, 1), 4109)\n((3, 2, 0, 4, 1), 4131)\n((3, 2, 4, 1, 0), 4153)\n((3, 4, 0, 1, 2), 4081)\n((3, 4, 1, 2, 0), 4118)\n((4, 0, 1, 2, 3), 4294)\n((4, 0, 3, 1, 2), 4167)\n((4, 2, 0, 1, 3), 4220)\n((4, 2, 3, 0, 1), 4179)\n((4, 3, 0, 2, 1), 4090)\n((4, 3, 1, 0, 2), 4132)\n</code>\n</pre>\n", "senID": 3}], [{"text": ["Sorry this isn't a one-liner, but this works"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n import random\ndef sinterklaas(n):\n    l=[]\n    for a in range(n):\n        l.append(-1)\n\n    i = 0\n    while i &lt; 10:\n        index = random.randint(0,n-1)\n        if l[index] == -1 and index != i:\n        l[index] = i\n            i += 1\n</code>\n</pre>\n", "senID": 1}, {"text": ["Cheers"], "childNum": 0, "tag": "p", "senID": 2, "childList": []}], [{"code": "<pre>\n<code>\n import random; u = range(10)\nwhile sum(u[i]==i for i in range(10)): random.shuffle(u)\n</code>\n</pre>\n", "senID": 0}, {"text": ["(Ok, I have a line 0 in there too...)"], "childNum": 0, "tag": "p", "senID": 1, "childList": []}], [{"text": ["For one in O(n):"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n u=range(10); random.shuffle(u); v=[ u[u[i]] for i in range(10) ]; return [ v[(u[i]+1)%10] for i in u ]\n</code>\n</pre>\n", "senID": 1}, {"text": ["u is the inverse of function v, so v[u[i]+1] is effectively the element following i in array v."], "childNum": 4, "tag": "p", "senID": 2, "childList": [{"text": "u", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "v", "childNum": 0, "tag": "code", "childList": []}, {"text": "v[u[i]+1]", "childNum": 0, "tag": "code", "childList": []}, {"text": "v", "childNum": 0, "tag": "code", "childList": []}]}], [{"text": ["Here's Stephan202's circular shift implemented as a one-liner with a randomly-chosen shift increment:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n from random import randrange; s = range(10); r = randrange(1,len(s)-1); print s[-r:] + s[:-r]\n</code>\n</pre>\n", "senID": 1}]]