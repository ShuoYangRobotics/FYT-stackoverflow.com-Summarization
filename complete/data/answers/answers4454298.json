[[{"text": ["Python makes a lot of things easy and contains libraries and wrappers for a lot of common operations, but the goal is not to hide fundamental truths."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["The fundamental truth you are encountering here is that you generally can't prepend data to an existing flat structure without rewriting the entire structure.", "This is true regardless of language."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"text": ["There are ways to save a filehandle or make your code less readable, many of which are provided in other answers, but none change the fundamental operation: You must read in the existing file, then write out the data you want to prepend, followed by the existing data you read in."], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"text": ["By all means save yourself the filehandle, but don't go looking to pack this operation into as few lines of code as possible.", "In fact, never go looking for the fewest lines of code -- that's obfuscation, not programming."], "childNum": 0, "tag": "p", "senID": 3, "childList": []}], [{"text": ["You can save one write call with this:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n f.write('#testfirstline\\n' + temp)\n</code>\n</pre>\n", "senID": 1}, {"text": ["When using 'r+', you would have to rewind the file after reading and before writing."], "childNum": 0, "tag": "p", "senID": 2, "childList": []}], [{"text": ["The shortest way I would do this while still maintaining readability is:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n with open('filename', 'rw') as testfile:\n    testfile.writelines(['first line'] + testfile.readlines())\n</code>\n</pre>\n", "senID": 1}], [{"text": ["I would stick with separate reads and writes, but we certainly can express each more concisely:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n with file('filename', 'r') as original: data = original.read()\nwith file('filename', 'w') as modified: modified.write(\"new first line\\n\" + data)\n</code>\n</pre>\n", "senID": 1}], [{"code": "<pre>\n<code>\n with open(\"file\", \"r+\") as f: s = f.read(); f.seek(0); f.write(\"prepend\\n\" + s)\n</code>\n</pre>\n", "senID": 0}], [{"text": ["One possibility is the following:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n import os\nopen('tempfile', 'w').write('#testfirstline\\n' + open('filename', 'r').read())\nos.rename('tempfile', 'filename')\n</code>\n</pre>\n", "senID": 1}], [{"text": ["Other approach:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n with open(\"infile\") as f1:\n    with open(\"outfile\", \"w\") as f2:\n        f2.write(\"#test firstline\")\n        for line in f1:\n            f2.write(line)\n</code>\n</pre>\n", "senID": 1}, {"text": ["or a one liner:"], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"code": "<pre>\n<code>\n open(\"outfile\", \"w\").write(\"#test firstline\\n\" + open(\"infile\").read())\n</code>\n</pre>\n", "senID": 3}, {"text": ["Thanks for the opportunity to think about this problem :)"], "childNum": 0, "tag": "p", "senID": 4, "childList": []}, {"text": ["Cheers"], "childNum": 0, "tag": "p", "senID": 5, "childList": []}]]