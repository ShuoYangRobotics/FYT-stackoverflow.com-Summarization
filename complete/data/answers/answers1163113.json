[[{"text": ["I recommend that when you come up with a question about Django internals, you take a look at the source."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["If we look at the start of post_comment view we see that the POST querydict is copied and the user's email and name are inserted.", "They are still required (as seen in the form's source), so these details must either entered in the form or the user must provide them."], "childNum": 2, "tag": "p", "senID": 1, "childList": [{"text": "start of post_comment view", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://code.djangoproject.com/browser/django/trunk/django/contrib/comments/views/comments.py#L32"}, {"text": "form's source", "tag": "a", "pos": 1, "childList": [], "childNum": 0, "href": "http://code.djangoproject.com/browser/django/trunk/django/contrib/comments/views/comments.py#L32"}]}, {"text": ["To answer your question to Superjoe, the view attaches the user to the comment before it is saved (as seen near the end of the post_comment view)."], "childNum": 1, "tag": "p", "senID": 2, "childList": [{"text": "near the end of the post_comment view", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://code.djangoproject.com/browser/django/trunk/django/contrib/comments/views/comments.py#L94"}]}], [{"text": ["WordPress and other systems make this a no-brainer.", "If you're logged in, the comment form should just \"do the right thing\" and remove the name/email/url fields.", "Isn't this exactly the kind of heavy lifting a framework is supposed to do for you? "], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["Rather than dancing around with subclassing models for something that should be trivially easy, I find it simpler to build the form manually in the template and provide the hidden field values it needs.", "This works perfectly for sites that only accept comments from authenticated users:"], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"code": "<pre>\n<code>\n {% if user.is_authenticated %}\n{% get_comment_form for [object] as form %} \n&lt;form action=\"{% comment_form_target %}\" method=\"POST\"&gt; \n    {% csrf_token %}\n    {{ form.comment }} \n    {{ form.honeypot }} \n    {{ form.content_type }} \n    {{ form.object_pk }} \n    {{ form.timestamp }} \n    {{ form.security_hash }} \n    &lt;input type=\"hidden\" name=\"next\" value=\"{% url [the_view] [object].id %}\" /&gt;\n    &lt;input type=\"submit\" value=\"Add comment\" id=\"id_submit\" /&gt; \n&lt;/form&gt; \n{% else %}\n    &lt;p&gt;Please &lt;a href=\"{% url auth_login %}\"&gt;log in&lt;/a&gt; to leave a comment.&lt;/p&gt;\n{% endif %}\n</code>\n</pre>\n", "senID": 2}, {"text": ["Note that this will leave the honeypot field visible; you'll want to hide it in your CSS:"], "childNum": 0, "tag": "p", "senID": 3, "childList": []}, {"code": "<pre>\n<code>\n #id_honeypot {\n    visibility:hidden;\n}\n</code>\n</pre>\n", "senID": 4}, {"text": ["If you want to enable comments either for anonymous or authenticated users, replace the auth_login line above with a standard call to a comment form."], "childNum": 0, "tag": "p", "senID": 5, "childList": []}], [{"text": ["Use a Profile model for extra account data besides user name and password.", "You can call user.get_profile() if you include this line in Profile:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n user = models.ForeignKey(User, unique=True)\n</code>\n</pre>\n", "senID": 1}, {"text": ["and this line in settings.py:"], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"code": "<pre>\n<code>\n AUTH_PROFILE_MODULE = 'yourapp.Profile'\n</code>\n</pre>\n", "senID": 3}], [{"text": ["First off, the comments app already supports both authenticated and anonymous users, so I assume you want to accept comments from authenticated users only?"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["Thejaswi Puthraya had a series of articles on his blog addressing this.", "Basically, he pre-populates the name and email fields in the comment form and replaces them with hidden fields, then defines a wrapper view around post_comment to ensure the user posting the comment is the same as the logged-in user, among other things.", "Seemed pretty straightforward, though maybe a tad tedious."], "childNum": 5, "tag": "p", "senID": 1, "childList": [{"text": "series", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://thejaswi.info/blog/2008/11/19/part-1-django-comments-authenticated-users/"}, {"text": "articles", "tag": "a", "pos": -1, "childList": [], "childNum": 0, "href": "http://thejaswi.info/blog/2008/11/20/part-2-django-comments-authenticated-users/"}, {"text": "name", "childNum": 0, "tag": "code", "pos": 1, "childList": []}, {"text": "email", "childNum": 0, "tag": "code", "pos": -1, "childList": []}, {"text": "post_comment", "childNum": 0, "tag": "code", "pos": -1, "childList": []}]}, {"text": ["His blog seems to be down presently...hopefully it's only temporary."], "childNum": 0, "tag": "p", "senID": 2, "childList": []}], [{"text": ["Theju wrote an authenticated comments app \u2014 http://thejaswi.info/tech/blog/2009/08/04/reusable-app-authenticated-comments/"], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "http://thejaswi.info/tech/blog/2009/08/04/reusable-app-authenticated-comments/", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://thejaswi.info/tech/blog/2009/08/04/reusable-app-authenticated-comments/"}]}], [{"text": ["According to the comment, it's either-or: the other fields are meant to be used when user isn't set.", "Have you checked that the relevant columns are definitely NOT NULL?", "They're marked as blank=True which normally means required=False at the field level.", "If you have actually tried it, what errors are you getting?"], "childNum": 4, "tag": "p", "senID": 0, "childList": [{"text": "user", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "isn't", "childNum": 0, "tag": "em", "pos": -1, "childList": []}, {"text": "blank=True", "childNum": 0, "tag": "code", "pos": 2, "childList": []}, {"text": "required=False", "childNum": 0, "tag": "code", "pos": -1, "childList": []}]}]]