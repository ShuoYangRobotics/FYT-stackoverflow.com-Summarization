[[{"text": ["If you're not bound to a specific language you could have a look at AutoIt which is made especially for things like this.", "I had good experiences with it for automating things like mouseclicks or keystrokes."], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "AutoIt", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://www.autoitscript.com/autoit3/"}]}], [{"text": ["You do not decide what delay setting between mouse down and mouse up results in a valid single click, the operating system does."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["No sleep function can guarantee the timing between the mouse down and mouse up events you want.", "Perl's Win32::GuiTest module allows you to send an actual click event rather than messing with the timing of down and up events.", "Later: Looking at the source code, Win32::GuiTest seems to just fire mouse down and up events without any delay between them see GuiTest.pm:"], "childNum": 4, "tag": "p", "senID": 1, "childList": [{"text": "sleep", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "Win32::GuiTest", "tag": "a", "pos": 1, "childList": [], "childNum": 0, "href": "http://search.cpan.org/~karasik/Win32-GuiTest-1.56/"}, {"text": "Later:", "childNum": 0, "tag": "strong", "pos": 2, "childList": []}, {"href": "http://cpansearch.perl.org/src/KARASIK/Win32-GuiTest-1.56/lib/Win32/GuiTest.pm", "text": "see GuiTest.pm", "childNum": 0, "tag": "a", "childList": []}]}, {"code": "<pre>\n<code>\n elsif ( $item =~ /leftclick/i ) {\n    SendLButtonDown ();\n    SendLButtonUp ();\n}\n</code>\n</pre>\n", "senID": 2}, {"text": ["In addition, http://msdn.microsoft.com/en-us/library/ms646260(VS.85).aspx states that mouse_event has been superseded by SendInput http://msdn.microsoft.com/en-us/library/ms646310(VS.85).aspx which allows you to send a MOUSEINPUT event with timestamps etc."], "childNum": 5, "tag": "p", "senID": 3, "childList": [{"text": "http://msdn.microsoft.com/en-us/library/ms646260(VS.85).aspx", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://msdn.microsoft.com/en-us/library/ms646260(VS.85).aspx"}, {"text": "mouse_event", "childNum": 0, "tag": "code", "childList": []}, {"text": "SendInput", "childNum": 0, "tag": "code", "childList": []}, {"href": "http://msdn.microsoft.com/en-us/library/ms646310(VS.85).aspx", "text": "http://msdn.microsoft.com/en-us/library/ms646310(VS.85).aspx", "childNum": 0, "tag": "a", "childList": []}, {"text": "MOUSEINPUT", "childNum": 0, "tag": "code", "childList": []}]}], [{"text": ["What function(s) are you using to accomplish this?"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["I'd expect SendInput with a chain of 2 passed in MOUSEINPUT structures (one button down, the other button up) would pull this off for you.", "You can even play games with the timestamps on the faked events to more deterministic behavior than you'll get with sleep()."], "childNum": 1, "tag": "p", "senID": 1, "childList": [{"text": "SendInput", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://msdn.microsoft.com/en-us/library/ms646310.aspx"}]}, {"text": ["There's no CLICK to send, as its the responsibility of an application to collapse low level events (mouse move, button down, button up, key down, key up, etc.", ") into \"user level\" events."], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"tag": "hr", "senID": 3}, {"text": ["Some code, to clarify.", "This is straight-up untested/compiled C (read: the bad kind of C), but  I hope it illustrates my point."], "childNum": 0, "tag": "p", "senID": 4, "childList": []}, {"code": "<pre>\n<code>\n LPINPUT events = (LPINPUT)malloc(sizeof(INPUT) * 2);\n\nevents[0].type = INPUT_MOUSE;\nevents[0].mi.dwFlags = MOUSEEVENTF_LEFTDOWN;\nevents[0].mi.time = 0; //Here, you can play with timestamps (milliseconds)\nevents[1].type = INPUT_MOUSE;\nevents[1].mi.dwFlags = MOUSEEVENTF_LEFTUP;\nevents[1].mi.time = 0; //Likewise\n\n//Push both events into the event queue\nSendInput(2, events, sizeof(INPUT));\n</code>\n</pre>\n", "senID": 5}, {"text": ["I have zero Ruby experience, so I don't know how you'd interop this for your case."], "childNum": 0, "tag": "p", "senID": 6, "childList": []}], [{"text": ["I guess 2 things:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}], [{"text": ["Since the Windows API supports sleeping down to 1 millisecond, why not just sleep a shorter time?", "0.01 seconds should be enough?"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}], [{"text": ["I'd use AutoHotKey.", "It's open source and free, been around a long time and actively maintained, to the point that others have built an IDE for it.", "I use it for generating unique random test data for form testing but it does mouse stuff too. "], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["http://www.autohotkey.com/"], "childNum": 1, "tag": "p", "senID": 1, "childList": [{"text": "http://www.autohotkey.com/", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://www.autohotkey.com/"}]}]]