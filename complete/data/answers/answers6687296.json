[[{"text": ["The first thing to note is that what you have written is not the sieve of eratosthenes.", "Look how many loops a totally naive sieve of eratosthenes executes:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n def sieve1(n):\n    loops = 0\n    numbers = set(range(2, n))\n    for i in range(2, int(n ** 0.5) + 1):\n        for j in range(i * 2, n, i):\n            numbers.discard(j)\n            loops += 1\n    return sorted(numbers), loops\n</code>\n</pre>\n", "senID": 1}, {"text": ["Tested:"], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"code": "<pre>\n<code>\n &gt;&gt;&gt; sieve1(100)\n([2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, \n  43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97], \n 178)\n</code>\n</pre>\n", "senID": 3}, {"text": ["178 loops for 100 numbers (not including the sort).", "This can be improved with a few minor changes:"], "childNum": 0, "tag": "p", "senID": 4, "childList": []}, {"code": "<pre>\n<code>\n def sieve2(n):\n    loops = 0\n    numbers = range(0, n)\n    for prime in numbers:\n        if prime &lt; 2:\n            continue\n        elif prime &gt; n ** 0.5:\n            break\n        for i in range(prime ** 2, n, prime):\n            numbers[i] = 0\n            loops += 1\n    return [x for x in numbers if x &gt; 1], loops\n</code>\n</pre>\n", "senID": 5}, {"text": ["Tested:"], "childNum": 0, "tag": "p", "senID": 6, "childList": []}, {"code": "<pre>\n<code>\n &gt;&gt;&gt; sieve2(100)\n([2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, \n  43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97], \n 102)\n</code>\n</pre>\n", "senID": 7}, {"text": ["102 loops for 100 numbers (not including the filter at the end).", "Now look at yours:"], "childNum": 0, "tag": "p", "senID": 8, "childList": []}, {"code": "<pre>\n<code>\n def sieve3(n):\n    loops = 0\n    numbers = range(2, n)\n    for i in numbers:\n        for j in numbers:\n            if j != i and j % i == 0:\n                numbers.remove(j)\n            loops += 1\n    return numbers, loops\n</code>\n</pre>\n", "senID": 9}, {"text": ["Tested:"], "childNum": 0, "tag": "p", "senID": 10, "childList": []}, {"code": "<pre>\n<code>\n &gt;&gt;&gt; sieve3(100)\n([2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, \n  43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97], \n 663)\n</code>\n</pre>\n", "senID": 11}, {"text": ["It gets worse:"], "childNum": 0, "tag": "p", "senID": 12, "childList": []}, {"code": "<pre>\n<code>\n &gt;&gt;&gt; [sieve1(x)[1] for x in [100, 1000, 10000]]\n[178, 2978, 41723]\n&gt;&gt;&gt; [sieve2(x)[1] for x in [100, 1000, 10000]]\n[102, 1409, 16979]\n&gt;&gt;&gt; [sieve3(x)[1] for x in [100, 1000, 10000]]\n[663, 28986, 1523699]\n</code>\n</pre>\n", "senID": 13}, {"text": ["At n = 10000, your implementation does almost 100x as much work!"], "childNum": 1, "tag": "p", "senID": 14, "childList": [{"text": "n = 10000", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"text": ["My suggestion would be to create a sensible implementation before making it \"compact.", "\" Code golf can be fun, but it's nowhere near as challenging or as edifying as writing efficient code, whatever the length. "], "childNum": 1, "tag": "p", "senID": 15, "childList": [{"text": "efficient", "childNum": 0, "tag": "em", "pos": 1, "childList": []}]}, {"text": ["That said, consider this one-liner (if you don't count the import, which you could get rid of by using lambda x, y: x - y in place of operator.sub).", "This implements the first algorithm with a small improvement:"], "childNum": 2, "tag": "p", "senID": 16, "childList": [{"text": "lambda x, y: x - y", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "operator.sub", "childNum": 0, "tag": "code", "pos": -1, "childList": []}]}, {"code": "<pre>\n<code>\n &gt;&gt;&gt; from operator import sub\n&gt;&gt;&gt; reduce(sub, (set(range(x ** 2, 100, x)) for x in range(2, int(100 ** 0.5) + 1)), set(range(2, 100)))\nset([2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97])\n</code>\n</pre>\n", "senID": 17}], [{"text": ["It's not precisely a direct translation of your loops, but it's quite close and compact:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n &gt;&gt;&gt; l = range(2, 101)\n&gt;&gt;&gt; sorted(set(l).difference(a for i in l for a in l if a!=i and a%i == 0))\n[2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97]\n</code>\n</pre>\n", "senID": 1}, {"text": ["Although I'd suggest a &gt; i rather than a != 0 as being shorter and faster ;)"], "childNum": 2, "tag": "p", "senID": 2, "childList": [{"text": "a &gt; i", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "a != 0", "childNum": 0, "tag": "code", "childList": []}]}], [{"text": ["You are not doing the Sieve of Eratosthenes; the danger of not properly implementing the algorithm is that it will be extremely slow.", "Try your algorithm on 10**6 for example."], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "10**6", "childNum": 0, "tag": "code", "pos": 1, "childList": []}]}, {"text": ["Shortest implementation of the bounded Sieve of Eratosthenes I can come up with:"], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"code": "<pre>\n<code>\n def primes(upTo):\n    isPrime = [True for _ in range(upTo)]\n    yield 2\n    for p in range(3,upTo,2):\n        if isPrime[p]:\n            yield p\n            for multiple in range(p,upTo,p):\n                isPrime[multiple] = False\n</code>\n</pre>\n", "senID": 2}, {"text": ["Demo:"], "childNum": 0, "tag": "p", "senID": 3, "childList": []}, {"code": "<pre>\n<code>\n &gt;&gt;&gt; list(primes(29))\n[2, 3, 5, 7, 11, 13, 17, 19, 23]\n</code>\n</pre>\n", "senID": 4}, {"text": ["It's actually rather succinct, if you ignore linebreaks and the massive skip-even-numbers optimization:"], "childNum": 0, "tag": "p", "senID": 5, "childList": []}, {"code": "<pre>\n<code>\n isPrime=[True]*upTo for p in range(2,upTo): if isPrime[p]: yield p for m in range(p,upTo,p): isPrime[m]=False\n</code>\n</pre>\n", "senID": 6}], [{"text": ["The following one-liner is not related at all to your code:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n def primes(n):\n    return set(range(2,n))-{c for i in range(2,n) for c in range(2*i,n,i)}\n</code>\n</pre>\n", "senID": 1}, {"text": ["Like your code, this is still not really the Sieve of Eratosthenes because, for example, it will futilely try to cross off multiples of 6 and 9 etc.", "Nevertheless it still runs significantly faster than most other Sieve look-alikes for values less than a million or more, since for small N there are \"about as many\" primes as non-primes (the fraction of numbers &lt; N that are prime is 1/log(N))."], "childNum": 4, "tag": "p", "senID": 2, "childList": [{"text": "not really", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}, {"text": "6", "childNum": 0, "tag": "code", "pos": -1, "childList": []}, {"text": "9", "childNum": 0, "tag": "code", "pos": -1, "childList": []}, {"text": "1/log(N)", "childNum": 0, "tag": "code", "pos": 1, "childList": []}]}, {"text": ["Heavily modified from source, possibly less efficient than original: http://codeblog.dhananjaynene.com/2011/06/10-python-one-liners-to-impress-your-friends/"], "childNum": 1, "tag": "p", "senID": 3, "childList": [{"text": "http://codeblog.dhananjaynene.com/2011/06/10-python-one-liners-to-impress-your-friends/", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://codeblog.dhananjaynene.com/2011/06/10-python-one-liners-to-impress-your-friends/"}]}], [{"text": ["Here's a simple demonstration of the sieve.", "Note that lambda isn't used as the filtering function, because the prime number needs to bound at definition time.", "Also of interest is that it's efficient in the sense of not duplicating divisions, but in the long run it could lead to you-know-what."], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "you-know-what", "tag": "a", "pos": 2, "childList": [], "childNum": 0, "href": "http://en.wikipedia.org/wiki/Stack_overflow"}]}, {"code": "<pre>\n<code>\n import itertools\n\ndef primes():\n    ints = itertools.count(2)\n    while True:\n        p = next(ints)\n        yield p\n        ints = itertools.ifilter(p.__rmod__, ints)\n\nprint list(itertools.islice(primes(), 10))\n# [2, 3, 5, 7, 11, 13, 17, 19, 23, 29]\n</code>\n</pre>\n", "senID": 1}], [{"code": "<pre>\n<code>\n def sieve(n):\n    sieve_list = range(n)\n    zero_list = [0] * n\n    for i in range(2, int(n**.5) + 1):\n        if sieve_list[i]:\n            sieve_list[2*i:n:i] = zero_list[2*i:n:i]\n    return filter(None, sieve_list)[1:]\n</code>\n</pre>\n", "senID": 0}]]