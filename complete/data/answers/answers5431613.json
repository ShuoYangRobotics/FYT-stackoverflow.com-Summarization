[[{"text": ["A simpler approach is to build a tuple of the conditions and compare the tuples:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n def site_info(s):\n    return s.getId(), s.getName(), s.getCustomer().getId()\n\nif site_info(site) == site_info(site_listing):\n    return site_listing\nelse:\n    continue\n</code>\n</pre>\n", "senID": 1}, {"text": ["If you have a lot of conditions, or the conditions are expensive, you can instead create a generator for the conditions, and compare with any or all:"], "childNum": 2, "tag": "p", "senID": 2, "childList": [{"text": "any", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "all", "childNum": 0, "tag": "code", "childList": []}]}, {"code": "<pre>\n<code>\n import itertools\ndef iter_site_info(s):\n    yield s.getId()\n    yield s.getName()\n    yield s.getCustomer().getId()\n\nif all(x==y for (x, y) in itertools.izip(iter_site_info(site), iter_site_info(site_listing)):\n    return site_listing\nelse:\n    continue\n</code>\n</pre>\n", "senID": 3}, {"text": ["I'm not sure whether Jython has any and all, but they're trivial functions to write."], "childNum": 2, "tag": "p", "senID": 4, "childList": [{"text": "any", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "all", "childNum": 0, "tag": "code", "childList": []}]}, {"text": ["EDIT - any and all appeared in Python 2.5, so Jython should have them."], "childNum": 2, "tag": "p", "senID": 5, "childList": [{"text": "any", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "all", "childNum": 0, "tag": "code", "childList": []}]}], [{"text": ["Using exception for control flow is bad!", "And it will also kill your performance.", "Assuming the condition will be true in one out of 10 cases?", "So 9 exceptions to handle in the worst case - this comes with a huge performance cost."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["If you want readability, try:"], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"code": "<pre>\n<code>\n if (\n            condition1 and \\\n            condition2 and \\\n            condition3\n            ):\n            # do something\n</code>\n</pre>\n", "senID": 2}, {"text": ["For the revised version, this should be equivalent:"], "childNum": 0, "tag": "p", "senID": 3, "childList": []}, {"code": "<pre>\n<code>\n for site_listing in all_sites:\n    if site.getName() == site_listing.getName() and site.getCustomer().getId() == site_listing.getCustomer().getId():\n        if not site.getId():\n            site.setId(site_listing.getId())\n        if site.getId() == site_listing.getId():\n            return site_listing\n</code>\n</pre>\n", "senID": 4}], [{"text": ["I would implement an is_same method on site and call it in the for loops."], "childNum": 3, "tag": "p", "senID": 0, "childList": [{"text": "is_same", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "site", "childNum": 0, "tag": "code", "childList": []}, {"text": "for", "childNum": 0, "tag": "code", "childList": []}]}, {"code": "<pre>\n<code>\n all_sites = VpAdminServiceUtil.getSites(vpadmin_service)\nfor site_listing in all_sites:\n    if site_listing.is_same(site, set_id=True):\n        return site_listing\n</code>\n</pre>\n", "senID": 1}, {"text": ["As for its implementation (that is your real question), I suggest something like: "], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"code": "<pre>\n<code>\n ...\nif self.getName()     != site.getName():     return False\nif self.getCustomer() != site.getCustomer(): return False\n...\nreturn True\n</code>\n</pre>\n", "senID": 3}], [{"text": ["Use the __eq__ method!", "If you wrote the class of site yourself, no problem.", "If it is from a module outside of your control, see this solution, or create a somewhat less elegant wrapping class.", "For the wrap variant, this would be the class:"], "childNum": 3, "tag": "p", "senID": 0, "childList": [{"text": "__eq__", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "site", "childNum": 0, "tag": "code", "pos": 1, "childList": []}, {"text": "this solution", "tag": "a", "pos": 2, "childList": [], "childNum": 0, "href": "http://stackoverflow.com/questions/3464061/cast-base-class-to-derived-class-python-or-more-pythonic-way-of-extending-classe/4714744#4714744"}]}, {"code": "<pre>\n<code>\n class WrappedSite(object):\n    def __init__(self, site):\n        self.site = site\n\n    def __eq__(self, other):\n        if site.getId():\n            if self.site.getId() != other.site.getId():\n                return False\n        if self.site.getName() != other.site.getName():\n            return False\n        if self.site.getCustomer().getId() != other.site.getCustomer().getId():\n            return False\n        return True\n</code>\n</pre>\n", "senID": 1}, {"text": ["Then your big ugly function is reduced to this:"], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"code": "<pre>\n<code>\n def site_exists(site):\n    \"\"\"\n    returns the sitebean if it exists,\n    else returns false\n    \"\"\"\n    vpadmin_service = _get_vpadmin_service(site)\n    all_sites = VpAdminServiceUtil.getSites(vpadmin_service)\n    wsite = WrappedSite(site)\n    for site_listing in all_sites:\n        if wsite == WrappedSite(site_listing):\n            return site_listing\n    return False\n</code>\n</pre>\n", "senID": 3}, {"text": ["EDIT Fixed site_exists to return sitebean instead of True."], "childNum": 2, "tag": "p", "senID": 4, "childList": [{"text": "EDIT", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}, {"text": "site_exists", "childNum": 0, "tag": "code", "childList": []}]}], [{"text": ["That strikes me as a pretty pythonic way to do it.", "However, it appears you'll be returning True in all cases - is that what you want?"], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "True", "childNum": 0, "tag": "code", "pos": 1, "childList": []}]}], [{"text": ["Remove some code duplication:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n def site_exists(site):\n    \"\"\"\n    returns the sitebean if it exists,\n    else returns None\n    \"\"\"\n    vpadmin_service = _get_vpadmin_service(site)\n    all_sites = VpAdminServiceUtil.getSites(vpadmin_service)\n\n    for site_listing in all_sites:\n        if (site.getName() == site_listing.getName() and\n            site.getCustomer().getId() == site_listing.getCustomer().getId()):\n            if site.getId(): # if id is set; it should be the same\n                if site.getId() != site_listing.getId(): continue\n            else: # no id; consider it the same site\n                site.setId(site_listing.getId()) #XXX side-effect\n            return site_listing\n</code>\n</pre>\n", "senID": 1}, {"text": ["Note: it is unexpected that site_exists() might modify its argument (via .setId()).", "Consider to refactor it:"], "childNum": 2, "tag": "p", "senID": 2, "childList": [{"text": "site_exists()", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": ".setId()", "childNum": 0, "tag": "code", "pos": -1, "childList": []}]}, {"code": "<pre>\n<code>\n def same_site(site, other):\n    if site.getId() and site.getId() != other.getId(): \n       # if id is set; it should be the same\n       return False \n    return (site.getName() == other.getName() and\n            site.getCustomer().getId() == other.getCustomer().getId())\n\ndef get_site_listing(site):\n    \"\"\"\n    returns the sitebean corresponding to `site`,\n    returns None if there is none\n    \"\"\"\n    vpadmin_service = _get_vpadmin_service(site)\n    all_sites = VpAdminServiceUtil.getSites(vpadmin_service)\n\n    return next((s for s in all_sites if same_site(site, s)), None)\n</code>\n</pre>\n", "senID": 3}, {"text": ["Note: the code doesn't modify the site object.", "Use the return value from get_site_listing() instead."], "childNum": 2, "tag": "p", "senID": 4, "childList": [{"text": "site", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "get_site_listing()", "childNum": 0, "tag": "code", "pos": 1, "childList": []}]}, {"text": ["If next() is unavailable then use:"], "childNum": 1, "tag": "p", "senID": 5, "childList": [{"text": "next()", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"code": "<pre>\n<code>\n for site_listing in all_sites:\n    if same_site(site, site_listing):\n       return site_listing\nreturn None\n</code>\n</pre>\n", "senID": 6}, {"text": ["btw, jython should provide property wrappers for you; so you could write:"], "childNum": 3, "tag": "p", "senID": 7, "childList": [{"text": "jython", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"href": "http://docs.python.org/library/functions.html#property", "text": "property", "childNum": 1, "tag": "a", "childList": [{"text": "property", "tag": "code"}]}, {"text": "property", "childNum": 0, "tag": "code", "childList": []}]}, {"code": "<pre>\n<code>\n def same_site(site, other):\n    if site.id and site.id != other.id: \n       # if id is set; it should be the same\n       return False \n    return site.name == other.name and site.customer.id == other.customer.id\n</code>\n</pre>\n", "senID": 8}, {"text": ["and site.id = id instead of site.setId(id)."], "childNum": 2, "tag": "p", "senID": 9, "childList": [{"text": "site.id = id", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "site.setId(id)", "childNum": 0, "tag": "code", "childList": []}]}], [{"text": ["Using an exception handler as a code target is basically a \"goto\".", "I don't see anything wrong with it really (despite the ancient furor surrounding \"goto considered harmful\"), but knowing that it's a goto might give you a different perspective."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}], [{"text": ["Using exception handling for control flow is pythonic in the sense that \"it's easier to ask for forgiveness than for permission\".", "However, that doesn't extend to making rules to break just so that you can ask for forgiveness."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["Others have provided excellent alternatives.", "Just wanted to address the principle aspect."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}]]