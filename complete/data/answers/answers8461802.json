[[{"text": ["You could try adding tosave.flush() at the end.", "It does cause problems sometimes.", "Sometimes, a flush call is required to empty the contents of the buffer into the file."], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "tosave.flush()", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}], [{"text": ["Check if this works for you"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n import os\ntosave = open('/tmp/list','ab')\nthesource = [\"/etc/ssh\",\"/var/log/syslog\",\"/etc/hosts\"]\nfor f in thesource:\n    if os.path.isdir(f):\n        for top, dirs, files in os.walk(f):\n            for nm in files:\n                try:\n                    tosave.write(top+nm+'\\n')\n    if os.path.isfile(f):\n        tosave.write(f+'\\n')\nto.close()\n</code>\n</pre>\n", "senID": 1}], [{"text": ["In case you missed the()attosave.closewhile pasting: (otherwise checkharsh's answer)"], "childNum": 4, "tag": "p", "senID": 0, "childList": [{"text": "In case you missed the()attosave.closewhile pasting: (otherwise checkharsh's answer)", "childNum": 3, "tag": "em", "pos": 0, "childList": [{"text": "()", "tag": "code"}, {"text": "tosave.close", "tag": "code"}, {"text": "harsh's answer", "tag": "a"}]}, {"text": "()", "childNum": 0, "tag": "code", "childList": []}, {"text": "tosave.close", "childNum": 0, "tag": "code", "childList": []}, {"href": "http://stackoverflow.com/a/8462202/1091453", "text": "harsh's answer", "childNum": 0, "tag": "a", "childList": []}]}, {"text": ["The finally is wrong here.", "The code in finally will be executed after the try block, so after the first execution of tosave.write(top+nm+'\\n') the file will be closed because of tosave.close()."], "childNum": 5, "tag": "p", "senID": 1, "childList": [{"text": "finally", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "finally", "childNum": 0, "tag": "code", "pos": 1, "childList": []}, {"text": "try", "childNum": 0, "tag": "code", "childList": []}, {"text": "tosave.write(top+nm+'\\n')", "childNum": 0, "tag": "code", "childList": []}, {"text": "tosave.close()", "childNum": 0, "tag": "code", "childList": []}]}, {"text": ["Possibly you intended to use except:"], "childNum": 1, "tag": "p", "senID": 2, "childList": [{"text": "except", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"code": "<pre>\n<code>\n # snip\n            try:\n                tosave.write(top+nm+'\\n')\n            except:\n                tosave.close()\n</code>\n</pre>\n", "senID": 3}, {"text": ["Edit: To answer your comment, you want the last line to be the same as the print statement:"], "childNum": 0, "tag": "p", "senID": 4, "childList": []}, {"code": "<pre>\n<code>\n tosave.write(os.path.join(top, nm) + '\\n')\n</code>\n</pre>\n", "senID": 5}], [{"text": ["With all your help I found a solution and it's working.", "I share it."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n tosave = open('/tmp/list','ab')\n    thesource = [\"/etc/ssh\",\"/var/log/syslog\",\"/etc/hosts\"]\nfor f in thesource:\n    if os.path.isfile(f):\n        print f\n        tosave.write(f+'\\n')\n    else:\n        for top, dirs, files in os.walk(f):\n            for nm in files:\n                print os.path.join(top, nm)\n                tosave.write(top+nm+'\\n')\n</code>\n</pre>\n", "senID": 1}, {"text": ["Thank you all for your help !!"], "childNum": 0, "tag": "p", "senID": 2, "childList": []}], [{"text": ["Maybe this is because you're opening the file in append mode (the 'a') and then looking at its beginning?", "Look at its end - you might see your new files listed there."], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "'a'", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"text": ["In append mode, each time the script runs it appends its output to the file.", "Usually what one wants is just the write mode ('w' instead of 'a'), which overwrites the file each time."], "childNum": 3, "tag": "p", "senID": 1, "childList": [{"text": "appends", "childNum": 0, "tag": "em", "pos": 0, "childList": []}, {"text": "'w'", "childNum": 0, "tag": "code", "pos": 1, "childList": []}, {"text": "'a'", "childNum": 0, "tag": "code", "childList": []}]}], [{"text": ["In this line you're writing strings to the file:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n tosave.write(top+nm+'\\n')\n</code>\n</pre>\n", "senID": 1}, {"text": ["You need to open the files and read them in order to write to another file:"], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"code": "<pre>\n<code>\n tosave.write(open(os.path.join(top, nm), 'rb').read())\n</code>\n</pre>\n", "senID": 3}, {"text": ["But I'm guessing you will have to deal with: IOError: [Errno 13] Permission denied: ..."], "childNum": 1, "tag": "p", "senID": 4, "childList": [{"text": "IOError: [Errno 13] Permission denied: ...", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}], [{"text": ["Put the close() at the end of the script."], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "close()", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"text": ["Otherwise it will close the file after the first step in the loop, making the file unwritable."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}]]