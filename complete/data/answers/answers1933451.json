[[{"text": ["There are often clearer, more direct ways to get the same effect.", "If you build a complex string and pass it to exec, the code is difficult to follow, and difficult to test. "], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["Example: I wrote code that read in string keys and values and set corresponding fields in an object.", "It looked like this: "], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"code": "<pre>\n<code>\n for key, val in values:\n    fieldName = valueToFieldName[key]\n    fieldType = fieldNameToType[fieldName]\n    if fieldType is int:\n        s = 'object.%s = int(%s)' % (fieldName, fieldType) \n    #Many clauses like this...\n\nexec(s)\n</code>\n</pre>\n", "senID": 2}, {"text": ["That code isn't too terrible for simple cases, but as new types cropped up it got more and more complex.", "When there were bugs they always triggered on the call to exec, so stack traces didn't help me find them.", "Eventually I switched to a slightly longer, less clever version that set each field explicitly. "], "childNum": 0, "tag": "p", "senID": 3, "childList": []}, {"text": ["The first rule of code clarity is that each line of your code should be easy to understand by looking only at the lines near it.", "This is why goto and global variables are discouraged.", "exec and eval make it easy to break this rule badly."], "childNum": 0, "tag": "p", "senID": 4, "childList": []}], [{"text": ["eval() and exec() can promote lazy programming.", "More importantly it indicates the code being executed may not have been written at design time therefore not tested.", "In other words, how do you test dynamically generated code?", "Especially across browsers."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}], [{"text": ["Security aside, eval and exec are often marked as undesirable because of the complexity they induce.", "When you see a eval call you often don't know what's really going on behind it, because it acts on data that's usually in a variable.", "This makes code harder to read."], "childNum": 3, "tag": "p", "senID": 0, "childList": [{"text": "eval", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "exec", "childNum": 0, "tag": "code", "pos": -1, "childList": []}, {"text": "eval", "childNum": 0, "tag": "code", "pos": 1, "childList": []}]}, {"text": ["Invoking the full power of the interpreter is a heavy weapon that should be only reserved for very tricky cases.", "In most cases, however, it's best avoided and simpler tools should be employed. "], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"text": ["That said, like all generalizations, be wary of this one.", "In some cases, exec and eval can be valuable.", "But you must have a very good reason to use them.", "See this post for one acceptable use."], "childNum": 1, "tag": "p", "senID": 2, "childList": [{"text": "this post", "tag": "a", "pos": 3, "childList": [], "childNum": 0, "href": "http://stackoverflow.com/questions/533382/dynamic-runtime-method-creation-code-generation-in-python"}]}], [{"text": ["In contrast to what most answers are saying here, exec is actually part of the recipe for building super-complete decorators in Python, as you can duplicate everything about the decorated function exactly, producing the same signature for the purposes of documentation and such.", "It's key to the functionality of the widely used decorator module (http://pypi.python.org/pypi/decorator/).", "Other cases where exec/eval are essential is when constructing any kind of \"interpreted Python\" type of application, such as a Python-parsed template language (like Mako or Jinja)."], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "http://pypi.python.org/pypi/decorator/", "tag": "a", "pos": 1, "childList": [], "childNum": 0, "href": "http://pypi.python.org/pypi/decorator/"}]}, {"text": ["So it's not like the presence of these functions are an immediate sign of an \"insecure\" application or library.", "Using them in the naive javascripty way to evaluate incoming JSON or something, yes that's very insecure.", "But as always, its all in the way you use it and these are very essential functions."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}], [{"text": ["Allowing these function in a context where they might run user input is a security issue, and sanitizers that actually work are hard to write."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}], [{"text": ["I have used eval() in the past (and still do from time-to-time) for massaging data during quick and dirty operations.", "It is part of the toolkit that can be used for getting a job done, but should NEVER be used for anything you plan to use in production such as any command-line tools or scripts, because of all the reasons mentioned in the other answers.  "], "childNum": 2, "tag": "p", "senID": 0, "childList": [{"text": "eval()", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "NEVER be used for anything you plan to use in production", "childNum": 0, "tag": "strong", "pos": 1, "childList": []}]}, {"text": ["You cannot trust your users--ever--to do the right thing.", "In most cases they will, but you have to expect them to do all of the things you never thought of and find all of the bugs you never expected.", "This is precisely where eval() goes from being a tool to a liability."], "childNum": 1, "tag": "p", "senID": 1, "childList": [{"text": "eval()", "childNum": 0, "tag": "code", "pos": 2, "childList": []}]}, {"text": ["A perfect example of this would be using Django, when constructing a QuerySet.", "The parameters passed to a query accepts keyword arguments, that look something like this:"], "childNum": 1, "tag": "p", "senID": 2, "childList": [{"text": "QuerySet", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"code": "<pre>\n<code>\n results = Foo.objects.filter(whatever__contains='pizza')\n</code>\n</pre>\n", "senID": 3}, {"text": ["If you're programmatically assigning arguments, you might think to do something like this:"], "childNum": 0, "tag": "p", "senID": 4, "childList": []}, {"code": "<pre>\n<code>\n results = eval(\"Foo.objects.filter(%s__%s=%s)\" % (field, matcher, value))\n</code>\n</pre>\n", "senID": 5}, {"text": ["But there is always a better way that doesn't use eval(), which is passing a dictionary by reference:"], "childNum": 1, "tag": "p", "senID": 6, "childList": [{"text": "eval()", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"code": "<pre>\n<code>\n results = Foo.objects.filter( **{'%s__%s' % (field, matcher): value} )\n</code>\n</pre>\n", "senID": 7}, {"text": ["By doing it this way, it's not only faster performance-wise, but also safer and more Pythonic. "], "childNum": 0, "tag": "p", "senID": 8, "childList": []}, {"text": ["Moral of the story?"], "childNum": 0, "tag": "p", "senID": 9, "childList": []}, {"text": ["Use of eval() is ok for small tasks, tests, and truly temporary things, but bad for permanent usage because there is almost certainly always a better way to do it!"], "childNum": 3, "tag": "p", "senID": 10, "childList": [{"text": "eval()", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "ok", "childNum": 0, "tag": "strong", "childList": []}, {"text": "bad", "childNum": 0, "tag": "strong", "childList": []}]}], [{"text": ["Same reason you shouldn't login as root: it's too easy to shoot yourself in the foot."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}], [{"text": ["Reason #1: One security flaw (ie.", "programming errors... and we can't claim those can be avoided) and you've just given the user access to the shell of the server."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}], [{"text": ["Try this in the interactive interpreter and see what happens:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n &gt;&gt;&gt; import sys\n&gt;&gt;&gt; eval('{\"name\" : %s}' % (\"sys.exit(1)\"))\n</code>\n</pre>\n", "senID": 1}, {"text": ["Of course, this is a corner case, but it can be tricky to prevent things like this."], "childNum": 0, "tag": "p", "senID": 2, "childList": []}], [{"text": ["When you need exec and eval, yeah, you really do need them."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["But, the majority of the in-the-wild usage of these functions (and the similar constructs in other scripting languages) is totally inappropriate and could be replaced with other simpler constructs that are faster, more secure and have fewer bugs."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"text": ["You can, with proper escaping and filtering, use exec and eval safely.", "But the kind of coder who goes straight for exec/eval to solve a problem (because they don't understand the other facilities the language makes available) isn't the kind of coder that's going to be able to get that processing right; it's going to be someone who doesn't understand string processing and just blindly concatenates substrings, resulting in fragile insecure code."], "childNum": 1, "tag": "p", "senID": 2, "childList": [{"text": "can", "childNum": 0, "tag": "em", "pos": 0, "childList": []}]}, {"text": ["It's the Lure Of Strings.", "Throwing string segments around looks easy and fools na\u00efve coders into thinking they understand what they're doing.", "But experience shows the results are almost always wrong in some corner (or not-so-corner) case, often with potential security implications.", "This is why we say eval is evil.", "This is why we say regex-for-HTML is evil.", "This is why we push SQL parameterisation.", "Yes, you can get all these things right with manual string processing... but unless you already understand why we say those things, chances are you won't."], "childNum": 3, "tag": "p", "senID": 3, "childList": [{"text": "looks", "childNum": 0, "tag": "em", "pos": 1, "childList": []}, {"text": "can", "childNum": 0, "tag": "em", "pos": 6, "childList": []}, {"text": "won't", "childNum": 0, "tag": "em", "childList": []}]}], [{"code": "<pre>\n<code>\n s = \"import shutil; shutil.rmtree('/nonexisting')\"\neval(s)\n</code>\n</pre>\n", "senID": 0}, {"text": ["Now assume somebody can control s from a web application, for example."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"text": ["Don't try to do this on your computer"], "childNum": 1, "tag": "p", "senID": 2, "childList": [{"text": "Don't try to do this on your computer", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}]}]]