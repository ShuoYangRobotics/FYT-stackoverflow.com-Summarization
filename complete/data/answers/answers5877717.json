[[{"text": ["Don't use regular expressions to parse HTML.", "Use BeautifulSoup"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n &gt;&gt;&gt; from BeautifulSoup import BeautifulSoup\n&gt;&gt;&gt; ht = '&lt;html&gt;&lt;head&gt;&lt;title&gt;foo&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;p&gt;whatever: &lt;img src=\"foo/img.png\" height=\"111\" width=\"22\" /&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;img src=\"foo/img2.png\" height=\"32\" width=\"44\" /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/html&gt;'\n&gt;&gt;&gt; soup = BeautifulSoup(ht)\n&gt;&gt;&gt; soup\n&lt;html&gt;&lt;head&gt;&lt;title&gt;foo&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;p&gt;whatever: &lt;img src=\"foo/img.png\" height=\"111\" width=\"22\" /&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;img src=\"foo/img2.png\" height=\"32\" width=\"44\" /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/html&gt;\n&gt;&gt;&gt; soup.findAll('img')\n[&lt;img src=\"foo/img.png\" height=\"111\" width=\"22\" /&gt;, &lt;img src=\"foo/img2.png\" height=\"32\" width=\"44\" /&gt;]\n&gt;&gt;&gt; for img in soup.findAll('img'):\n...     ht = int(img['height'])\n...     wi = int(img['width'])\n...     img['height'] = str(ht * 2)\n...     img['width'] = str(wi * 2)\n...     \n... \n&gt;&gt;&gt; print soup.prettify()\n&lt;html&gt;\n &lt;head&gt;\n  &lt;title&gt;\n   foo\n  &lt;/title&gt;\n &lt;/head&gt;\n &lt;body&gt;\n  &lt;p&gt;\n   whatever:\n   &lt;img src=\"foo/img.png\" height=\"222\" width=\"44\" /&gt;\n  &lt;/p&gt;\n  &lt;ul&gt;\n   &lt;li&gt;\n    &lt;img src=\"foo/img2.png\" height=\"64\" width=\"88\" /&gt;\n   &lt;/li&gt;\n  &lt;/ul&gt;\n &lt;/body&gt;\n &lt;/html&gt;\n&gt;&gt;&gt;\n</code>\n</pre>\n", "senID": 1}], [{"text": ["Don't use regular expressions when dealing with HTML.", "Parse it properly with something like lxml."], "childNum": 3, "tag": "p", "senID": 0, "childList": [{"text": "Don't use regular expressions when dealing with HTML", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://www.codinghorror.com/blog/2009/11/parsing-html-the-cthulhu-way.html"}, {"text": "lxml", "tag": "a", "pos": 1, "childList": [{"text": "lxml", "tag": "strong"}], "childNum": 1, "href": "http://lxml.de"}, {"text": "lxml", "childNum": 0, "tag": "strong", "childList": []}]}, {"code": "<pre>\n<code>\n import lxml.html\n\nhtml = '&lt;img src = \"werwerwe\" height=\"111\" width=\"10\" /&gt;'\n\netree = lxml.html.fromstring(html)\n\nimages = etree.xpath('//img')\nfor image in images:\n    h = int(image.attrib['height'])\n    w = int(image.attrib['width'])\n    image.attrib['height'] = str(h*2)\n    image.attrib['width'] = str(w*2)\n\nprint lxml.html.tostring(etree)\n</code>\n</pre>\n", "senID": 1}, {"text": ["Gives:"], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"text": ["&lt;img src=\"werwerwe\" height=\"222\" width=\"20\"&gt;"], "childNum": 1, "tag": "p", "senID": 3, "childList": [{"text": "&lt;img src=\"werwerwe\" height=\"222\" width=\"20\"&gt;", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}], [{"text": ["Disclaimer: I agree that parsing HTML is best performed using an HTML parser.", "However, the poster has specifically asked for a regex solution, and this particular problem presents a good vehicle to demonstrate a clever (and little-known) regex technique that is quite handy."], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "Disclaimer:", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}]}, {"text": ["But first, there is a logic error in the original function.", "It blindly performs its numerical replacement which results in erroneous results when the WIDTH is exactly half the HEIGHT, e.g.", "Given the following:"], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"code": "<pre class=\"lang-html prettyprint-override\">\n<code>\n &lt;img src = \"/\" width=\"10\" height=\"20\" /&gt;\n</code>\n</pre>\n", "senID": 2}, {"text": ["The original posted program returns the following erroneous result:"], "childNum": 0, "tag": "p", "senID": 3, "childList": []}, {"code": "<pre class=\"lang-html prettyprint-override\">\n<code>\n &lt;img src = \"/\" width=\"40\" height=\"40\" /&gt;\n</code>\n</pre>\n", "senID": 4}, {"text": ["The problem is that WIDTH gets doubled twice.", "Additional logic is needed to guarantee correct replacement."], "childNum": 0, "tag": "p", "senID": 5, "childList": []}, {"text": ["A cool regex trick you may not know:"], "childNum": 0, "tag": "h2", "senID": 6, "childList": []}, {"text": ["Here is a modified version of the original program which fixes the above mentioned error and includes a (commented) version of an improved regex:"], "childNum": 0, "tag": "p", "senID": 7, "childList": []}, {"code": "<pre class=\"lang-py prettyprint-override\">\n<code>\n import re\ns = '&lt;img src = \"/\" width=\"10\" height=\"111\"  /&gt;'\n\ndef a(x):\n    b = x.group(0)\n    if x.group(1):\n        b = b.replace(x.group(1),\n            \"width=\\\"\"+ str(int(x.group(2))*2) +\"\\\"\")\n    if x.group(3):\n        b = b.replace(x.group(3),\n            \"width=\\\"\"+ str(int(x.group(4))*2) +\"\\\"\")\n    return b\n\nreobj = re.compile(r'''\n    &lt;img                        # Start of IMG tag.\n    (?:                         # Group for multiple attributes.\n      \\s+                       # Attributes separated by whitespace.\n      (?:                       # Group for attribute alternatives.\n        (width\\s*=\\s*\"(\\d+)\")   # $1: WIDTH attribute, $2 value.\n      | (height\\s*=\\s*\"(\\d+)\")  # $3: HEIGHT attribute, $4 value.\n      |[^\\s&gt;]+)                 # Other IMG attributes.\n    )+                          # One or more attributes.\n    [^&gt;]*&gt;                      # End of IMG tag.\n    ''', re.IGNORECASE | re.VERBOSE)\n\nss = re.sub(reobj, a, s)\n\nprint ss\n</code>\n</pre>\n", "senID": 8}, {"text": ["Note that the WIDTH gets captured into groups $1 and $2 and HEIGHT into groups $3 and $4, even if their order is reversed in the target string.", "I wish I could say that I thought up this cool trick, but I didn't.", "I stole it from one of Steven Leveithan's excellent blog posts: Capturing Multiple, Optional HTML Attribute Values.", "Pretty nifty eh?"], "childNum": 1, "tag": "p", "senID": 9, "childList": [{"text": "Capturing Multiple, Optional HTML Attribute Values", "tag": "a", "pos": 2, "childList": [], "childNum": 0, "href": "http://blog.stevenlevithan.com/archives/multi-attr-capture"}]}, {"text": ["A cleaner regex solution"], "childNum": 0, "tag": "h2", "senID": 10, "childList": []}, {"text": ["Clever as that may be, it is still more complex than it needs to be for this job.", "I would keep it simple and just do two separate replace operations like so:"], "childNum": 0, "tag": "p", "senID": 11, "childList": []}, {"code": "<pre class=\"lang-py prettyprint-override\">\n<code>\n import re\ns = '&lt;img src = \"/\" width=\"10\" height=\"111\"  /&gt;'\n\ndef a(x):\n    return x.group(1) + str(int(x.group(2))*2)\n\nss = re.sub(r\"(?i)(&lt;img[^&gt;]*?width\\s*=\\s*[\\\"'])(\\d+)\",a, s)\nss = re.sub(r\"(?i)(&lt;img[^&gt;]*?height\\s*=\\s*[\\\"'])(\\d+)\",a, ss)\n\nprint ss\n</code>\n</pre>\n", "senID": 12}, {"text": ["Smaller.", "cleaner, easier to read and probably the fastest solution.", "(Note that the callback function becomes trivial."], "childNum": 0, "tag": "p", "senID": 13, "childList": []}], [{"text": ["Nothing good will come from attempting to use regex to parse HTML.", "No matter what you do, it will eventually break. "], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["So, use an html parser like python's HTMLParser, it will decode all of the HTML text and you just need to print it back out with your changes."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"text": ["On another note, modifying html like you are doing looks suspicious.", "You are probably doing something the very hard way."], "childNum": 0, "tag": "p", "senID": 2, "childList": []}], [{"text": ["Once again, that task should be solved perfectly by a HTML Parser like suggested here and here.", "If you still want to use a Regular Expressions for that purpose, you can use this one instead:"], "childNum": 5, "tag": "p", "senID": 0, "childList": [{"text": "Once again", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}, {"text": "here", "tag": "a", "pos": -1, "childList": [], "childNum": 0, "href": "http://stackoverflow.com/questions/5877717/how-to-make-the-width-and-height-x2-using-python-regular/5877848#5877848"}, {"text": "here", "tag": "a", "pos": -1, "childList": [], "childNum": 0, "href": "http://stackoverflow.com/questions/5877717/how-to-make-the-width-and-height-x2-using-python-regular/5877801#5877801"}, {"text": "", "childNum": 0, "tag": "hr", "pos": 1, "childList": []}, {"text": "If you still want to use a Regular Expressions", "childNum": 0, "tag": "strong", "childList": []}]}, {"text": ["&lt;img.*?(width|height)=\\\"(\\d+)\\\".*?", "(width|height)=\\\"(\\d+)\\\""], "childNum": 1, "tag": "p", "senID": 1, "childList": [{"text": "&lt;img.*?(width|height)=\\\"(\\d+)\\\".*?(width|height)=\\\"(\\d+)\\\"", "childNum": 0, "tag": "code", "pos": -1, "childList": []}]}, {"text": ["For example: "], "childNum": 1, "tag": "p", "senID": 2, "childList": [{"text": "For example:", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}]}, {"text": ["In text: &lt;img src = \"/\" width=\"10\" height=\"111\"/&gt; will match the following groups:"], "childNum": 1, "tag": "p", "senID": 3, "childList": [{"text": "&lt;img src = \"/\" width=\"10\" height=\"111\"/&gt;", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"tag": "ul", "num": 4, "lis": [{"text": "Group 1: ", "tag": "none", "senID": 4}, {"text": "Group 2: ", "tag": "none", "senID": 5}, {"text": "Group 3: ", "tag": "none", "senID": 6}, {"text": "Group 4: ", "tag": "none", "senID": 7}]}, {"text": ["In text: &lt;img src = \"/\" height=\"111\" width=\"10\"/&gt; it will match:"], "childNum": 1, "tag": "p", "senID": 8, "childList": [{"text": "&lt;img src = \"/\" height=\"111\" width=\"10\"/&gt;", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"tag": "ul", "num": 4, "lis": [{"text": "Group 1: ", "tag": "none", "senID": 9}, {"text": "Group 2: ", "tag": "none", "senID": 10}, {"text": "Group 3: ", "tag": "none", "senID": 11}, {"text": "Group 4: ", "tag": "none", "senID": 12}]}, {"text": ["Now it matches no matter if width is before height or viceversa, and I think the 4 groups give you enough info when doing the replacement."], "childNum": 2, "tag": "p", "senID": 13, "childList": [{"text": "width", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "height", "childNum": 0, "tag": "code", "childList": []}]}, {"text": ["Edit:\nI captured the groups height and width for you to know which value matched first (otherwise, if you obtain 111 and 10 you won't know which one is the height and the width), but I don't think that's necessary in your case because all you have to do is duplicate both values, but could be useful in case you want increment height and width in different values. "], "childNum": 11, "tag": "p", "senID": 14, "childList": [{"text": "Edit:", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}, {"text": "", "childNum": 0, "tag": "br", "childList": []}, {"text": "height", "childNum": 0, "tag": "code", "childList": []}, {"text": "width", "childNum": 0, "tag": "code", "childList": []}, {"text": "111", "childNum": 0, "tag": "code", "childList": []}, {"text": "10", "childNum": 0, "tag": "code", "childList": []}, {"text": "height", "childNum": 0, "tag": "code", "childList": []}, {"text": "width", "childNum": 0, "tag": "code", "childList": []}, {"text": "both values", "childNum": 0, "tag": "strong", "childList": []}, {"text": "height", "childNum": 0, "tag": "code", "childList": []}, {"text": "width", "childNum": 0, "tag": "code", "childList": []}]}], [{"text": ["Try with the following regex:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["&lt;img.*?height=\\\"(\\d+)\\\".", "*?width=\\\"(\\d+)\\\""], "childNum": 1, "tag": "p", "senID": 1, "childList": [{"text": "&lt;img.*?height=\\\"(\\d+)\\\".*?width=\\\"(\\d+)\\\"", "childNum": 0, "tag": "code", "pos": -1, "childList": []}]}, {"text": ["Group 1 will capture the height and Group 2 the width"], "childNum": 2, "tag": "p", "senID": 2, "childList": [{"text": "Group 1", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "Group 2", "childNum": 0, "tag": "code", "childList": []}]}]]