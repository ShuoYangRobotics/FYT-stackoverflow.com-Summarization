[[{"text": ["I recommend SciPy for numerical functions in Python, but if you want something with no dependencies, here is a function with an error error is less than 1.5 * 10-7 for all inputs."], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "-7", "childNum": 0, "tag": "sup", "pos": 0, "childList": []}]}, {"code": "<pre>\n<code>\n def erf(x):\n    # save the sign of x\n    sign = 1 if x &gt;= 0 else -1\n    x = abs(x)\n\n    # constants\n    a1 =  0.254829592\n    a2 = -0.284496736\n    a3 =  1.421413741\n    a4 = -1.453152027\n    a5 =  1.061405429\n    p  =  0.3275911\n\n    # A&amp;S formula 7.1.26\n    t = 1.0/(1.0 + p*x)\n    y = 1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*math.exp(-x*x)\n    return sign*y # erf(-x) = -erf(x)\n</code>\n</pre>\n", "senID": 1}, {"text": ["The algorithm comes from Handbook of Mathematical Functions, formula 7.1.26."], "childNum": 1, "tag": "p", "senID": 2, "childList": [{"text": "Handbook of Mathematical Functions", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://rads.stackoverflow.com/amzn/click/0486612724"}]}], [{"text": ["I would recommend you download numpy (to have efficiant matrix in python) and scipy (a  Matlab toolbox substitute, which uses numpy).", "The erf function lies in scipy."], "childNum": 2, "tag": "p", "senID": 0, "childList": [{"text": "numpy", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://sourceforge.net/project/showfiles.php?group_id=1369&package_id=175103"}, {"text": "scipy", "tag": "a", "pos": 1, "childList": [], "childNum": 0, "href": "http://www.scipy.org/"}]}, {"code": "<pre>\n<code>\n &gt;&gt;&gt;import scipy.special.erf as erf\n&gt;&gt;&gt;help(erf)\n</code>\n</pre>\n", "senID": 1}, {"text": ["You can also use the erf function defined in pylab, but this is more intended at plotting the results of the things you compute with numpy and scipy.", "If you want an all-in-one \ninstallation of these software you can use directly the Python Enthought distribution."], "childNum": 1, "tag": "p", "senID": 2, "childList": [{"text": "Python Enthought distribution", "tag": "a", "pos": 1, "childList": [], "childNum": 0, "href": "http://www.enthought.com/products/epd.php"}]}], [{"text": ["To answer my own question, I have ended up using the following code, adapted from a Java version I found elsewhere on the web:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n # from: http://www.cs.princeton.edu/introcs/21function/ErrorFunction.java.html\n# Implements the Gauss error function.\n#   erf(z) = 2 / sqrt(pi) * integral(exp(-t*t), t = 0..z)\n#\n# fractional error in math formula less than 1.2 * 10 ^ -7.\n# although subject to catastrophic cancellation when z in very close to 0\n# from Chebyshev fitting formula for erf(z) from Numerical Recipes, 6.2\ndef erf(z):\n\tt = 1.0 / (1.0 + 0.5 * abs(z))\n    \t# use Horner's method\n        ans = 1 - t * math.exp( -z*z -  1.26551223 +\n        \t\t\t\t\tt * ( 1.00002368 +\n        \t\t\t\t\tt * ( 0.37409196 + \n        \t\t\t\t\tt * ( 0.09678418 + \n        \t\t\t\t\tt * (-0.18628806 + \n        \t\t\t\t\tt * ( 0.27886807 + \n        \t\t\t\t\tt * (-1.13520398 + \n        \t\t\t\t\tt * ( 1.48851587 + \n        \t\t\t\t\tt * (-0.82215223 + \n        \t\t\t\t\tt * ( 0.17087277))))))))))\n        if z &gt;= 0.0:\n        \treturn ans\n        else:\n        \treturn -ans\n</code>\n</pre>\n", "senID": 1}], [{"text": ["Since v.2.7.", "the standard math module contains erf function.", "This should be the easiest way."], "childNum": 2, "tag": "p", "senID": 0, "childList": [{"text": "math", "childNum": 0, "tag": "em", "pos": 1, "childList": []}, {"text": "erf", "childNum": 0, "tag": "em", "pos": -1, "childList": []}]}], [{"text": ["A pure python implementation can be found in the mpmath module (http://code.google.com/p/mpmath/)"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["From the doc string:"], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"code": "<pre>\n<code>\n &gt;&gt;&gt; from mpmath import *\n&gt;&gt;&gt; mp.dps = 15\n&gt;&gt;&gt; print erf(0)\n0.0\n&gt;&gt;&gt; print erf(1)\n0.842700792949715\n&gt;&gt;&gt; print erf(-1)\n-0.842700792949715\n&gt;&gt;&gt; print erf(inf)\n1.0\n&gt;&gt;&gt; print erf(-inf)\n-1.0\n</code>\n</pre>\n", "senID": 2}, {"text": ["For large real x, \\mathrm{erf}(x) approaches 1 very\nrapidly::"], "childNum": 2, "tag": "p", "senID": 3, "childList": [{"text": "x", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "\\mathrm{erf}(x)", "childNum": 0, "tag": "code", "childList": []}]}, {"code": "<pre>\n<code>\n &gt;&gt;&gt; print erf(3)\n0.999977909503001\n&gt;&gt;&gt; print erf(5)\n0.999999999998463\n</code>\n</pre>\n", "senID": 4}, {"text": ["The error function is an odd function::"], "childNum": 0, "tag": "p", "senID": 5, "childList": []}, {"code": "<pre>\n<code>\n &gt;&gt;&gt; nprint(chop(taylor(erf, 0, 5)))\n[0.0, 1.12838, 0.0, -0.376126, 0.0, 0.112838]\n</code>\n</pre>\n", "senID": 6}, {"text": [":func:erf implements arbitrary-precision evaluation and\nsupports complex numbers::"], "childNum": 1, "tag": "p", "senID": 7, "childList": [{"text": "erf", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"code": "<pre>\n<code>\n &gt;&gt;&gt; mp.dps = 50\n&gt;&gt;&gt; print erf(0.5)\n0.52049987781304653768274665389196452873645157575796\n&gt;&gt;&gt; mp.dps = 25\n&gt;&gt;&gt; print erf(1+j)\n(1.316151281697947644880271 + 0.1904534692378346862841089j)\n</code>\n</pre>\n", "senID": 8}, {"text": ["Related functions"], "childNum": 1, "tag": "p", "senID": 9, "childList": [{"text": "Related functions", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}]}, {"text": ["See also :func:erfc, which is more accurate for large x,\nand :func:erfi which gives the antiderivative of\n\\exp(t^2)."], "childNum": 4, "tag": "p", "senID": 10, "childList": [{"text": "erfc", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "x", "childNum": 0, "tag": "code", "childList": []}, {"text": "erfi", "childNum": 0, "tag": "code", "childList": []}, {"text": "\\exp(t^2)", "childNum": 0, "tag": "code", "childList": []}]}, {"text": ["The Fresnel integrals :func:fresnels and :func:fresnelc\nare also related to the error function."], "childNum": 2, "tag": "p", "senID": 11, "childList": [{"text": "fresnels", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "fresnelc", "childNum": 0, "tag": "code", "childList": []}]}], [{"text": ["I have a function which does 10^5 erf calls.", "On my machine..."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["scipy.special.erf makes it time at 6.1s"], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"text": ["erf Handbook of Mathematical Functions takes     8.3s"], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"text": ["erf Numerical Recipes 6.2    takes     9.5s"], "childNum": 0, "tag": "p", "senID": 3, "childList": []}, {"text": ["(three-run averages, code taken from above posters)."], "childNum": 0, "tag": "p", "senID": 4, "childList": []}]]