[[{"text": ["The following code works for me:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n import smtplib\n\nFROMADDR = \"my.real.address@gmail.com\"\nLOGIN    = FROMADDR\nPASSWORD = \"my.real.password\"\nTOADDRS  = [\"my.real.address@gmail.com\"]\nSUBJECT  = \"Test\"\n\nmsg = (\"From: %s\\r\\nTo: %s\\r\\nSubject: %s\\r\\n\\r\\n\"\n       % (FROMADDR, \", \".join(TOADDRS), SUBJECT) )\nmsg += \"some text\\r\\n\"\n\nserver = smtplib.SMTP('smtp.gmail.com', 587)\nserver.set_debuglevel(1)\nserver.ehlo()\nserver.starttls()\nserver.login(LOGIN, PASSWORD)\nserver.sendmail(FROMADDR, TOADDRS, msg)\nserver.quit()\n</code>\n</pre>\n", "senID": 1}, {"text": ["I'm using Python 2.5.2."], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"text": ["Edit: changed port from 25 to 587 as suggested by \u03a4\u0396\u03a9\u03a4\u0396\u0399\u039f\u03a5, and dropped the second ehlo().", "Now I would love to know why port 25 works perfectly from my machine (and port 465 does not)."], "childNum": 3, "tag": "p", "senID": 3, "childList": [{"text": "Edit", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}, {"text": "perfectly", "childNum": 0, "tag": "em", "pos": 1, "childList": []}, {"text": "not", "childNum": 0, "tag": "em", "childList": []}]}], [{"text": ["Here's a simple throw away solution.", "Meant to paste this earlier, but fell asleep at my chair."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n import smtplib\nimport email\nimport os\n\nusername = \"user@gmail.com\"\npasswd = \"password\"\n\ndef mail(to, subject, text, attach):\n   msg = MIMEMultipart()\n\n   msg['From'] = username\n   msg['To'] = to\n   msg['Subject'] = subject\n\n   msg.attach(MIMEText(text)) \n\n   part = MIMEBase('application', 'octet-stream')\n   part.set_payload(open(attach, 'rb').read())\n   Encoders.encode_base64(part)\n   part.add_header('Content-Disposition',\n           'attachment; filename=\"%s\"' % os.path.basename(attach))\n   msg.attach(part)\n\n   server = smtplib.SMTP(\"smtp.gmail.com\", 495)\n   server.ehlo()\n   server.starttls()\n   server.ehlo()\n   server.login(username, passwd)\n   server.sendmail(username, to, msg.as_string())\n   server.close()\n\nmail(\"you\", \"hi\", \"hi\", \"webcam.jpg\")\n</code>\n</pre>\n", "senID": 1}, {"text": ["It's my assumption that most people on this thread that have had successful attempts with their code aren't on win32.", ";)"], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"text": ["*edit: See http://docs.python.org/library/email-examples.html for some good \"official\" examples. "], "childNum": 1, "tag": "p", "senID": 3, "childList": [{"text": "http://docs.python.org/library/email-examples.html", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://docs.python.org/library/email-examples.html"}]}], [{"text": ["The problem is due to a bug in Python.", "Trying to create a connection with SMTP_SSL will fail with \"SMTPServerDisconnected: please run connect() first."], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "a bug in Python", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://bugs.python.org/issue4066"}]}, {"text": ["A fix has been committed, so you can patch your local copy.", "See the attachment named \"smtplib_72551.diff\"."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"text": ["(Note: SMTP_SSL is a new class added to Python 2.6/3.0 and later."], "childNum": 0, "tag": "p", "senID": 2, "childList": []}], [{"text": ["Okay, found out that this line of code does the trick!"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["server = smtplib.SMTP('smtp.gmail.com', 587 )"], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"text": ["Turned out to be GMAIL didn't support SSL on port 25 (and port 465 caused a hang for some reason)."], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"text": ["Thanks guys!"], "childNum": 0, "tag": "p", "senID": 3, "childList": []}], [{"text": ["The correct way to connect to GMail using SSL is:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n server = smtplib.SMTP('smtp.gmail.com', 587)\n</code>\n</pre>\n", "senID": 1}, {"text": ["Port 465 seems to cause delays.", "Both ports are specified in a GMail FAQ."], "childNum": 1, "tag": "p", "senID": 2, "childList": [{"text": "GMail FAQ", "tag": "a", "pos": 1, "childList": [], "childNum": 0, "href": "http://mail.google.com/support/bin/answer.py?hl=en&answer=78799"}]}, {"text": ["Note that use of port 587 is more common for SMTP over SSL, although this is just trivial information, it has no other practical use."], "childNum": 0, "tag": "p", "senID": 3, "childList": []}, {"text": ["This answer is provided as community wiki in order to be chosen as \"the\" answer.", "Please improve as needed."], "childNum": 1, "tag": "p", "senID": 4, "childList": [{"text": "This answer is provided as community wiki in order to be chosen as \"the\" answer. Please improve as needed.", "childNum": 0, "tag": "em", "pos": -1, "childList": []}]}], [{"text": ["Incorrect port maybe?", "I'm using 587 for smtp.gmail.com and it works."], "childNum": 2, "tag": "p", "senID": 0, "childList": [{"text": "587", "childNum": 0, "tag": "strong", "pos": 1, "childList": []}, {"text": "smtp.gmail.com", "childNum": 0, "tag": "strong", "childList": []}]}], [{"text": ["You should check your port, I'm not sure that google's SMTP port is 65, that would explain the timeout. "], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["Modify your sources as such:"], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"text": ["smtplib.SMTP_SSL('smtp.google.com', 465)"], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"text": ["If, however, you are certain that it ought to work and it doesn't, it appears that there are some problems with smtplib.SMTP_SSL, and there's an available patch for it here. "], "childNum": 1, "tag": "p", "senID": 3, "childList": [{"text": "here", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://bugs.python.org/issue4470"}]}]]