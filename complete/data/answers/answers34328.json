[[{"text": ["Here is code to install a python-script as a service, written in python :)"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["http://code.activestate.com/recipes/551780/"], "childNum": 1, "tag": "p", "senID": 1, "childList": [{"text": "http://code.activestate.com/recipes/551780/", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://code.activestate.com/recipes/551780/"}]}, {"text": ["This post could also help you out:"], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"text": ["http://essiene.blogspot.com/2005/04/python-windows-services.html"], "childNum": 1, "tag": "p", "senID": 3, "childList": [{"text": "http://essiene.blogspot.com/2005/04/python-windows-services.html", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://essiene.blogspot.com/2005/04/python-windows-services.html"}]}], [{"text": ["As with most \"aware\" things in Windows, the answer is \"Registry\"."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["Take a look at this Microsoft Knowledge Base article: http://support.microsoft.com/kb/103000"], "childNum": 1, "tag": "p", "senID": 1, "childList": [{"text": "http://support.microsoft.com/kb/103000", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://support.microsoft.com/kb/103000"}]}, {"text": ["Search for \"A Win32 program that can be started by the Service Controller and that obeys the service control protocol.", "\" This is the kind of service you're interested in."], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"text": ["The service registration (contents of KEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\n\\myservice) carries information about the service, including things like its executable location, what to do when it fails (halt the OS?", "), what services must be started before this one, what user it runs as."], "childNum": 0, "tag": "p", "senID": 3, "childList": []}, {"text": ["As to service control protocol, main() of your program is supposed to invoke a Windows API call, setting up callbacks for start, stop, pause for your service.", "What you do in those callbacks is all up to you."], "childNum": 0, "tag": "p", "senID": 4, "childList": []}], [{"text": ["Don't muck with the registry directly.", "User the SC command-line tool.", "Namely, SC CREATE"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\nDESCRIPTION:\n        SC is a command line program used for communicating with the\n        NT Service Controller and services.\n    USAGE:\n        sc  [command] [service name]  ...\n\n        The option  has the form \"\\\\ServerName\"\n        Further help on commands can be obtained by typing: \"sc [command]\"\n        Commands:\n          query-----------Queries the status for a service, or\n                          enumerates the status for types of services.\n          queryex---------Queries the extended status for a service, or\n                          enumerates the status for types of services.\n          start-----------Starts a service.\n          pause-----------Sends a PAUSE control request to a service.\n          interrogate-----Sends an INTERROGATE control request to a service.\n          continue--------Sends a CONTINUE control request to a service.\n          stop------------Sends a STOP request to a service.\n          config----------Changes the configuration of a service (persistant).\n          description-----Changes the description of a service.\n          failure---------Changes the actions taken by a service upon failure.\n          qc--------------Queries the configuration information for a service.\n          qdescription----Queries the description for a service.\n          qfailure--------Queries the actions taken by a service upon failure.\n          delete----------Deletes a service (from the registry).\n          create----------Creates a service. (adds it to the registry).\n          control---------Sends a control to a service.\n          sdshow----------Displays a service's security descriptor.\n          sdset-----------Sets a service's security descriptor.\n          GetDisplayName--Gets the DisplayName for a service.\n          GetKeyName------Gets the ServiceKeyName for a service.\n          EnumDepend------Enumerates Service Dependencies.\n\n        The following commands don't require a service name:\n        sc   \n          boot------------(ok | bad) Indicates whether the last boot should\n                          be saved as the last-known-good boot configuration\n          Lock------------Locks the Service Database\n          QueryLock-------Queries the LockStatus for the SCManager Database\n    EXAMPLE:\n        sc start MyService\n</pre>\n", "senID": 1}], [{"text": ["You can use srvany.exe from Windows NT Resource Kit to create a user defined service that will show up in the admin tools..."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["http://support.microsoft.com/kb/137890"], "childNum": 1, "tag": "p", "senID": 1, "childList": [{"text": "http://support.microsoft.com/kb/137890", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://support.microsoft.com/kb/137890"}]}, {"text": ["I am using this method to run tracd (a python script / server) for trac. "], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"text": ["Here are some very clear instructions: http://www.tacktech.com/display.cfm?ttid=197"], "childNum": 1, "tag": "p", "senID": 3, "childList": [{"text": "http://www.tacktech.com/display.cfm?ttid=197", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://www.tacktech.com/display.cfm?ttid=197"}]}, {"text": ["It does require some registry editing (very minimal and easy) but will allow you to make any command line / script a windows service. "], "childNum": 0, "tag": "p", "senID": 4, "childList": []}], [{"text": ["web2py can run as a windows service.", "It may help you to look into web2y/gluon/winservice.py."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}], [{"text": ["A well written service (and most services written as described in the links posted by Espo) are auto-registering, that meaning that when passed \"install\" on the command line, they should register themselves."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}]]