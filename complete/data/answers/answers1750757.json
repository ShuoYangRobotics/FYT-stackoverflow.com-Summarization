[[{"text": ["In Linux, or any other form of unix, os.execl and friends are a good choice for this -- you just need to re-exec sys.executable with the same parameters it was executed with last time (sys.argv, more or less) or any variant thereof if you need to inform your next incarnation that it's actually a restart.", "On Windows, os.spawnl (and friends) is about the best you can do (though it will transiently take more time and memory than os.execl and friends would during the transition)."], "childNum": 4, "tag": "p", "senID": 0, "childList": [{"text": "os.execl", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://docs.python.org/library/os.html?highlight=os.exec#os.execl"}, {"text": "sys.executable", "tag": "a", "pos": -1, "childList": [], "childNum": 0, "href": "http://docs.python.org/library/sys.html?highlight=sys.executable#sys.executable"}, {"text": "sys.argv", "childNum": 0, "tag": "code", "pos": -1, "childList": []}, {"text": "os.spawnl", "tag": "a", "pos": 1, "childList": [], "childNum": 0, "href": "http://docs.python.org/library/os.html?highlight=os.spawn#os.spawnl"}]}], [{"text": ["The pocoo team have a very good reloader for their development server inside of werkzueg.", "Check the code out here (it's towards the bottom of the file)."], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "here", "tag": "a", "pos": 1, "childList": [], "childNum": 0, "href": "http://dev.pocoo.org/projects/werkzeug/browser/werkzeug/serving.py"}]}], [{"text": ["The cleanest solution is a separate update script!"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["Run your program inside it, report back (when exiting) that a new version is available.", "This allows your program to save all of its data, the updater to apply the update, and run the new version, which then loads the saved data and continues.", "To the user this can be completely transparent, as they just run the updater-shell which runs the real program."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}], [{"text": ["You can use reload() to reload a module."], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "reload()", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://docs.python.org/library/functions.html#reload"}]}], [{"text": ["I think the best solution whould be something like this:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["Your normal program:"], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"code": "<pre>\n<code>\n ...\n\n# ... part that downloaded newest files and put it into the \"newest\" folder\n\nfrom subprocess import Popen\n\nPopen(\"/home/code/reloader.py\", shell=True) # start reloader\n\nexit(\"exit for updating all files\")\n</code>\n</pre>\n", "senID": 2}, {"text": ["The update script: (e.g.", ": home/code/reloader.py)"], "childNum": 0, "tag": "p", "senID": 3, "childList": []}, {"code": "<pre>\n<code>\n from shutil import copy2, rmtree\nfrom sys import exit\n\n# maybie you could do this automatic:\ncopy2(\"/home/code/newest/file1.py\", \"/home/code/\") # copy file\ncopy2(\"/home/code/newest/file2.py\", \"/home/code/\")\ncopy2(\"/home/code/newest/file3.py\", \"/home/code/\")\n...\n\nrmtree('/home/code/newest') # will delete the folder itself\n\nPopen(\"/home/code/program.py\", shell=True) # go back to your program\n\nexit(\"exit to restart the true program\")\n</code>\n</pre>\n", "senID": 4}, {"text": ["I hope this will help you."], "childNum": 0, "tag": "p", "senID": 5, "childList": []}], [{"text": ["The CherryPy project has code that restarts itself.", "Here's how they do it:"], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "how they do it", "tag": "a", "pos": 1, "childList": [], "childNum": 0, "href": "http://www.cherrypy.org/browser/trunk/py2/cherrypy/process/wspbus.py#L345"}]}, {"code": "<pre>\n<code>\n args = sys.argv[:]\n    self.log('Re-spawning %s' % ' '.join(args))\n\n    args.insert(0, sys.executable)\n    if sys.platform == 'win32':\n        args = ['\"%s\"' % arg for arg in args]\n\n    os.chdir(_startup_cwd)\n    os.execv(sys.executable, args)\n</code>\n</pre>\n", "senID": 1}, {"text": ["I've used this technique in my own code, and it works great.", "(I didn't bother to do the argument-quoting step on windows above, but it's probably necessary if arguments could contain spaces or other special characters."], "childNum": 0, "tag": "p", "senID": 2, "childList": []}]]