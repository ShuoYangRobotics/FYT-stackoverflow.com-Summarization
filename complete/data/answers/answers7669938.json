[[{"text": ["One problem is that there are multiple \"pretty names\" , like \"Australia/Sydney\" , which point to the same time zone (e.g.", "CST)."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["So you will need to get all the possible names for the local time zone, and then select the name you like."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"text": ["e.g.", ": for Australia, there are 5 time zones, but way more time zone identifiers:"], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"code": "<pre>\n<code>\n \"Australia/Lord_Howe\", \"Australia/Hobart\", \"Australia/Currie\", \n     \"Australia/Melbourne\", \"Australia/Sydney\", \"Australia/Broken_Hill\", \n     \"Australia/Brisbane\", \"Australia/Lindeman\", \"Australia/Adelaide\", \n     \"Australia/Darwin\", \"Australia/Perth\", \"Australia/Eucla\"\n</code>\n</pre>\n", "senID": 3}, {"text": ["you should check if there is a library which wraps TZinfo , to handle the time zone API."], "childNum": 1, "tag": "p", "senID": 4, "childList": [{"text": "library which wraps TZinfo", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}]}, {"text": ["e.g.", ": for Python, check thepytzlibrary: "], "childNum": 2, "tag": "p", "senID": 5, "childList": [{"text": "for Python, check thepytzlibrary:", "childNum": 1, "tag": "strong", "pos": 1, "childList": [{"text": "pytz", "tag": "code"}]}, {"text": "pytz", "childNum": 0, "tag": "code", "childList": []}]}, {"text": ["http://pytz.sourceforge.net/"], "childNum": 1, "tag": "p", "senID": 6, "childList": [{"text": "http://pytz.sourceforge.net/", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://pytz.sourceforge.net/"}]}, {"text": ["and"], "childNum": 0, "tag": "p", "senID": 7, "childList": []}, {"text": ["http://pypi.python.org/pypi/pytz/"], "childNum": 1, "tag": "p", "senID": 8, "childList": [{"text": "http://pypi.python.org/pypi/pytz/", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://pypi.python.org/pypi/pytz/"}]}, {"text": ["in Python you can do:"], "childNum": 0, "tag": "p", "senID": 9, "childList": []}, {"code": "<pre>\n<code>\n from pytz import timezone\nimport pytz\n\nIn [56]: pytz.country_timezones('AU')\nOut[56]: \n[u'Australia/Lord_Howe',\n u'Australia/Hobart',\n u'Australia/Currie',\n u'Australia/Melbourne',\n u'Australia/Sydney',\n u'Australia/Broken_Hill',\n u'Australia/Brisbane',\n u'Australia/Lindeman',\n u'Australia/Adelaide',\n u'Australia/Darwin',\n u'Australia/Perth',\n u'Australia/Eucla']\n</code>\n</pre>\n", "senID": 10}, {"text": ["but the API for Python seems to be pretty limited, e.g.", "it doesn't seem to have a call like Ruby's all_linked_zone_names -- which can find all the synonym names for a given time zone."], "childNum": 1, "tag": "p", "senID": 11, "childList": [{"text": "all_linked_zone_names", "childNum": 0, "tag": "code", "pos": 1, "childList": []}]}], [{"text": ["This is kind of cheating, I know, but getting from '/etc/localtime' doesn't work for you?", "Like following:"], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "'/etc/localtime'", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"code": "<pre>\n<code>\n &gt;&gt;&gt;  import os\n&gt;&gt;&gt; '/'.join(os.readlink('/etc/localtime').split('/')[-2:])\n'Australia/Sydney'\n</code>\n</pre>\n", "senID": 1}, {"text": ["Hope it helps."], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"text": ["Edit: I liked @A.H.'s idea, in case  '/etc/localtime' isn't a symlink.", "Translating that into Python:"], "childNum": 2, "tag": "p", "senID": 3, "childList": [{"text": "Edit", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}, {"text": "'/etc/localtime'", "childNum": 0, "tag": "code", "pos": -1, "childList": []}]}, {"code": "<pre>\n<code>\n #!/usr/bin/env python\n\nfrom hashlib import sha224\nimport os\n\ndef get_current_olsonname():\n    tzfile = open('/etc/localtime')\n    tzfile_digest = sha224(tzfile.read()).hexdigest()\n    tzfile.close()\n\n    for root, dirs, filenames in os.walk(\"/usr/share/zoneinfo/\"):\n        for filename in filenames:\n            fullname = os.path.join(root, filename)\n            f = open(fullname)\n            digest = sha224(f.read()).hexdigest()\n            if digest == tzfile_digest:\n                return '/'.join((fullname.split('/'))[-2:])\n            f.close()\n        return None\n\nif __name__ == '__main__':\n    print get_current_olsonname()\n</code>\n</pre>\n", "senID": 4}], [{"text": ["I think best bet is to go thru all pytz timezones and check which one matches local timezone, each pytz timezone object contains info about utcoffset and tzname like CDT, EST, same info about local time can be obtained from time.timezone/altzone and time.tzname, and I think that is enough to correctly match local timezone in pytz database e.g."], "childNum": 2, "tag": "p", "senID": 0, "childList": [{"text": "time.timezone/altzone", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "time.tzname", "childNum": 0, "tag": "code", "childList": []}]}, {"code": "<pre>\n<code>\n import time\nimport pytz\nimport datetime\n\nlocal_names = []\nif time.daylight:\n    local_offset = time.altzone\n    localtz = time.tzname[1]\nelse:\n    local_offset = time.timezone\n    localtz = time.tzname[0]\n\nlocal_offset = datetime.timedelta(seconds=-local_offset)\n\nfor name in pytz.all_timezones:\n    timezone = pytz.timezone(name)\n    if not hasattr(timezone, '_tzinfos'):\n        continue#skip, if some timezone doesn't have info\n    # go thru tzinfo and see if short name like EDT and offset matches\n    for (utcoffset, daylight, tzname), _ in timezone._tzinfos.iteritems():\n        if utcoffset == local_offset and tzname == localtz:\n            local_names.append(name)\n\nprint local_names\n</code>\n</pre>\n", "senID": 1}, {"text": ["output:"], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"text": ["In production you can create such a mapping beforehand and save it instead of iterating always."], "childNum": 0, "tag": "p", "senID": 3, "childList": []}, {"text": ["Testing script after changing timezone:"], "childNum": 0, "tag": "p", "senID": 4, "childList": []}], [{"text": ["Install pytz"], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "Install pytz", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://sourceforge.net/projects/pytz/"}]}, {"code": "<pre>\n<code>\n import pytz\nimport time\n#import locale\nimport urllib2\n\nyourOlsonTZ = None\n#yourCountryCode = locale.getdefaultlocale()[0].split('_')[1]\nyourCountryCode = urllib2.urlopen('http://api.hostip.info/country.php').read()\n\nfor olsonTZ in [pytz.timezone(olsonTZ) for olsonTZ in pytz.all_timezones]:\n    if (olsonTZ._tzname in time.tzname) and (str(olsonTZ) in pytz.country_timezones[yourCountryCode]):\n        yourOlsonTZ = olsonTZ\n        break\n\nprint yourOlsonTZ\n</code>\n</pre>\n", "senID": 1}, {"text": ["This code will take a best-guess crack at your Olson Timezone based both on your Timezone Name (as according to Python's time module), and your Country Code (as according to Python'slocalemodule the hostip.info project, which references your IP address and geolocates you accordingly)."], "childNum": 4, "tag": "p", "senID": 2, "childList": [{"text": "time", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "Python'slocalemodule", "childNum": 1, "tag": "strike", "childList": [{"text": "locale", "tag": "code"}]}, {"text": "locale", "childNum": 0, "tag": "code", "childList": []}, {"href": "http://www.hostip.info/", "text": "hostip.info", "childNum": 0, "tag": "a", "childList": []}]}, {"text": ["For example, simply matching the Timzone Names could result in America/Moncton, America/Montreal, or America/New_York for EST (GMT-5).", "If your country is the US, however, it will limit the answer to America/New_York."], "childNum": 4, "tag": "p", "senID": 3, "childList": [{"text": "America/Moncton", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "America/Montreal", "childNum": 0, "tag": "code", "pos": -1, "childList": []}, {"text": "America/New_York", "childNum": 0, "tag": "code", "pos": 1, "childList": []}, {"text": "America/New_York", "childNum": 0, "tag": "code", "childList": []}]}, {"text": ["However, if your country is Canada, the script will simply default to the topmost Canadian result (America/Moncton).", "If there is a way to further refine this, please feel free to leave suggestions in comments."], "childNum": 1, "tag": "p", "senID": 4, "childList": [{"text": "America/Moncton", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}], [{"text": ["If evaluating /etc/localtime is OK for you, the following trick might work - after translating it to python:"], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "/etc/localtime", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"code": "<pre>\n<code>\n &gt; md5sum /etc/localtime\nabcdefabcdefabcdefabcdefabcdefab /etc/localtime\n&gt; find /usr/share/zoneinfo -type f |xargs md5sum | grep abcdefabcdefabcdefabcdefabcdefab\nabcdefabcdefabcdefabcdefabcdefab /usr/share/zoneinfo/Europe/London\nabcdefabcdefabcdefabcdefabcdefab /usr/share/zoneinfo/posix/Europe/London\n...\n</code>\n</pre>\n", "senID": 1}, {"text": ["The duplicates could be filtered using only the official region names \"Europe\", \"America\" ...", "If there are still duplicates, you could take the shortest name :-)"], "childNum": 0, "tag": "p", "senID": 2, "childList": []}], [{"text": ["This will get you the time zone name, according to what's in the TZ variable, or localtime file if unset:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n #! /usr/bin/env python\n\nimport time\n\ntime.tzset\nprint time.tzname\n</code>\n</pre>\n", "senID": 1}]]