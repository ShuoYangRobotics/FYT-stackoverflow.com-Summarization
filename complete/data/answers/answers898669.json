[[{"text": ["You can also use the mimetypes module:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n import mimetypes\n...\nmime = mimetypes.guess_type(file)\n</code>\n</pre>\n", "senID": 1}, {"text": ["It's fairly easy to compile a list of binary mime types.", "For example Apache distributes with a mime.types file that you could parse into a set of lists, binary and text and then check to see if the mime is in your text or binary list."], "childNum": 0, "tag": "p", "senID": 2, "childList": []}], [{"text": ["If it helps, many many binary types begin with a magic numbers.", "Here is a list of file signatures."], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "Here is a list", "tag": "a", "pos": 1, "childList": [], "childNum": 0, "href": "http://www.garykessler.net/library/file%5Fsigs.html"}]}], [{"text": ["Here's a suggestion that uses the Unix file command:"], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "file", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://en.wikipedia.org/wiki/File%5F%28Unix%29"}]}, {"code": "<pre>\n<code>\n import re\nimport subprocess\n\ndef istext(path):\n    return (re.search(r':.* text',\n                      subprocess.Popen([\"file\", '-L', path], \n                                       stdout=subprocess.PIPE).stdout.read())\n            is not None)\n</code>\n</pre>\n", "senID": 1}, {"text": ["Example usage:"], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"code": "<pre>\n>>> istext('/etc/motd') \nTrue\n>>> istext('/vmlinuz') \nFalse\n>>> open('/tmp/japanese').read()\n'\\xe3\\x81\\x93\\xe3\\x82\\x8c\\xe3\\x81\\xaf\\xe3\\x80\\x81\\xe3\\x81\\xbf\\xe3\\x81\\x9a\\xe3\\x81\\x8c\\xe3\\x82\\x81\\xe5\\xba\\xa7\\xe3\\x81\\xae\\xe6\\x99\\x82\\xe4\\xbb\\xa3\\xe3\\x81\\xae\\xe5\\xb9\\x95\\xe9\\x96\\x8b\\xe3\\x81\\x91\\xe3\\x80\\x82\\n'\n>>> istext('/tmp/japanese') # works on UTF-8\nTrue\n</pre>\n", "senID": 3}, {"text": ["It has the downsides of not being portable to Windows (unless you have something like the file command there), and having to spawn an external process for each file, which might not be palatable."], "childNum": 1, "tag": "p", "senID": 4, "childList": [{"text": "file", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}], [{"text": ["Try this:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n def is_binary(filename):\n    \"\"\"Return true if the given filename is binary.\n    @raise EnvironmentError: if the file does not exist or cannot be accessed.\n    @attention: found @ http://bytes.com/topic/python/answers/21222-determine-file-type-binary-text on 6/08/2010\n    @author: Trent Mick &lt;TrentM@ActiveState.com&gt;\n    @author: Jorge Orpinel &lt;jorge@orpinel.com&gt;\"\"\"\n    fin = open(filename, 'rb')\n    try:\n        CHUNKSIZE = 1024\n        while 1:\n            chunk = fin.read(CHUNKSIZE)\n            if '\\0' in chunk: # found null byte\n                return True\n            if len(chunk) &lt; CHUNKSIZE:\n                break # done\n    # A-wooo! Mira, python no necesita el \"except:\". Achis... Que listo es.\n    finally:\n        fin.close()\n\n    return False\n</code>\n</pre>\n", "senID": 1}], [{"text": ["Usually you have to guess."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["You can look at the extensions as one clue, if the files have them."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"text": ["You can also recognise know binary formats, and ignore those."], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"text": ["Otherwise see what proportion of non-printable ASCII bytes you have and take a guess from that."], "childNum": 0, "tag": "p", "senID": 3, "childList": []}, {"text": ["You can also try decoding from UTF-8 and see if that produces sensible output."], "childNum": 0, "tag": "p", "senID": 4, "childList": []}], [{"text": ["are you in unix?", "if so, then try:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n isBinary = os.system(\"file -b\" + name + \" | grep text &gt; /dev/null\")\n</code>\n</pre>\n", "senID": 1}, {"text": ["The shell return values are inverted (0 is ok, so if it finds \"text\" then it will return a 0, and in Python that is a False expression)."], "childNum": 0, "tag": "p", "senID": 2, "childList": []}], [{"text": ["If you're not on Windows, you can use Python Magic to determine the filetype.", "Then you can check if it is a text/ mime type."], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "Python Magic", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://pypi.python.org/pypi/python-magic/0.1"}]}], [{"text": ["Yet another method based on file(1) behavior:"], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "based on file(1) behavior", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "https://github.com/hamilyon/status/blob/8d05f9b7d95caa1bd1e52966ae8be9b23c442972/grin.py#26"}]}, {"code": "<pre>\n<code>\n &gt;&gt;&gt; textchars = ''.join(map(chr, [7,8,9,10,12,13,27] + range(0x20, 0x100)))\n&gt;&gt;&gt; is_binary_string = lambda bytes: bool(bytes.translate(None, textchars))\n</code>\n</pre>\n", "senID": 1}, {"text": ["Example:"], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"code": "<pre>\n<code>\n &gt;&gt;&gt; is_binary_string(open('/usr/bin/python').read(1024))\nTrue\n&gt;&gt;&gt; is_binary_string(open('/usr/bin/bpython').read(1024))\nFalse\n</code>\n</pre>\n", "senID": 3}], [{"text": ["I guess that the best solution is to use the guess_type function.", "It holds a list with several mimetypes and you can also include your own types.", "Here come the script that I did to solve my problem:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n from mimetypes import guess_type\nfrom mimetypes import add_type\n\ndef __init__(self):\n        self.__addMimeTypes()\n\ndef __addMimeTypes(self):\n        add_type(\"text/plain\",\".properties\")\n\ndef __listDir(self,path):\n        try:\n            return listdir(path)\n        except IOError:\n            print (\"The directory {0} could not be accessed\".format(path))\n\ndef getTextFiles(self, path):\n        asciiFiles = []\n        for files in self.__listDir(path):\n            if guess_type(files)[0].split(\"/\")[0] == \"text\":\n                asciiFiles.append(files)\n        try:\n            return asciiFiles\n        except NameError:\n            print (\"No text files in directory: {0}\".format(path))\n        finally:\n            del asciiFiles\n</code>\n</pre>\n", "senID": 1}, {"text": ["It is inside of a Class, as you can see based on the ustructure of the code.", "But you can pretty much change the things you want to implement it inside your application.", "It`s quite simple to use.", "The method getTextFiles returns a list object with all the text files that resides on the directory you pass in path variable."], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"text": ["Regards,\nLeonardo"], "childNum": 0, "tag": "p", "senID": 3, "childList": []}], [{"text": ["I came here looking for exactly the same thing--a comprehensive solution provided by the standard library to detect binary or text.", "After reviewing the options people suggested, the nix file command looks to be the best choice (I'm only developing for linux boxen).", "Some others posted solutions using file but they are unnecessarily complicated in my opinion, so here's what I came up with:"], "childNum": 2, "tag": "p", "senID": 0, "childList": [{"text": "file", "childNum": 0, "tag": "strong", "pos": 1, "childList": []}, {"text": "file", "childNum": 0, "tag": "strong", "pos": 2, "childList": []}]}, {"code": "<pre>\n<code>\n def test_file_isbinary(filename):\n    cmd = shlex.split(\"file -b -e soft '{}'\".format(filename))\n    if subprocess.check_output(cmd)[:4] in {'ASCI', 'UTF-'}:\n        return False\n    return True\n</code>\n</pre>\n", "senID": 1}, {"text": ["It should go without saying, but your code that calls this function should make sure you can read a file before testing it, otherwise this will be mistakenly detect the file as binary."], "childNum": 0, "tag": "p", "senID": 2, "childList": []}]]