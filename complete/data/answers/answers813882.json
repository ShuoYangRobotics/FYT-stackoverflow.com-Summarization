[[{"text": ["You mean \"return the output as a dictionary\" - be careful ;-)"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["One thing you could do is use the ability of the Python interpreter to automatically convert to a string the result of any expression.", "To do this, create a custom subclass of dict that, when asked to convert itself to a string, performs whatever pretty formatting you want.", "For instance,"], "childNum": 1, "tag": "p", "senID": 1, "childList": [{"text": "dict", "childNum": 0, "tag": "code", "pos": 1, "childList": []}]}, {"code": "<pre>\n<code>\n class PrettyDict(dict):\n    def __str__(self):\n        return '''Pretty printer status check 0.02v\nNOTE: This is so totally not written for giant robots\n=================================\nSystem operational: ... %s\nTime to ion canon charge is %dm %ds\nBooster rocket in %s state\n (other stuff)\n''' % (self.conf_op and 'ok' or 'OMGPANIC!!!',\n       self.t_canoncharge / 60, self.t_canoncharge % 60, \n       BOOSTER_STATES[self.booster_charge],\n       ... )\n</code>\n</pre>\n", "senID": 2}, {"text": ["Of course you could probably come up with a prettier way to write the code, but the basic idea is that the __str__ method creates the pretty-printed string that represents the state of the object and returns it.", "Then, if you return a PrettyDict from your check_status() function, when you type"], "childNum": 3, "tag": "p", "senID": 3, "childList": [{"text": "__str__", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "PrettyDict", "childNum": 0, "tag": "code", "pos": 1, "childList": []}, {"text": "check_status()", "childNum": 0, "tag": "code", "childList": []}]}, {"code": "<pre>\n<code>\n &gt;&gt;&gt; check_status()\n</code>\n</pre>\n", "senID": 4}, {"text": ["you would see"], "childNum": 0, "tag": "p", "senID": 5, "childList": []}, {"code": "<pre>\nPretty printer status check 0.02v\nNOTE: This is so totally not written for giant robots\n=================================\nSystem operational: ... ok\nTime to ion canon charge is 9m 21s\nBooster rocket in AFTERBURNER state\nRange check is optimal\nRocket fuel is 10h 19m 40s to depletion\nBeer served is type WICKSE LAGER, chill optimal\nSuggested catchphrase is 01_FIGHTING_SPIRIT_GOGOGO\nVirtual ... on\n</pre>\n", "senID": 6}, {"text": ["The only catch is that"], "childNum": 0, "tag": "p", "senID": 7, "childList": []}, {"code": "<pre>\n<code>\n &gt;&gt;&gt; not_robot_stat = check_status()\n&gt;&gt;&gt; print not_robot_stat\n</code>\n</pre>\n", "senID": 8}, {"text": ["would give you the same thing, because the same conversion to string takes place as part of the print function.", "But for using this in some real application, I doubt that that would matter.", "If you really wanted to see the return value as a pure dict, you could do"], "childNum": 1, "tag": "p", "senID": 9, "childList": [{"text": "print", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"code": "<pre>\n<code>\n &gt;&gt;&gt; print repr(not_robot_stat)\n</code>\n</pre>\n", "senID": 10}, {"text": ["instead, and it should show you"], "childNum": 0, "tag": "p", "senID": 11, "childList": []}, {"code": "<pre>\n{'cond_op': 1, 't_canoncharge': 1342, 'stage_booster': 5, 'range_est_sigma': 0.023, 'fuel_est': 32557154, 'beer_type': 31007, 'beer_temp': 2, 'catchphrase_suggestion': 1023, 'virtual_on': 'hell yes'}\n</pre>\n", "senID": 12}, {"text": ["The point is that, as other posters have said, there is no way for a function in Python to know what's going to be done with it's return value (EDIT: okay, maybe there would be some weird bytecode-hacking way, but don't do that) - but you can work around it in the cases that matter."], "childNum": 1, "tag": "p", "senID": 13, "childList": [{"text": "EDIT", "childNum": 0, "tag": "em", "pos": 0, "childList": []}]}], [{"text": ["New Solution"], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "New Solution", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}]}, {"text": ["This is a new that solution detects when the result of the function is used for assignment by examining its own bytecode.", "There is no bytecode writing done, and it should even be compatible with future versions of Python because it uses the opcode module for definitions."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"code": "<pre>\n<code>\n import inspect, dis, opcode\n\ndef check_status():\n\n    try:\n        frame = inspect.currentframe().f_back\n        next_opcode = opcode.opname[ord(frame.f_code.co_code[frame.f_lasti+3])]\n        if next_opcode == \"POP_TOP\": \n            # or next_opcode == \"RETURN_VALUE\":\n            # include the above line in the if statement if you consider \"return check_status()\" to be assignment\n            print \"I was not assigned\"\n            print \"Pretty printer status check 0.02v\"\n            print \"NOTE: This is so totally not written for giant robots\"\n            return\n    finally:\n        del frame    \n\n    # do normal routine\n\n    info = {'cond_op': 1, 't_canoncharge': 1342, 'stage_booster': 5}\n\n    return info\n\n# no assignment    \ndef test1():\n    check_status()\n\n# assignment\ndef test2():\n    a = check_status()\n\n# could be assignment (check above for options)\ndef test3():\n    return check_status()\n\n# assignment\ndef test4():\n    a = []\n    a.append(check_status())\n    return a\n</code>\n</pre>\n", "senID": 2}, {"text": ["Solution 1"], "childNum": 1, "tag": "p", "senID": 3, "childList": [{"text": "Solution 1", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}]}, {"text": ["This is the old solution that detects whenever you are calling the function while debugging under python -i or PDB."], "childNum": 0, "tag": "p", "senID": 4, "childList": []}, {"code": "<pre>\n<code>\n import inspect\n\ndef check_status():\n    frame = inspect.currentframe()\n    try:\n        if frame.f_back.f_code.co_name == \"&lt;module&gt;\" and frame.f_back.f_code.co_filename == \"&lt;stdin&gt;\":\n            print \"Pretty printer status check 0.02v\"\n            print \"NOTE: This is so totally not written for giant robots\"\n    finally:\n        del frame\n\n    # do regular stuff   \n    return {'cond_op': 1, 't_canoncharge': 1342, 'stage_booster': 5}\n\ndef test():\n    check_status()\n\n\n&gt;&gt;&gt; check_status()\nPretty printer status check 0.02v\nNOTE: This is so totally not written for giant robots\n{'cond_op': 1, 't_canoncharge': 1342, 'stage_booster': 5}\n\n&gt;&gt;&gt; a=check_status()\nPretty printer status check 0.02v\nNOTE: This is so totally not written for giant robots\n\n&gt;&gt;&gt; a\n{'cond_op': 1, 't_canoncharge': 1342, 'stage_booster': 5}\n\ntest()\n&gt;&gt;&gt;\n</code>\n</pre>\n", "senID": 5}], [{"text": ["There's no use case for this.", "Python assigns all interactive results to a special variable named _.  "], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "_", "childNum": 0, "tag": "code", "pos": 1, "childList": []}]}, {"text": ["You can do the following interactively.", "Works great.", "No funny business."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"code": "<pre>\n<code>\n &gt;&gt;&gt; check_status()\n{'cond_op': 1, 't_canoncharge': 1342, 'stage_booster': 5, 'range_est_sigma': 0.023, 'fuel_est': 32557154, 'beer_type': 31007, 'beer_temp': 2, 'catchphrase_suggestion': 1023, 'virtual_on': 'hell yes'}\n\n&gt;&gt;&gt; pprint.pprint( _ )\n{'beer_temp': 2,\n 'beer_type': 31007,\n 'catchphrase_suggestion': 1023,\n 'cond_op': 1,\n 'fuel_est': 32557154,\n 'range_est_sigma': 0.023,\n 'stage_booster': 5,\n 't_canoncharge': 1342,\n 'virtual_on': 'hell yes'}\n</code>\n</pre>\n", "senID": 2}], [{"text": ["There is no way for a function to know how its return value is being used."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["Well, as you mention, egregious bytecode hacks might be able to do it, but it would be really complicated and probably fragile.", "Go the simpler explicit route."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}], [{"text": ["Even if there is a way to do this, it's a bad idea.", "Imagine trying to debug something that behaves differently depending on the context it's called from.", "Now try to imagine that it's six months from now and this is buried in part of some system that's too big to keep in your head all at once."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["Keep it simple.", "Explicit is better than implicit.", "Just make a pretty-print function (or use the pprint module) and call that on the result.", "In an interactive Pythn session you can use _ to get the value of the last expression."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}], [{"text": ["There is no way to do this, at least not with the normal syntax procedures, because the function call and the assignment are completely independent operations, which have no awareness of each other."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["The simplest workaround I can see for this is to pass a flag as an arg to your check_status function, and deal with it accordingly."], "childNum": 1, "tag": "p", "senID": 1, "childList": [{"text": "check_status", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"code": "<pre>\n<code>\n def check_status(return_dict=False) :\n    if return_dict :\n        # Return stuff here.\n    # Pretty Print stuff here.\n</code>\n</pre>\n", "senID": 2}, {"text": ["And then..."], "childNum": 0, "tag": "p", "senID": 3, "childList": []}, {"code": "<pre>\n<code>\n check_status() # Pretty print\nnot_robot_stat = check_status(True) # Get the dict.\n</code>\n</pre>\n", "senID": 4}, {"text": ["EDIT: I assumed you'd be pretty printing more often than you'd assign.", "If that's not the case, interchange the default value and the value you pass in."], "childNum": 0, "tag": "p", "senID": 5, "childList": []}], [{"text": ["The only way to do what you want is indeed \"to play with the bytecode\" -- there is no other way to recover that info.", "A much better way, of course, is to provide two separate functions: one to get the status as a dict, the other to call the first one and format it.  "], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["Alternatively (but not an excellent architecture) you could have a single function that takes an optional parameter to behave in these two utterly different ways -- this is not excellent because a function should have ONE function, i.e.", "basically do ONE thing, not two different ones such as these."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}]]