[[{"text": ["Since lines can be of arbitrary length, you really can't get at a random line (whether you mean \"a line whose number is actually random\" or \"a line with an arbitrary number, selected by me\") without traversing the whole file."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["If kinda-sorta-random is enough, you can seek to a random place in the file and then read forward until you hit a line terminator.", "But that's useless if you want to find (say) line number 1234, and will sample lines non-uniformly if you actually want a randomly chosen line."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}], [{"text": ["file objects have a seek method which can take a value to particular byte within that file.", "For traversing through the large files, iterate over it and check for the value in each line.", "Iterating the file object does not load the whole file content into memory."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}], [{"text": ["Yes, you can easily get a random line.", "Just seek to a random position in the file, then seek towards the beginning until you hit a \\n or the beginning of the file, then read a line."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["Code:"], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"code": "<pre>\n<code>\n import sys,random\nwith open(sys.argv[1],\"r\") as f:\n    f.seek(0,2)                 # seek to end of file\n    bytes = f.tell()\n    f.seek(int(bytes*random.random()))\n\n    # Now seek forward until beginning of file or we get a \\n\n    while True:\n        f.seek(-2,1)\n        ch = f.read(1)\n        if ch=='\\n': break\n        if f.tell()==1: break\n\n    # Now get a line\n    print f.readline()\n</code>\n</pre>\n", "senID": 2}], [{"text": ["The File object supports seek but make sure that you open them as binary, i.e.", "\"rb\"."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["You may also wish to use the mmap module for random access, particularly if the data is in an internal format already."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}], [{"text": ["This seems like just the sort of thing mmap was designed for.", "A mmap object creates a string-like interface to a file:"], "childNum": 3, "tag": "p", "senID": 0, "childList": [{"text": "mmap", "tag": "a", "pos": 0, "childList": [{"text": "mmap", "tag": "code"}], "childNum": 1, "href": "http://docs.python.org/library/mmap.html"}, {"text": "mmap", "childNum": 0, "tag": "code", "pos": 1, "childList": []}, {"text": "mmap", "childNum": 0, "tag": "code", "childList": []}]}, {"code": "<pre>\n<code>\n &gt;&gt;&gt; f = open(\"bonnie.txt\", \"wb\")\n&gt;&gt;&gt; f.write(\"My Bonnie lies over the ocean.\")\n&gt;&gt;&gt; f.close()\n&gt;&gt;&gt; f.open(\"bonnie.txt\", \"r+b\")\n&gt;&gt;&gt; map = mmap(f.fileno(), 0)\n&gt;&gt;&gt; print map[3:9]\nBonnie\n</code>\n</pre>\n", "senID": 1}, {"text": ["In case you were wondering, mmap objects can also be assigned to: "], "childNum": 1, "tag": "p", "senID": 2, "childList": [{"text": "mmap", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"code": "<pre>\n<code>\n &gt;&gt;&gt; print map[24:]\nocean.\n&gt;&gt;&gt; map[24:] = \"sea.  \"\n&gt;&gt;&gt; print map[:]\nMy Bonnie lies over the sea.\n</code>\n</pre>\n", "senID": 3}], [{"text": ["Has fixed-length records?", "If so, yes, you can implement a binary search algorithm using seeking."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["Otherwise, load your file into an SQLlite database.", "Query that."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}]]