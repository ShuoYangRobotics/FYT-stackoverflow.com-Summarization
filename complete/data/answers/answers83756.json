[[{"text": ["So far I've found the following Python solution:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n &gt;&gt;&gt; import wmi; c=wmi.WMI()\n&gt;&gt;&gt; o=c.query(\"select * from Win32_NetworkAdapter where NetConnectionID='wifi'\")[0]\n&gt;&gt;&gt; o.EnableDevice(1)\n(-2147217407,)\n</code>\n</pre>\n", "senID": 1}, {"text": ["which is translated, AFAIU, to the generic WMI error 0x80041001.", "Could be permissions."], "childNum": 0, "tag": "p", "senID": 2, "childList": []}], [{"text": ["Using the netsh interface \nUsage set interface [name = ] IfName\n            [ [admin = ] ENABLED|DISABLED\n              [connect = ] CONNECTED|DISCONNECTED\n              [newname = ] NewName ]"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["Try including everything inside the outer brackets:\nnetsh interface set interface name=\"thename\" admin=disabled connect=DISCONNECTED newname=\"thename\""], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"text": ["See also this MS KB page: http://support.microsoft.com/kb/262265/\nYou could follow either of their suggestions.", "For disabling the adapter, you will need to determine a way to reference the hardware device.", "If there will not be multiple adapters with the same name on the computer, you could possibly go off of the Description for the interface (or PCI ID works well).", "After that, using devcon (disable|enable).", "Devcon is an add-on console interface for the Device Manager."], "childNum": 1, "tag": "p", "senID": 2, "childList": [{"text": "http://support.microsoft.com/kb/262265/", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://support.microsoft.com/kb/262265/"}]}], [{"text": ["I can't seem to find any basic API for controlling interfaces on MSDN, apart from the RAS API's, but I don't think they apply to non-dialup connections.", "As you suggest yourself, netsh might be an option, supposedly it also has a programmatic interface: http://msdn.microsoft.com/en-us/library/ms708353(VS.85).aspx"], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "http://msdn.microsoft.com/en-us/library/ms708353(VS.85).aspx", "tag": "a", "pos": 1, "childList": [], "childNum": 0, "href": "http://msdn.microsoft.com/en-us/library/ms708353(VS.85).aspx"}]}, {"text": ["If you want to be pure Python, you can perhaps open a set of pipes to communicate with an netsh process."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}], [{"text": ["I found this .VBS script on the internet.", "It has the cool advantage of actually working on machines where I cannot get NETSH to work for this purpose."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n Const ssfCONTROLS = 3 \n\nsConnectionName = \"Local Area Connection\" \n\nsEnableVerb = \"En&amp;able\" \nsDisableVerb = \"Disa&amp;ble\" \n\nset shellApp = createobject(\"shell.application\") \nset oControlPanel = shellApp.Namespace(ssfCONTROLS) \n\nset oNetConnections = nothing \nfor each folderitem in oControlPanel.items \n  if folderitem.name = \"Network Connections\" then \n        set oNetConnections = folderitem.getfolder: exit for \nend if \nnext \n\nif oNetConnections is nothing then \nmsgbox \"Couldn't find 'Network Connections' folder\" \nwscript.quit \nend if \n\nset oLanConnection = nothing \nfor each folderitem in oNetConnections.items \nif lcase(folderitem.name) = lcase(sConnectionName) then \nset oLanConnection = folderitem: exit for \nend if \nnext \n\nif oLanConnection is nothing then \nmsgbox \"Couldn't find '\" &amp; sConnectionName &amp; \"' item\" \nwscript.quit \nend if \n\nbEnabled = true \nset oEnableVerb = nothing \nset oDisableVerb = nothing \ns = \"Verbs: \" &amp; vbcrlf \nfor each verb in oLanConnection.verbs \ns = s &amp; vbcrlf &amp; verb.name \nif verb.name = sEnableVerb then \nset oEnableVerb = verb \nbEnabled = false \nend if \nif verb.name = sDisableVerb then \nset oDisableVerb = verb \nend if \nnext \n\n'debugging displays left just in case... \n' \n'msgbox s ': wscript.quit \n'msgbox \"Enabled: \" &amp; bEnabled ': wscript.quit \n\n'not sure why, but invokeverb always seemed to work \n'for enable but not disable. \n' \n'saving a reference to the appropriate verb object \n'and calling the DoIt method always seems to work. \n' \nif bEnabled then \n' oLanConnection.invokeverb sDisableVerb \noDisableVerb.DoIt \nelse \n' oLanConnection.invokeverb sEnableVerb \noEnableVerb.DoIt \nend if \n\n'adjust the sleep duration below as needed... \n' \n'if you let the oLanConnection go out of scope \n'and be destroyed too soon, the action of the verb \n'may not take... \n' \nwscript.sleep 1000\n</code>\n</pre>\n", "senID": 1}], [{"text": ["The devcon tool can control the NIC, but not the interface directly.", "It's a command-line version of the Device Manager applet."], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "devcon", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://support.microsoft.com/kb/311272"}]}, {"code": "<pre>\n<code>\n devcon disable (id or portion of name)\ndevcon enable (id or portion of name)\n</code>\n</pre>\n", "senID": 1}], [{"text": ["this is VB.Net"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n Dim objectQuery As New ObjectQuery(\"SELECT * FROM Win32_NetworkAdapter WHERE NetConnectionId IS NOT NULL\")\n         Dim searcher As New ManagementObjectSearcher(scope, objectQuery)\n         Dim os As ManagementObject\n         Dim moColl As ManagementObjectCollection = searcher.Get()\n         Dim _list As String = \"\"\n         For Each os In moColl\n             Console.WriteLine(os(\"NetConnectionId\"))\n         Next os\n</code>\n</pre>\n", "senID": 1}, {"text": ["That will get all the interfaces on you computer.", "Then you can do netsh to disable it."], "childNum": 0, "tag": "p", "senID": 2, "childList": []}], [{"text": ["You may need to use WMI.", "This may serve as a good starting point:\nhttp://msdn.microsoft.com/en-us/library/aa394595.aspx"], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "http://msdn.microsoft.com/en-us/library/aa394595.aspx", "tag": "a", "pos": 1, "childList": [], "childNum": 0, "href": "http://msdn.microsoft.com/en-us/library/aa394595.aspx"}]}], [{"text": ["(en)Thanks for ideas.", "I made little script collection about enable/disable network interfaces, ICS, NAT and dial-up."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["(ge)Vielen Dank f\u00fcr die Tipps.", "Ich habe ein paar Scripts geschrieben rund um die Themen enable/disable von LAN Interfaces, ICS, NAT und Dial-up."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"text": ["Enjoy X-INetConnect 2.0 -> http://x-event.designo.ch/init/?q=ge/node/392"], "childNum": 1, "tag": "p", "senID": 2, "childList": [{"text": "http://x-event.designo.ch/init/?q=ge/node/392", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://x-event.designo.ch/init/?q=ge/node/392"}]}, {"text": ["Kind regard, steve"], "childNum": 0, "tag": "p", "senID": 3, "childList": []}]]