[[{"text": ["You can get the current revision number of a checkout using, on the command line, \"svn info\"."], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "svn info", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"text": ["For instance :"], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"code": "<pre>\n<code>\n $ svn info\nChemin : .\nURL : http://.../trunk\nRacine du d\u00e9p\u00f4t : http://...\nUUID du d\u00e9p\u00f4t : 128b9c1a-...-612a326c9977\nR\u00e9vision : 185\nType de n\u0153ud : r\u00e9pertoire\nT\u00e2che programm\u00e9e : normale\nAuteur de la derni\u00e8re modification : ...\nR\u00e9vision de la derni\u00e8re modification : 185\nDate de la derni\u00e8re modification: 2009-09-28 20:12:29 +0200 (lun. 28 sept. 2009)\n</code>\n</pre>\n", "senID": 2}, {"text": ["Note it's localized ; if you're on Linux, you could try using :"], "childNum": 0, "tag": "p", "senID": 3, "childList": []}, {"code": "<pre>\n<code>\n $ LANG=en svn info\nsvn: warning: cannot set LC_CTYPE locale\nsvn: warning: environment variable LANG is en\nsvn: warning: please check that your locale name is correct\nPath: .\nURL: http://.../trunk\nRepository Root: http://...\nRepository UUID: 128b9c1a-...-612a326c9977\nRevision: 185\nNode Kind: directory\nSchedule: normal\nLast Changed Author: mzeis\nLast Changed Rev: 185\nLast Changed Date: 2009-09-28 20:12:29 +0200 (Mon, 28 Sep 2009)\n</code>\n</pre>\n", "senID": 4}, {"text": ["If using this from PHP, though, getting it as XML might be more helpful (easier to parse, and not locale-aware) :"], "childNum": 1, "tag": "p", "senID": 5, "childList": [{"text": "(easier to parse, and not locale-aware)", "childNum": 0, "tag": "em", "pos": 0, "childList": []}]}, {"code": "<pre>\n<code>\n $ svn info --xml\n&lt;?xml version=\"1.0\"?&gt;\n&lt;info&gt;\n&lt;entry\n   kind=\"dir\"\n   path=\".\"\n   revision=\"185\"&gt;\n&lt;url&gt;http://.../trunk&lt;/url&gt;\n&lt;repository&gt;\n&lt;root&gt;http://...&lt;/root&gt;\n&lt;uuid&gt;128b9c1a-...-612a326c9977&lt;/uuid&gt;\n&lt;/repository&gt;\n&lt;wc-info&gt;\n&lt;schedule&gt;normal&lt;/schedule&gt;\n&lt;depth&gt;infinity&lt;/depth&gt;\n&lt;/wc-info&gt;\n&lt;commit\n   revision=\"185\"&gt;\n&lt;author&gt;...&lt;/author&gt;\n&lt;date&gt;2009-09-28T18:12:29.130307Z&lt;/date&gt;\n&lt;/commit&gt;\n&lt;/entry&gt;\n&lt;/info&gt;\n</code>\n</pre>\n", "senID": 6}, {"text": ["Just use simplexml_load_string on that, and fetch the revision attribute of the entry tag."], "childNum": 4, "tag": "p", "senID": 7, "childList": [{"text": "simplexml_load_string", "tag": "a", "pos": 0, "childList": [{"text": "simplexml_load_string", "tag": "code"}], "childNum": 1, "href": "http://php.net/simplexml%5Fload%5Fstring"}, {"text": "simplexml_load_string", "childNum": 0, "tag": "code", "childList": []}, {"text": "revision", "childNum": 0, "tag": "code", "childList": []}, {"text": "entry", "childNum": 0, "tag": "code", "childList": []}]}, {"text": ["\nNote that I would not do that on each page view : not quite as fast as one would hope for your application."], "childNum": 1, "tag": "p", "senID": 8, "childList": [{"text": "", "childNum": 0, "tag": "br", "pos": 0, "childList": []}]}, {"text": ["Instead, I would get that revision number when creating the archive I will, later, send to the production server -- and store it in some kind of configuration file."], "childNum": 0, "tag": "p", "senID": 9, "childList": []}, {"text": ["This way, you don't need to use the svn command on your production server, and you don't need to do your checkout on that server either."], "childNum": 1, "tag": "p", "senID": 10, "childList": [{"text": "svn", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}], [{"text": ["I would probably write out the version number to a text file somewhere within the website using the post-commit hook and then just read that file when loading your page."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["More on using hooks here"], "childNum": 1, "tag": "p", "senID": 1, "childList": [{"text": "More on using hooks here", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://svnbook.red-bean.com/en/1.1/ch05s02.html"}]}], [{"text": ["This works for svn version 1.6.2.", "But be warned, different SVN versions use different formats of the .svn folder."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n &lt;?php\n\n$contents = file_get_contents(dirname(__FILE__) . '/.svn/entries');\npreg_match(\"/dir\\n(.+)/\", $contents, $matches);\n$svnRevision = $matches[1];\n\nprint \"This Directory's SVN Revsion = $svnRevision\\n\";\n</code>\n</pre>\n", "senID": 1}], [{"text": ["Subversion includes the svnversion tool for exactly this purpose.", "A working copy may actually have local modifications, or may consist of a mix of revisions.", "svnversion knows how to handle that; see the examples in the linked documentation."], "childNum": 2, "tag": "p", "senID": 0, "childList": [{"text": "svnversion", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://svnbook.red-bean.com/en/1.5/svn.ref.svnversion.re.html"}, {"text": "svnversion", "childNum": 0, "tag": "code", "pos": 2, "childList": []}]}, {"text": ["You can invoke svnversion from python like this:"], "childNum": 1, "tag": "p", "senID": 1, "childList": [{"text": "svnversion", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"code": "<pre>\n<code>\n import subprocess\n\ndef svnversion():\n    p = subprocess.Popen(\"svnversion\", shell=True, \\\n       stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n    (stdout, stderr) = p.communicate()\n    return stdout\n</code>\n</pre>\n", "senID": 2}], [{"text": ["I like the solution used by MediaWiki, reading the contents of .svn/entities.", "Check the first answer on this question: http://stackoverflow.com/questions/16248/getting-the-subversion-repository-number-into-code"], "childNum": 2, "tag": "p", "senID": 0, "childList": [{"text": ".svn/entities", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "http://stackoverflow.com/questions/16248/getting-the-subversion-repository-number-into-code", "tag": "a", "pos": 1, "childList": [], "childNum": 0, "href": "http://stackoverflow.com/questions/16248/getting-the-subversion-repository-number-into-code"}]}], [{"text": ["If you're looking for a Python implementation, check out pysvn, you can invoke the info command to get details including the current revision:"], "childNum": 2, "tag": "p", "senID": 0, "childList": [{"text": "pysvn", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://pysvn.tigris.org/"}, {"href": "http://pysvn.tigris.org/docs/pysvn%5Fprog%5Fref.html#pysvn%5Fclient%5Finfo", "text": "info command", "childNum": 0, "tag": "a", "childList": []}]}, {"code": "<pre>\n<code>\n entry = info( path )\n</code>\n</pre>\n", "senID": 1}], [{"text": ["Following Lance, here's a command line one-liner."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n svn log -q --limit 1  http://svnbox/path/to/repo/trunk \\\n| php -r 'fgets(STDIN); preg_match(\"/(\\d+)/\", fgets(STDIN), $m); echo $m[0];'\n</code>\n</pre>\n", "senID": 1}], [{"text": ["I know this is pretty old, but I thought I'd offer up how I do this in PHP for my web apps:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["Put this in a PHP file in your app, and set the SVN Keywords property for \"Date Revision Author HeadURL Id\" (keyword substitution in the file)."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"code": "<pre>\n<code>\n $SVN_rev = \"\\$LastChangedRevision$\";\n$SVN_headURL = \"\\$HeadURL$\";\n\nfunction stripSVNstuff($s)\n{\n    $s = substr($s, strpos($s, \":\")+1);\n    $s = str_replace(\"$\", \"\", $s);\n    return trim($s);\n}\n</code>\n</pre>\n", "senID": 2}, {"text": ["So after svn does keyword replacement on the source file, the $SVN_rev line will look like:"], "childNum": 0, "tag": "p", "senID": 3, "childList": []}, {"code": "<pre>\n<code>\n $SVN_rev = \"\\$LastChangedRevision: 6 $\";\n</code>\n</pre>\n", "senID": 4}, {"text": ["so the output of stripSVNstuff($SVN_rev) would be \"6\" (without quotes)."], "childNum": 0, "tag": "p", "senID": 5, "childList": []}], [{"text": ["You could just shell out to the command line and run svn info.", "Just keep in mind this could be a mixed revision.", "You could also run an svn up and the last line of STDOUT will give you the revision number. "], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["Or, are you wanting to use the svn API?", "You might also want to look at the TortoiseSVN code from SubWCRev which is used to replace a token in a file with the current revisions of the WC. "], "childNum": 0, "tag": "p", "senID": 1, "childList": []}]]