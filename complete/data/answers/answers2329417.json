[[{"text": ["You can have two file objects for the same file at the same time (one for reading, one for writing):"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n def removeLine(filename, lineno):\n    fro = open(filename, \"rb\")\n\n    current_line = 0\n    while current_line &lt; lineno:\n        fro.readline()\n        current_line += 1\n\n    seekpoint = fro.tell()\n    frw = open(filename, \"r+b\")\n    frw.seek(seekpoint, 0)\n\n    # read the line we want to discard\n    fro.readline()\n\n    # now move the rest of the lines in the file \n    # one line back \n    chars = fro.readline()\n    while chars:\n        frw.writelines(chars)\n        chars = fro.readline()\n\n    fro.close()\n    frw.truncate()\n    frw.close()\n</code>\n</pre>\n", "senID": 1}], [{"text": ["Modify the file in place, offending line is replaced with spaces so the remainder of the file does not need to be shuffled around on disk.", "You can also \"fix\" the line in place if the fix is not longer than the line you are replacing"], "childNum": 2, "tag": "p", "senID": 0, "childList": [{"text": "in place", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}, {"text": "fix", "childNum": 0, "tag": "em", "pos": 1, "childList": []}]}, {"code": "<pre>\n<code>\n import os\nfrom mmap import mmap\ndef removeLine(filename, lineno):\n    f=os.open(filename, os.O_RDWR)\n    m=mmap(f,0)\n    p=0\n    for i in range(lineno-1):\n        p=m.find('\\n',p)+1\n    q=m.find('\\n',p)\n    m[p:q] = ' '*(q-p)\n    os.close(f)\n</code>\n</pre>\n", "senID": 1}, {"text": ["If the other program can be changed to output the fileoffset instead of the line number, you can assign the offset to p directly and do without the for loop"], "childNum": 0, "tag": "p", "senID": 2, "childList": []}], [{"text": ["As far as I know, you can't just open a txt file with python and remove a line.", "You have to make a new file and move everything but that line to it.", "If you know the specific line, then you would do something like this:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n f = open('in.txt')\nfo = open('out.txt','w')\n\nind = 1\nfor line in f:\n    if ind != linenumtoremove:\n        fo.write(line)\n    ind += 1\n\nf.close()\nfo.close()\n</code>\n</pre>\n", "senID": 1}, {"text": ["You could of course check the contents of the line instead to determine if you want to keep it or not.", "I also recommend that if you have a whole list of lines to be removed/changed to do all those changes in one pass through the file."], "childNum": 0, "tag": "p", "senID": 2, "childList": []}], [{"text": ["If the lines are variable length then I don't believe that there is a better algorithm than reading the file line by line and writing out all lines, except for the one(s) that you do not want."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["You can identify these lines by checking some criteria, or by keeping a running tally of lines read and suppressing the writing of the line(s) that you do not want."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"text": ["If the lines are fixed length and you want to delete specific line numbers, then you may be able to use seek to move the file pointer...", "I doubt you're that lucky though."], "childNum": 1, "tag": "p", "senID": 2, "childList": [{"text": "seek", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}], [{"text": ["Update: solution using sed as requested by poster in comment."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["To delete for example the second line of file:"], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"code": "<pre>\n<code>\n sed '2d' input.txt\n</code>\n</pre>\n", "senID": 2}, {"text": ["Use the -i switch to edit in place.", "Warning: this is a destructive operation.", "Read the help for this command for information on how to make a backup automatically."], "childNum": 1, "tag": "p", "senID": 3, "childList": [{"text": "-i", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}], [{"code": "<pre>\n<code>\n def removeLine(filename, lineno):\n    in = open(filename)\n    out = open(filename + \".new\", \"w\")\n    for i, l in enumerate(in, 1):\n        if i != lineno:\n            out.write(l)\n    in.close()\n    out.close()\n    os.rename(filename + \".new\", filename)\n</code>\n</pre>\n", "senID": 0}], [{"text": ["I think there was a somewhat similar if not exactly the same type of question asked here.", "Reading (and writing) line by line is slow, but you can read a bigger chunk into memory at once, go through that line by line skipping lines you don't want, then writing this as a single chunk to a new file.", "Repeat until done.", "Finally replace the original file with the new file."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["The thing to watch out for is when you read in a chunk, you need to deal with the last, potentially partial line you read, and prepend that into the next chunk you read."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}], [{"text": ["@OP, if you can use awk, eg assuming line number is 10"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n $ awk 'NR!=10' file &gt; newfile\n</code>\n</pre>\n", "senID": 1}]]