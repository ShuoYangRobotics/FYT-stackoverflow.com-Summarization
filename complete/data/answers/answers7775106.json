[[{"code": "<pre>\n<code>\n logfile = open('ip.log', 'r')\nloglist = logfile.readlines()\nlogfile.close()\nfound = False\nfor line in loglist:\n    if str(self.CLIENT_HOST) in line:\n        print \"Found it\"\n        found = True\n\nif not found:\n    logfile = open('ip.log', 'a')\n    logfile.write(str(self.CLIENT_HOST)+\"\\n\")\n    logfile.close()\n</code>\n</pre>\n", "senID": 0}, {"text": ["This is my first quick solution.", "Very unclean and not yet sophisticated, but should work."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}], [{"text": ["Use python filter:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n file = open('ip.log', 'r')\nflines = file.readlines()\nres = filter(lambda x: self.CLIENT_HOST in x, flines)\nif len(res) == 0:\n  file.write(str(self.CLIENT_HOST)+\"\\n\")\n  file.close()\n</code>\n</pre>\n", "senID": 1}], [{"text": ["Change open('ip.log', 'a+') to open('ip.log', 'r'), then write the file again later or write to a new file.", "Otherwise you are just making the file infinitely longer. "], "childNum": 0, "tag": "p", "senID": 0, "childList": []}], [{"text": ["Iterating over the lines allows you to stop loading the file when you find a match, and prevents you from having to hold the entire file in memory.   "], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n def log_host(self):\n    host = str(self.CLIENT_HOST)\n\n    with open('ip.log', 'r+') as logfile:\n        for line in logfile:\n            if line.strip() == host:\n                return\n\n        # Move to the end of the file:\n        logfile.seek(0, 2)\n        logfile.write(host + \"\\n\")\n</code>\n</pre>\n", "senID": 1}], [{"text": ["To append to the log file a client host string if it is not already present you could:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n with open('ip.log', 'a+') as f:\n     for line in f:\n         if self.CLIENT_HOST in line:\n            break\n     else: # not found\n         print &gt;&gt;f, self.CLIENT_HOST\n</code>\n</pre>\n", "senID": 1}], [{"text": ["I think this should work, and it's neater and more robust than any of the other answers yet.", "If it doesn't, then you may need to open another file for writing (first file 'r', second file 'a').", "Also I've gone for using x.rstrip('\\r\\n') and == rather than in to make sure it's correct.", "I don't know what your CLIENT_HOST variable is.", "If your CLIENT_HOST is already a str, throw away the first line and change the others back to referencing it directly."], "childNum": 7, "tag": "p", "senID": 0, "childList": [{"text": "'r'", "childNum": 0, "tag": "code", "pos": 1, "childList": []}, {"text": "'a'", "childNum": 0, "tag": "code", "pos": -1, "childList": []}, {"text": "x.rstrip('\\r\\n')", "childNum": 0, "tag": "code", "pos": 2, "childList": []}, {"text": "==", "childNum": 0, "tag": "code", "pos": -1, "childList": []}, {"text": "in", "childNum": 0, "tag": "code", "pos": 4, "childList": []}, {"text": "CLIENT_HOST", "childNum": 0, "tag": "code", "childList": []}, {"text": "CLIENT_HOST", "childNum": 0, "tag": "code", "childList": []}]}, {"code": "<pre>\n<code>\n value = str(self.CLIENT_HOST)\nwith open('ip.log', 'a+') as f:\n    if not any(value == x.rstrip('\\r\\n') for x in f):\n        f.write(value + '\\n')\n</code>\n</pre>\n", "senID": 1}]]