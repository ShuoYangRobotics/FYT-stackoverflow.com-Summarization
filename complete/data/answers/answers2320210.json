[[{"text": ["You can use Mock objects to intercept the method calls that you do not want to execute.", "E.g.", "You have some class A, where you don't want method no() to be called during a test."], "childNum": 3, "tag": "p", "senID": 0, "childList": [{"text": "Mock objects", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://en.wikipedia.org/wiki/Mock_object"}, {"text": "A", "childNum": 0, "tag": "code", "pos": 2, "childList": []}, {"text": "no()", "childNum": 0, "tag": "code", "childList": []}]}, {"code": "<pre>\n<code>\n class A:\n  def do(self):\n    print('do')\n  def no(self):\n    print('no')\n</code>\n</pre>\n", "senID": 1}, {"text": ["A mock object could inherit from A and override no() to do nothing."], "childNum": 2, "tag": "p", "senID": 2, "childList": [{"text": "A", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "no()", "childNum": 0, "tag": "code", "childList": []}]}, {"code": "<pre>\n<code>\n class MockA(A):\n  def no(self):\n    pass\n</code>\n</pre>\n", "senID": 3}, {"text": ["You would then create MockA objects instead of As in your test code.", "Another way to do mocking would be to have A and MockA implement a common interface say InterfaceA. "], "childNum": 5, "tag": "p", "senID": 4, "childList": [{"text": "MockA", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "A", "childNum": 0, "tag": "code", "pos": 1, "childList": []}, {"text": "A", "childNum": 0, "tag": "code", "childList": []}, {"text": "MockA", "childNum": 0, "tag": "code", "childList": []}, {"text": "InterfaceA", "childNum": 0, "tag": "code", "childList": []}]}, {"text": ["There are tons of mocking frameworks available.", "See StackOverflow: Python mocking frameworks."], "childNum": 1, "tag": "p", "senID": 5, "childList": [{"text": "StackOverflow: Python mocking frameworks", "tag": "a", "pos": 1, "childList": [], "childNum": 0, "href": "http://stackoverflow.com/questions/98053/what-is-your-favorite-python-mocking-library"}]}, {"text": ["In particular see: Google's Python mocking framework."], "childNum": 1, "tag": "p", "senID": 6, "childList": [{"text": "Google's Python mocking framework", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://google-opensource.blogspot.com/2008/07/check-out-mox-our-mock-object-framework.html"}]}], [{"text": ["Use Michael Foord's Mock\nin your unit test do this:"], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "Mock", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://www.voidspace.org.uk/python/mock/"}]}, {"code": "<pre>\n<code>\n from mock import Mock\n\nclass Person(object):\n    def __init__(self, name):\n        super(Person, self).__init__()\n        self.name = name\n\n    def say(self, str):\n        print \"%s says \\\"%s\\\"\" % (self.name, str)\n\n\n...\n\n#In your unit test....\n#create the class as normal\nperson = Person(\"Bob\")\n#now mock all of person's methods/attributes\nperson = Mock(spec=person)\n#talkto is some function you are testing\ntalkTo(person)\n#make sure the Person class's say method was called\nself.assertTrue(person.say.called, \"Person wasn't asked to talk\")\n\n#make sure the person said \"Hello\"\nargs = (\"Hello\")\nkeywargs = {}\nself.assertEquals(person.say.call_args, (args, keywargs), \"Person did not say hello\")\n</code>\n</pre>\n", "senID": 1}], [{"text": ["You have two ways to do this is no ,or minimal in the case ofDI, modifications to your source code"], "childNum": 2, "tag": "p", "senID": 0, "childList": [{"text": ",or minimal in the case ofDI,", "childNum": 1, "tag": "sub", "pos": 0, "childList": [{"text": "DI", "tag": "a"}]}, {"href": "http://stackoverflow.com/questions/130794/what-is-dependency-injection", "text": "DI", "childNum": 0, "tag": "a", "childList": []}]}, {"tag": "ul", "num": 2, "lis": [{"text": ["Dependency injection"], "childNum": 0, "tag": "a", "senID": 1, "childList": []}, {"text": ["Monkey patching"], "childNum": 0, "tag": "a", "senID": 2, "childList": []}]}, {"text": ["The cleanest way is using dependency injection, but I don't really like extensive monkeypatching, and there are some things that are non-possible/difficult to do that dependency injection makes easy."], "childNum": 5, "tag": "p", "senID": 3, "childList": [{"text": "cleanest", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://mail.python.org/pipermail/python-dev/2008-January/076194.html"}, {"href": "http://wiki.python.org/moin/DependencyInjectionPattern", "text": "dependency injection", "childNum": 0, "tag": "a", "childList": []}, {"href": "http://www.siafoo.net/article/52#modifying-classes-after-creation", "text": "I don't really", "childNum": 0, "tag": "a", "childList": []}, {"href": "http://wiki.python.org/moin/DependencyInjectionPattern", "text": "like extensive monkeypatching", "childNum": 0, "tag": "a", "childList": []}, {"href": "http://code.activestate.com/recipes/413268-dependency-injection-the-python-way/", "text": "dependency injection", "childNum": 0, "tag": "a", "childList": []}]}], [{"text": ["Typically when something like this arises you use Monkey Patching (also called Duck Punching) to achieve the desired results.", "Check out this link to learn more about Monkey Patching."], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "this link", "tag": "a", "pos": 1, "childList": [], "childNum": 0, "href": "http://en.wikipedia.org/wiki/Monkey_patch"}]}, {"text": ["In this case, for example, you would overwrite solr to just print the output you are looking for."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}], [{"text": ["I know it's the typical use case for mock objects, but that's also an old argument... are Mock objects necessary at all or are they evil ?"], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "evil", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}]}, {"text": ["I'm on the side of those who believe mocks are evil and would try to avoid changing tested code at all.", "I even believe such need to modify tested code is a code smell..."], "childNum": 1, "tag": "p", "senID": 1, "childList": [{"text": "evil", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}]}, {"text": ["If you wish to change or intercept an internal function call for testing purpose you could also make this function an explicit external dependency set at instanciation time that would be provided both by your production code and test code.", "If you do that the problem disappear and you end up with a cleaner interface."], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"text": ["Note that doing that there is not need to change the tested code at all neither internally nor by the test being performed."], "childNum": 0, "tag": "p", "senID": 3, "childList": []}], [{"text": ["The big problem that I was having was with the mechanics of the dependency injection.", "I have now figured that part out."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["I need to import the module in the exact same way in both places to successfully inject the new code.", "For example, if I have the following code that I want to disable:"], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"code": "<pre>\n<code>\n from foo_service.foo import solr\nsolr.add(spam)\n</code>\n</pre>\n", "senID": 2}, {"text": ["I can't seem to do this in the in my test runner:"], "childNum": 0, "tag": "p", "senID": 3, "childList": []}, {"code": "<pre>\n<code>\n from foo import solr\nsolr = mock_object\n</code>\n</pre>\n", "senID": 4}, {"text": ["The python interpreter must be treating the modules foo_service.foo and foo as different entries.", "I changed from foo import solr to the more explicit from foo_service.foo import solr and my mock object was successfully injected."], "childNum": 4, "tag": "p", "senID": 5, "childList": [{"text": "foo_service.foo", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "foo", "childNum": 0, "tag": "code", "pos": 1, "childList": []}, {"text": "from foo import solr", "childNum": 0, "tag": "code", "childList": []}, {"text": "from foo_service.foo import solr", "childNum": 0, "tag": "code", "childList": []}]}]]