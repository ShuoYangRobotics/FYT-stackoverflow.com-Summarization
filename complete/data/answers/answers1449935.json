[[{"text": ["I'm not sure about the Python specifics, but if put the string $Revision$ into your file somewhere and you have enable-auto-props=true in your SVN config, it'll get rewritten to something like $Revision: 144$.", "You could then parse this in your script."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["There are a number of property keywords you can use in this way."], "childNum": 1, "tag": "p", "senID": 1, "childList": [{"text": "a number of property keywords you can use in this way", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://svnbook.red-bean.com/en/1.1/ch07s02.html#svn-ch-7-sect-2.3.4"}]}, {"text": ["This won't have any overhead, e.g.", "querying the SVN repo, because the string is hard-coded into your file on commit or update."], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"text": ["I'm not sure how you'd parse this in Python but in PHP I'd do:"], "childNum": 0, "tag": "p", "senID": 3, "childList": []}, {"code": "<pre>\n<code>\n $revString = '$Revision: 144$';\nif(preg_match('/: ([0-9]+)\\$/', $revString, $matches) {\n    echo 'Revision is ' . $matches[1];\n}\n</code>\n</pre>\n", "senID": 4}], [{"text": ["Similar to, but a little more pythonic than the PHP answer; put this in your module's __init__.py:"], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "__init__.py", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"code": "<pre>\n<code>\n __version__ = filter(str.isdigit, \"$Revision: 13 $\")\n</code>\n</pre>\n", "senID": 1}, {"text": ["and make sure you add the Revision property:"], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"code": "<pre>\n<code>\n svn propset svn:keywords Revision __init__.py\n</code>\n</pre>\n", "senID": 3}], [{"text": ["There's a snippet of code in Django that allows you to do this, I'd recommend looking at it.", "http://code.djangoproject.com/browser/django/trunk/django/utils/version.py"], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "http://code.djangoproject.com/browser/django/trunk/django/utils/version.py", "tag": "a", "pos": 1, "childList": [], "childNum": 0, "href": "http://code.djangoproject.com/browser/django/trunk/django/utils/version.py"}]}], [{"text": ["I do this by simply running a small script when building my project.", "The script just calls svn info in combination with sed to get out the bare revision data and injects that number into the revision.txt file. "], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["The Hudson build server makes it even easier as it sets the SVN revision number as an environment variable right before invoking your Build scripts."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}], [{"text": ["The file hooks/pre-commit in your repository is a script or program which will be executed before a successful commit.", "Simply make this a script which updates your file with the proper version number as it is being committed (the revision number is passed to your script as it's run).", "Here's a tutorial with an example of writing a pre-commit hook: http://wordaligned.org/articles/a-subversion-pre-commit-hook"], "childNum": 2, "tag": "p", "senID": 0, "childList": [{"text": "hooks/pre-commit", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "http://wordaligned.org/articles/a-subversion-pre-commit-hook", "tag": "a", "pos": 2, "childList": [], "childNum": 0, "href": "http://wordaligned.org/articles/a-subversion-pre-commit-hook"}]}], [{"text": ["Check out pysvn.", "it exposes extensions in Python for Subversion runtime functionality."], "childNum": 1, "tag": "p", "senID": 0, "childList": [{"text": "pysvn", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://pysvn.tigris.org/"}]}], [{"text": ["I find the when it is run section slightly ambiguous - when it is run from where ?", "From an SVN checkout or from released code ?", "All the solutions work on injecting the SVN version somehow into the Python source or somewhere in the repository in a separate version file."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["The version file is changed on fresh checkouts, so clean checkouts need to be done before distribution.", "So my question of where the program is being run remains."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}]]