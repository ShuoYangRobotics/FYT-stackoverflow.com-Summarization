[[{"text": ["Floating point number representation might not be accurate enough.", "You should never test for zero equality but instead use something along"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n if (abs(x) &lt; 1E-10) ...\n</code>\n</pre>\n", "senID": 1}], [{"text": ["Behold the power of the print statement..."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["Let us insert a print statement..."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"code": "<pre>\n<code>\n x = -5\nwhile x &lt; 5:\n    if (x == 0):\n        print 0\n    x += .01\n    print x\n</code>\n</pre>\n", "senID": 2}, {"text": ["Running this program, and inspecting the output around 0 reveals the problem:"], "childNum": 0, "tag": "p", "senID": 3, "childList": []}, {"code": "<pre>\n<code>\n ...\n-0.13\n-0.12\n-0.11\n-0.1\n-0.0900000000001\n-0.0800000000001\n-0.0700000000001\n-0.0600000000001\n-0.0500000000001\n-0.0400000000001\n-0.0300000000001\n-0.0200000000001\n-0.0100000000001\n-6.23077978101e-14\n0.00999999999994\n0.0199999999999\n0.0299999999999\n0.0399999999999\n0.0499999999999\n0.0599999999999\n0.0699999999999\n0.0799999999999\n0.0899999999999\n0.0999999999999\n0.11\n0.12\n0.13\n...\n</code>\n</pre>\n", "senID": 4}, {"text": ["Oh boy, it is never actually equal to zero!"], "childNum": 0, "tag": "p", "senID": 5, "childList": []}, {"text": ["Solutions:"], "childNum": 0, "tag": "p", "senID": 6, "childList": []}], [{"text": ["This is a rounding issue - decimal values cannot be represented exactly in binary, so x never exactly equals 0.0000000000...."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["try replacing if (x == 0): with if -0.001 &lt; x &lt; 0.001:"], "childNum": 2, "tag": "p", "senID": 1, "childList": [{"text": "if (x == 0):", "childNum": 0, "tag": "code", "pos": 0, "childList": []}, {"text": "if -0.001 &lt; x &lt; 0.001:", "childNum": 0, "tag": "code", "childList": []}]}, {"text": ["BTW, the parentheses are unnecessary in a python if statement."], "childNum": 1, "tag": "p", "senID": 2, "childList": [{"text": "if", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"text": ["edit:\nPrinting out the values between -1 and 1 in steps of 0.01 shows this is the case - where zero should be it prints 7.52869988574e-16."], "childNum": 1, "tag": "p", "senID": 3, "childList": [{"text": "edit", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}]}], [{"text": ["Others have pointed out the issue with floating-point numbers being unable to represent values exactly.", "If you need exact decimal representation of a number, you can use the Decimal class:"], "childNum": 2, "tag": "p", "senID": 0, "childList": [{"text": "exact", "childNum": 0, "tag": "em", "pos": 0, "childList": []}, {"text": "Decimal", "childNum": 0, "tag": "code", "pos": 1, "childList": []}]}, {"code": "<pre>\n<code>\n from decimal import Decimal\n\nx = Decimal(-5)\nwhile x &lt; 5:\n    if (x == 0):\n        print 0\n    x += Decimal(\".01\")\n</code>\n</pre>\n", "senID": 1}, {"text": ["This will print 0 as you expect."], "childNum": 1, "tag": "p", "senID": 2, "childList": [{"text": "0", "childNum": 0, "tag": "code", "pos": 0, "childList": []}]}, {"text": ["Note the use of a string for the increment.", "If you used Decimal(.01) you'd have the same problem with accurate representation of 0.01, because you're converting from a floating-point number and have already lost the accuracy, so the class doesn't allow that."], "childNum": 2, "tag": "p", "senID": 3, "childList": [{"text": "string", "childNum": 0, "tag": "em", "pos": 0, "childList": []}, {"text": "Decimal(.01)", "childNum": 0, "tag": "code", "pos": 1, "childList": []}]}], [{"text": ["In binary, .01 has no exact representation but .5 does."], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"text": ["It's the same problem you'd have in decimal if you represented 1/3 as .333333 and kept adding 1/3 until you reached 1.", "After three additions, you'd have .999999 which is not exactly equal to 1."], "childNum": 0, "tag": "p", "senID": 1, "childList": []}, {"text": ["Don't compare non-integers for equality unless you precisely understand the rules for doing so and are 100% sure your case is one of the ones that will work."], "childNum": 1, "tag": "p", "senID": 2, "childList": [{"text": "Don't compare non-integers for equality", "tag": "a", "pos": 0, "childList": [], "childNum": 0, "href": "http://download.oracle.com/docs/cd/E19957-01/806-3568/ncg_goldberg.html#680"}]}], [{"code": "<pre>\n<code>\n -0.01\n7.52869988574e-16\n0.01\n</code>\n</pre>\n", "senID": 0}, {"text": ["I suggest you say x > -.001 and x &lt; .001 or something of the sort"], "childNum": 0, "tag": "p", "senID": 1, "childList": []}], [{"text": ["To be precise to your query, floating point numbers are stored in computer hardware in binary(base 2) fractions.", "So even if you store some floating point like 0.01 in a variable, the computer would ultimately convert that into it's equivalent binary value.", "For your convenience, conversion of 0.01 float to binary:"], "childNum": 0, "tag": "p", "senID": 0, "childList": []}, {"code": "<pre>\n<code>\n 0.01 * 2 = 0.02 [0]\n0.02 * 2 = 0.04 [0] \n0.04 * 2 = 0.08 [0]\n0.08 * 2 = 0.16 [0]\n0.16 * 2 = 0.32 [0]\n0.32 * 2 = 0.64 [0]\n0.64 * 2 = 1.28 [0]\n0.28 * 2 = 0.56 [0]\n0.56 * 2 = 1.12 [1]\n...\n</code>\n</pre>\n", "senID": 1}, {"text": ["This calculation would be too lengthy to show here in full and probably won't end at all.", "But the fact i want to state here is that, most fractional decimals cannot be exactly converted into binary fractions.", "As a result, the decimal point you store will be approximated by the binary floating fractions stored in the machine(which obviously can't store very very long binary value).", "So when the calculation is done with that value, you certainly shouldn't expect the accurate floating value.", "That's the case with putting x += 0.01 in your code.", "However conversion of 0.5 to it's binary equivalent would give:"], "childNum": 0, "tag": "p", "senID": 2, "childList": []}, {"code": "<pre>\n<code>\n 0.5 * 2 = 1.0 [1]\n</code>\n</pre>\n", "senID": 3}, {"text": ["So binary equivalent of 0.5 float is 0.1.", "Since it is perfectly represented in binary in your machine.", "You would get the exact result. "], "childNum": 1, "tag": "p", "senID": 4, "childList": [{"text": "binary equivalent of 0.5 float is 0.1", "childNum": 0, "tag": "strong", "pos": 0, "childList": []}]}, {"text": ["It has nothing to do with your code or python.", "It's just the way computer hardware works :)"], "childNum": 0, "tag": "p", "senID": 5, "childList": []}]]